"use strict";var Ft=Object.defineProperty;var Ot=(s,e,t)=>e in s?Ft(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Ue=(s,e,t)=>Ot(s,typeof e!="symbol"?e+"":e,t);Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const c=require("react"),ft=require("react-image-crop");var pt={exports:{}},We={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ht;function Dt(){if(ht)return We;ht=1;var s=c,e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function l(u,d,f){var p,y={},m=null,x=null;f!==void 0&&(m=""+f),d.key!==void 0&&(m=""+d.key),d.ref!==void 0&&(x=d.ref);for(p in d)n.call(d,p)&&!i.hasOwnProperty(p)&&(y[p]=d[p]);if(u&&u.defaultProps)for(p in d=u.defaultProps,d)y[p]===void 0&&(y[p]=d[p]);return{$$typeof:e,type:u,key:m,ref:x,props:y,_owner:a.current}}return We.Fragment=t,We.jsx=l,We.jsxs=l,We}var Ke={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yt;function Bt(){return yt||(yt=1,process.env.NODE_ENV!=="production"&&function(){var s=c,e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),y=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.for("react.offscreen"),C=Symbol.iterator,L="@@iterator";function j(o){if(o===null||typeof o!="object")return null;var g=C&&o[C]||o[L];return typeof g=="function"?g:null}var Y=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function O(o){{for(var g=arguments.length,v=new Array(g>1?g-1:0),T=1;T<g;T++)v[T-1]=arguments[T];A("error",o,v)}}function A(o,g,v){{var T=Y.ReactDebugCurrentFrame,$=T.getStackAddendum();$!==""&&(g+="%s",v=v.concat([$]));var W=v.map(function(F){return String(F)});W.unshift("Warning: "+g),Function.prototype.apply.call(console[o],console,W)}}var q=!1,h=!1,S=!1,P=!1,H=!1,V;V=Symbol.for("react.module.reference");function I(o){return!!(typeof o=="string"||typeof o=="function"||o===n||o===i||H||o===a||o===f||o===p||P||o===x||q||h||S||typeof o=="object"&&o!==null&&(o.$$typeof===m||o.$$typeof===y||o.$$typeof===l||o.$$typeof===u||o.$$typeof===d||o.$$typeof===V||o.getModuleId!==void 0))}function D(o,g,v){var T=o.displayName;if(T)return T;var $=g.displayName||g.name||"";return $!==""?v+"("+$+")":v}function N(o){return o.displayName||"Context"}function z(o){if(o==null)return null;if(typeof o.tag=="number"&&O("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case n:return"Fragment";case t:return"Portal";case i:return"Profiler";case a:return"StrictMode";case f:return"Suspense";case p:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case u:var g=o;return N(g)+".Consumer";case l:var v=o;return N(v._context)+".Provider";case d:return D(o,o.render,"ForwardRef");case y:var T=o.displayName||null;return T!==null?T:z(o.type)||"Memo";case m:{var $=o,W=$._payload,F=$._init;try{return z(F(W))}catch{return null}}}return null}var M=Object.assign,ne=0,oe,de,fe,je,ge,be,ye;function Ne(){}Ne.__reactDisabledLog=!0;function Ie(){{if(ne===0){oe=console.log,de=console.info,fe=console.warn,je=console.error,ge=console.group,be=console.groupCollapsed,ye=console.groupEnd;var o={configurable:!0,enumerable:!0,value:Ne,writable:!0};Object.defineProperties(console,{info:o,log:o,warn:o,error:o,group:o,groupCollapsed:o,groupEnd:o})}ne++}}function Ce(){{if(ne--,ne===0){var o={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:M({},o,{value:oe}),info:M({},o,{value:de}),warn:M({},o,{value:fe}),error:M({},o,{value:je}),group:M({},o,{value:ge}),groupCollapsed:M({},o,{value:be}),groupEnd:M({},o,{value:ye})})}ne<0&&O("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var ke=Y.ReactCurrentDispatcher,R;function B(o,g,v){{if(R===void 0)try{throw Error()}catch($){var T=$.stack.trim().match(/\n( *(at )?)/);R=T&&T[1]||""}return`
`+R+o}}var X=!1,ae;{var ee=typeof WeakMap=="function"?WeakMap:Map;ae=new ee}function Ae(o,g){if(!o||X)return"";{var v=ae.get(o);if(v!==void 0)return v}var T;X=!0;var $=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var W;W=ke.current,ke.current=null,Ie();try{if(g){var F=function(){throw Error()};if(Object.defineProperty(F.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(F,[])}catch(ue){T=ue}Reflect.construct(o,[],F)}else{try{F.call()}catch(ue){T=ue}o.call(F.prototype)}}else{try{throw Error()}catch(ue){T=ue}o()}}catch(ue){if(ue&&T&&typeof ue.stack=="string"){for(var _=ue.stack.split(`
`),ce=T.stack.split(`
`),Z=_.length-1,Q=ce.length-1;Z>=1&&Q>=0&&_[Z]!==ce[Q];)Q--;for(;Z>=1&&Q>=0;Z--,Q--)if(_[Z]!==ce[Q]){if(Z!==1||Q!==1)do if(Z--,Q--,Q<0||_[Z]!==ce[Q]){var me=`
`+_[Z].replace(" at new "," at ");return o.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",o.displayName)),typeof o=="function"&&ae.set(o,me),me}while(Z>=1&&Q>=0);break}}}finally{X=!1,ke.current=W,Ce(),Error.prepareStackTrace=$}var Be=o?o.displayName||o.name:"",we=Be?B(Be):"";return typeof o=="function"&&ae.set(o,we),we}function w(o,g,v){return Ae(o,!1)}function he(o){var g=o.prototype;return!!(g&&g.isReactComponent)}function Se(o,g,v){if(o==null)return"";if(typeof o=="function")return Ae(o,he(o));if(typeof o=="string")return B(o);switch(o){case f:return B("Suspense");case p:return B("SuspenseList")}if(typeof o=="object")switch(o.$$typeof){case d:return w(o.render);case y:return Se(o.type,g,v);case m:{var T=o,$=T._payload,W=T._init;try{return Se(W($),g,v)}catch{}}}return""}var Ee=Object.prototype.hasOwnProperty,J={},K=Y.ReactDebugCurrentFrame;function Re(o){if(o){var g=o._owner,v=Se(o.type,o._source,g?g.type:null);K.setExtraStackFrame(v)}else K.setExtraStackFrame(null)}function Me(o,g,v,T,$){{var W=Function.call.bind(Ee);for(var F in o)if(W(o,F)){var _=void 0;try{if(typeof o[F]!="function"){var ce=Error((T||"React class")+": "+v+" type `"+F+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof o[F]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw ce.name="Invariant Violation",ce}_=o[F](g,F,T,v,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(Z){_=Z}_&&!(_ instanceof Error)&&(Re($),O("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",T||"React class",v,F,typeof _),Re(null)),_ instanceof Error&&!(_.message in J)&&(J[_.message]=!0,Re($),O("Failed %s type: %s",v,_.message),Re(null))}}}var Ge=Array.isArray;function _e(o){return Ge(o)}function Fe(o){{var g=typeof Symbol=="function"&&Symbol.toStringTag,v=g&&o[Symbol.toStringTag]||o.constructor.name||"Object";return v}}function rt(o){try{return Ye(o),!1}catch{return!0}}function Ye(o){return""+o}function qe(o){if(rt(o))return O("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",Fe(o)),Ye(o)}var Ve=Y.ReactCurrentOwner,nt={key:!0,ref:!0,__self:!0,__source:!0},Je,Xe;function ot(o){if(Ee.call(o,"ref")){var g=Object.getOwnPropertyDescriptor(o,"ref").get;if(g&&g.isReactWarning)return!1}return o.ref!==void 0}function at(o){if(Ee.call(o,"key")){var g=Object.getOwnPropertyDescriptor(o,"key").get;if(g&&g.isReactWarning)return!1}return o.key!==void 0}function Oe(o,g){typeof o.ref=="string"&&Ve.current}function st(o,g){{var v=function(){Je||(Je=!0,O("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",g))};v.isReactWarning=!0,Object.defineProperty(o,"key",{get:v,configurable:!0})}}function it(o,g){{var v=function(){Xe||(Xe=!0,O("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",g))};v.isReactWarning=!0,Object.defineProperty(o,"ref",{get:v,configurable:!0})}}var lt=function(o,g,v,T,$,W,F){var _={$$typeof:e,type:o,key:g,ref:v,props:F,_owner:W};return _._store={},Object.defineProperty(_._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(_,"_self",{configurable:!1,enumerable:!1,writable:!1,value:T}),Object.defineProperty(_,"_source",{configurable:!1,enumerable:!1,writable:!1,value:$}),Object.freeze&&(Object.freeze(_.props),Object.freeze(_)),_};function ct(o,g,v,T,$){{var W,F={},_=null,ce=null;v!==void 0&&(qe(v),_=""+v),at(g)&&(qe(g.key),_=""+g.key),ot(g)&&(ce=g.ref,Oe(g,$));for(W in g)Ee.call(g,W)&&!nt.hasOwnProperty(W)&&(F[W]=g[W]);if(o&&o.defaultProps){var Z=o.defaultProps;for(W in Z)F[W]===void 0&&(F[W]=Z[W])}if(_||ce){var Q=typeof o=="function"?o.displayName||o.name||"Unknown":o;_&&st(F,Q),ce&&it(F,Q)}return lt(o,_,ce,$,T,Ve.current,F)}}var He=Y.ReactCurrentOwner,De=Y.ReactDebugCurrentFrame;function xe(o){if(o){var g=o._owner,v=Se(o.type,o._source,g?g.type:null);De.setExtraStackFrame(v)}else De.setExtraStackFrame(null)}var $e;$e=!1;function ze(o){return typeof o=="object"&&o!==null&&o.$$typeof===e}function Ze(){{if(He.current){var o=z(He.current.type);if(o)return`

Check the render method of \``+o+"`."}return""}}function dt(o){return""}var Qe={};function b(o){{var g=Ze();if(!g){var v=typeof o=="string"?o:o.displayName||o.name;v&&(g=`

Check the top-level render call using <`+v+">.")}return g}}function E(o,g){{if(!o._store||o._store.validated||o.key!=null)return;o._store.validated=!0;var v=b(g);if(Qe[v])return;Qe[v]=!0;var T="";o&&o._owner&&o._owner!==He.current&&(T=" It was passed a child from "+z(o._owner.type)+"."),xe(o),O('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',v,T),xe(null)}}function k(o,g){{if(typeof o!="object")return;if(_e(o))for(var v=0;v<o.length;v++){var T=o[v];ze(T)&&E(T,g)}else if(ze(o))o._store&&(o._store.validated=!0);else if(o){var $=j(o);if(typeof $=="function"&&$!==o.entries)for(var W=$.call(o),F;!(F=W.next()).done;)ze(F.value)&&E(F.value,g)}}}function U(o){{var g=o.type;if(g==null||typeof g=="string")return;var v;if(typeof g=="function")v=g.propTypes;else if(typeof g=="object"&&(g.$$typeof===d||g.$$typeof===y))v=g.propTypes;else return;if(v){var T=z(g);Me(v,o.props,"prop",T,o)}else if(g.PropTypes!==void 0&&!$e){$e=!0;var $=z(g);O("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",$||"Unknown")}typeof g.getDefaultProps=="function"&&!g.getDefaultProps.isReactClassApproved&&O("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function G(o){{for(var g=Object.keys(o.props),v=0;v<g.length;v++){var T=g[v];if(T!=="children"&&T!=="key"){xe(o),O("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",T),xe(null);break}}o.ref!==null&&(xe(o),O("Invalid attribute `ref` supplied to `React.Fragment`."),xe(null))}}var se={};function ie(o,g,v,T,$,W){{var F=I(o);if(!F){var _="";(o===void 0||typeof o=="object"&&o!==null&&Object.keys(o).length===0)&&(_+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var ce=dt();ce?_+=ce:_+=Ze();var Z;o===null?Z="null":_e(o)?Z="array":o!==void 0&&o.$$typeof===e?(Z="<"+(z(o.type)||"Unknown")+" />",_=" Did you accidentally export a JSX literal instead of a component?"):Z=typeof o,O("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Z,_)}var Q=ct(o,g,v,$,W);if(Q==null)return Q;if(F){var me=g.children;if(me!==void 0)if(T)if(_e(me)){for(var Be=0;Be<me.length;Be++)k(me[Be],o);Object.freeze&&Object.freeze(me)}else O("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else k(me,o)}if(Ee.call(g,"key")){var we=z(o),ue=Object.keys(g).filter(function(_t){return _t!=="key"}),ut=ue.length>0?"{key: someKey, "+ue.join(": ..., ")+": ...}":"{key: someKey}";if(!se[we+ut]){var At=ue.length>0?"{"+ue.join(": ..., ")+": ...}":"{}";O(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,ut,we,At,we),se[we+ut]=!0}}return o===n?G(Q):U(Q),Q}}function te(o,g,v){return ie(o,g,v,!0)}function re(o,g,v){return ie(o,g,v,!1)}var le=re,pe=te;Ke.Fragment=n,Ke.jsx=le,Ke.jsxs=pe}()),Ke}process.env.NODE_ENV==="production"?pt.exports=Dt():pt.exports=Bt();var r=pt.exports;const Ut=[{name:"clipboard",buttons:[{command:"undo",icon:"↶",title:"Undo"},{command:"redo",icon:"↷",title:"Redo"},{type:"separator",command:"",icon:"",title:""}]},{name:"editing",buttons:[{command:"findReplace",icon:"🔍",title:"Find & Replace"},{type:"separator",command:"",icon:"",title:""}]},{name:"basicstyles",buttons:[{command:"bold",icon:"B",title:"Bold"},{command:"italic",icon:"I",title:"Italic"},{command:"underline",icon:"U",title:"Underline"},{command:"strikethrough",icon:"S̶",title:"Strikethrough"},{command:"subscript",icon:"X₂",title:"Subscript"},{command:"superscript",icon:"X²",title:"Superscript"},{command:"removeFormat",icon:"🧹",title:"Clear Formatting"},{type:"separator",command:"",icon:"",title:""}]},{name:"paragraph",buttons:[{command:"formatBlock",value:"H1",icon:"H1",title:"Heading 1"},{command:"formatBlock",value:"H2",icon:"H2",title:"Heading 2"},{command:"formatBlock",value:"H3",icon:"H3",title:"Heading 3"},{command:"formatBlock",icon:"¶",title:"Format",type:"dropdown",options:[{value:"P",label:"Normal",icon:"¶"},{value:"H1",label:"Heading 1",icon:"H1"},{value:"H2",label:"Heading 2",icon:"H2"},{value:"H3",label:"Heading 3",icon:"H3"},{value:"H4",label:"Heading 4",icon:"H4"},{value:"H5",label:"Heading 5",icon:"H5"},{value:"H6",label:"Heading 6",icon:"H6"},{value:"BLOCKQUOTE",label:"Quote",icon:'"'},{value:"PRE",label:"Code Block",icon:"</>"}]},{command:"fontSize",icon:"🔤",title:"Font Size",type:"dropdown",options:[{value:"1",label:"8pt"},{value:"2",label:"10pt"},{value:"3",label:"12pt"},{value:"4",label:"14pt"},{value:"5",label:"18pt"},{value:"6",label:"24pt"},{value:"7",label:"36pt"}]},{command:"fontName",icon:"Aa",title:"Font Family",type:"dropdown",options:[{value:"Arial",label:"Arial"},{value:"Georgia",label:"Georgia"},{value:"Times New Roman",label:"Times New Roman"},{value:"Courier New",label:"Courier New"},{value:"Verdana",label:"Verdana"},{value:"Helvetica",label:"Helvetica"}]},{type:"separator",command:"",icon:"",title:""}]},{name:"colors",buttons:[{command:"fontColor",icon:"A",title:"Text Color",type:"color"},{command:"backgroundColor",icon:"🎨",title:"Background Color",type:"color"},{type:"separator",command:"",icon:"",title:""}]},{name:"list",buttons:[{command:"insertUnorderedList",icon:"•",title:"Bullet List"},{command:"insertOrderedList",icon:"1.",title:"Numbered List"},{command:"outdent",icon:"⇤",title:"Decrease Indent"},{command:"indent",icon:"⇥",title:"Increase Indent"},{type:"separator",command:"",icon:"",title:""}]},{name:"align",buttons:[{command:"justifyLeft",icon:"⬅",title:"Align Left"},{command:"justifyCenter",icon:"⬌",title:"Align Center"},{command:"justifyRight",icon:"➡",title:"Align Right"},{command:"justifyFull",icon:"⬌",title:"Justify"},{type:"separator",command:"",icon:"",title:""}]},{name:"links",buttons:[{command:"createLink",icon:"🔗",title:"Insert Link"},{command:"unlink",icon:"🔗✕",title:"Remove Link"},{type:"separator",command:"",icon:"",title:""}]},{name:"insert",buttons:[{command:"insertImage",icon:"🖼️",title:"Insert Image"},{command:"insertTable",icon:"⊞",title:"Insert Table"},{command:"insertHorizontalRule",icon:"―",title:"Horizontal Rule"},{command:"insertSpecialChar",icon:"Ω",title:"Special Characters"},{command:"uploadFile",icon:"📎",title:"Upload File"},{type:"separator",command:"",icon:"",title:""}]},{name:"tools",buttons:[{command:"sourceCode",icon:"</>",title:"Source Code"},{command:"fullscreen",icon:"⛶",title:"Fullscreen"},{command:"print",icon:"🖨️",title:"Print"},{command:"spellCheck",icon:"✓",title:"Spell Check"}]}],Pt=["#ffffff","#e6e6e6","#999999","#4d4d4d","#1a1a1a","#000000","#ffebee","#ef9a9a","#ef5350","#f44336","#d32f2f","#b71c1c","#e3f2fd","#90caf9","#42a5f5","#2196f3","#1976d2","#0d47a1","#e8f5e9","#a5d6a7","#66bb6a","#4caf50","#388e3c","#1b5e20","#fff3e0","#ffcc80","#ffa726","#ff9800","#f57c00","#e65100","#fafafa","#eeeeee","#bdbdbd","#9e9e9e","#616161","#212121"],Mt=c.memo(({button:s,groupName:e,index:t,isActive:n,isDisabled:a,openDropdown:i,openColorPicker:l,onButtonClick:u,onDropdownSelect:d,onColorSelect:f,setOpenColorPicker:p,dropdownRefs:y})=>{var x;if(s.type==="separator")return r.jsx("div",{className:"toolbar-separator"},`${e}-sep-${t}`);const m=`${e}-${s.command}-${t}`;return r.jsxs("div",{className:"relative",children:[r.jsxs("button",{className:`toolbar-button ${n?"active":""} ${s.type==="dropdown"||s.type==="color"?"dropdown":""}`,title:s.title,"aria-label":s.title,disabled:a,onClick:()=>u(s),onMouseDown:C=>C.preventDefault(),children:[r.jsx("span",{className:"button-icon","aria-hidden":"true",children:s.icon}),(s.type==="dropdown"||s.type==="color")&&r.jsx("span",{className:"dropdown-arrow",children:"▼"})]}),s.type==="dropdown"&&i===s.command&&r.jsx("div",{ref:C=>y.current[s.command]=C,className:"toolbar-dropdown",children:(x=s.options)==null?void 0:x.map(C=>r.jsxs("button",{className:"dropdown-item",onClick:()=>d(s.command,C.value),children:[C.icon&&r.jsx("span",{className:"option-icon",children:C.icon}),r.jsx("span",{className:"option-label",children:C.label})]},C.value))}),s.type==="color"&&l===s.command&&r.jsxs("div",{ref:C=>y.current[s.command]=C,className:"toolbar-color-picker",children:[r.jsxs("div",{className:"color-picker-header",children:[r.jsx("h4",{className:"color-picker-title",children:s.command==="fontColor"?"Text Color":"Background Color"}),r.jsx("button",{className:"color-picker-close",onClick:()=>p(null),"aria-label":"Close color picker",children:"×"})]}),r.jsx("div",{className:"color-grid",children:Pt.map(C=>r.jsx("button",{className:"color-swatch",style:{backgroundColor:C},onClick:()=>f(s.command,C),title:C,"aria-label":`Select color ${C}`},C))}),r.jsxs("div",{className:"color-input-section",children:[r.jsx("input",{type:"color",className:"color-input",onChange:C=>f(s.command,C.target.value),title:"Choose custom color"}),r.jsx("span",{className:"color-input-label",children:"Custom Color"}),r.jsx("button",{className:"color-remove-btn",onClick:()=>f(s.command,s.command==="fontColor"?"inherit":"transparent"),title:"Remove color",children:"Remove"})]})]})]},m)}),Ht={bold:{command:"bold",icon:"B",title:"Bold"},italic:{command:"italic",icon:"I",title:"Italic"},underline:{command:"underline",icon:"U",title:"Underline"},strikethrough:{command:"strikethrough",icon:"S̶",title:"Strikethrough"},subscript:{command:"subscript",icon:"X₂",title:"Subscript"},superscript:{command:"superscript",icon:"X²",title:"Superscript"},h1:{command:"formatBlock",value:"H1",icon:"H1",title:"Heading 1"},h2:{command:"formatBlock",value:"H2",icon:"H2",title:"Heading 2"},h3:{command:"formatBlock",value:"H3",icon:"H3",title:"Heading 3"},h4:{command:"formatBlock",value:"H4",icon:"H4",title:"Heading 4"},h5:{command:"formatBlock",value:"H5",icon:"H5",title:"Heading 5"},h6:{command:"formatBlock",value:"H6",icon:"H6",title:"Heading 6"},bulletList:{command:"insertUnorderedList",icon:"•",title:"Bullet List"},numberedList:{command:"insertOrderedList",icon:"1.",title:"Numbered List"},indent:{command:"indent",icon:"⇥",title:"Increase Indent"},outdent:{command:"outdent",icon:"⇤",title:"Decrease Indent"},alignLeft:{command:"justifyLeft",icon:"⬅",title:"Align Left"},alignCenter:{command:"justifyCenter",icon:"⬌",title:"Align Center"},alignRight:{command:"justifyRight",icon:"➡",title:"Align Right"},alignJustify:{command:"justifyFull",icon:"⬌",title:"Justify"},image:{command:"insertImage",icon:"🖼️",title:"Insert Image"},file:{command:"uploadFile",icon:"📎",title:"Upload File"},table:{command:"insertTable",icon:"⊞",title:"Insert Table"},link:{command:"createLink",icon:"🔗",title:"Insert Link"},unlink:{command:"unlink",icon:"🔗✕",title:"Remove Link"},fontColor:{command:"fontColor",icon:"A",title:"Text Color",type:"color"},backgroundColor:{command:"backgroundColor",icon:"🎨",title:"Background Color",type:"color"},fontSize:{command:"fontSize",icon:"🔤",title:"Font Size",type:"dropdown",options:[{value:"1",label:"8pt"},{value:"2",label:"10pt"},{value:"3",label:"12pt"},{value:"4",label:"14pt"},{value:"5",label:"18pt"},{value:"6",label:"24pt"},{value:"7",label:"36pt"}]},fontFamily:{command:"fontName",icon:"Aa",title:"Font Family",type:"dropdown",options:[{value:"Arial",label:"Arial"},{value:"Georgia",label:"Georgia"},{value:"Times New Roman",label:"Times New Roman"},{value:"Courier New",label:"Courier New"},{value:"Verdana",label:"Verdana"},{value:"Helvetica",label:"Helvetica"}]},specialChar:{command:"insertSpecialChar",icon:"Ω",title:"Special Characters"},horizontalRule:{command:"insertHorizontalRule",icon:"―",title:"Horizontal Rule"},findReplace:{command:"findReplace",icon:"🔍",title:"Find & Replace"},sourceCode:{command:"sourceCode",icon:"</>",title:"Source Code"},fullscreen:{command:"fullscreen",icon:"⛶",title:"Fullscreen"},print:{command:"print",icon:"🖨️",title:"Print"},undo:{command:"undo",icon:"↶",title:"Undo"},redo:{command:"redo",icon:"↷",title:"Redo"},removeFormat:{command:"removeFormat",icon:"🧹",title:"Clear Formatting"}},Ct=({onCommand:s,activeFormats:e,canUndo:t,canRedo:n,toolbarConfig:a,showConfigDropdown:i=!1,configOptions:l,selectedConfigKey:u,onConfigChange:d})=>{const[f,p]=c.useState(null),[y,m]=c.useState(null),x=c.useRef({}),C=c.useMemo(()=>a?a.groups.map(h=>({name:h.name,buttons:h.buttons.map(S=>Ht[S]).filter(Boolean)})).filter(h=>h.buttons.length>0):Ut,[a]),L=c.useCallback(h=>{h.type==="dropdown"?(p(f===h.command?null:h.command),m(null)):h.type==="color"?(m(y===h.command?null:h.command),p(null)):(s(h.command,h.value),p(null),m(null))},[s,f,y]),j=c.useCallback((h,S)=>{s(h,S),p(null)},[s]),Y=c.useCallback((h,S)=>{s(h,S),m(null)},[s]),O=c.useCallback((h,S)=>{const P={bold:"BOLD",italic:"ITALIC",underline:"UNDERLINE",strikethrough:"STRIKETHROUGH",subscript:"SUBSCRIPT",superscript:"SUPERSCRIPT",insertUnorderedList:"INSERT_UNORDERED_LIST",insertOrderedList:"INSERT_ORDERED_LIST",justifyLeft:"JUSTIFY_LEFT",justifyCenter:"JUSTIFY_CENTER",justifyRight:"JUSTIFY_RIGHT",justifyFull:"JUSTIFY_FULL",createLink:"CREATE_LINK"};if(h==="formatBlock"&&S){const V=`FORMAT_${S}`;return e.has(V)}const H=P[h];return H?e.has(H):!1},[e]),A=c.useCallback(h=>h==="undo"?!t:h==="redo"?!n:!1,[t,n]);c.useEffect(()=>{const h=S=>{const P=S.target;!P.closest(".toolbar-dropdown")&&!P.closest(".toolbar-color-picker")&&!P.closest(".toolbar-button")&&(p(null),m(null))};if(f||y){const S=setTimeout(()=>{document.addEventListener("click",h)},0);return()=>{clearTimeout(S),document.removeEventListener("click",h)}}},[f,y]);const q=c.useCallback((h,S,P)=>{if(h.type==="separator")return r.jsx("div",{className:"toolbar-separator"},`${S}-sep-${P}`);const H=O(h.command,h.value),V=A(h.command);return r.jsx(Mt,{button:h,groupName:S,index:P,isActive:H,isDisabled:V,openDropdown:f,openColorPicker:y,onButtonClick:L,onDropdownSelect:j,onColorSelect:Y,setOpenColorPicker:m,dropdownRefs:x},`${S}-${h.command}-${P}`)},[O,A,f,y,L,j,Y]);return r.jsxs("div",{className:"advanced-toolbar toolbar",role:"toolbar","aria-label":"Rich text formatting toolbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("div",{className:"toolbar-left",style:{display:"flex",alignItems:"center",gap:"4px"},children:C.map(h=>r.jsx("div",{className:"toolbar-group",children:h.buttons.map((S,P)=>q(S,h.name,P))},h.name))}),i&&l&&r.jsx("div",{className:"toolbar-right",style:{marginLeft:"auto"},children:r.jsx("div",{className:"toolbar-group",children:r.jsxs("div",{className:"relative",children:[r.jsxs("button",{className:`toolbar-button dropdown ${f==="config"?"active":""}`,title:"Toolbar Configuration","aria-label":"Change toolbar configuration",onClick:h=>{h.stopPropagation(),p(f==="config"?null:"config")},onMouseDown:h=>h.preventDefault(),children:[r.jsx("span",{className:"button-icon","aria-hidden":"true",children:"⚙️"}),r.jsx("span",{className:"dropdown-arrow",children:"▼"})]}),f==="config"&&r.jsxs("div",{ref:h=>x.current.config=h,className:"toolbar-dropdown config-dropdown",style:{position:"absolute",top:"100%",right:0,left:"auto",minWidth:"280px",maxHeight:"300px",overflowY:"auto",zIndex:1e3,backgroundColor:"white",border:"1px solid #ccc",borderRadius:"4px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:[r.jsxs("div",{className:"config-dropdown-header",children:[r.jsx("h4",{className:"config-dropdown-title",children:"Toolbar Configuration"}),r.jsx("button",{className:"config-dropdown-close",onClick:()=>p(null),"aria-label":"Close configuration menu",children:"×"})]}),Object.entries(l).map(([h,S])=>r.jsxs("button",{className:`config-dropdown-item ${u===h?"active":""}`,onClick:()=>{d==null||d(h),p(null)},children:[r.jsx("div",{className:"config-item-name",children:S.name}),S.description&&r.jsx("div",{className:"config-item-description",children:S.description})]},h))]})]})})})]})},gt=()=>{const s=window.getSelection();if(!s||s.rangeCount===0)return{range:null,isCollapsed:!0,activeFormats:new Set,currentBlockFormat:"div"};const e=s.getRangeAt(0),t=kt(),n=St();return{range:e.cloneRange(),isCollapsed:s.isCollapsed,activeFormats:t,currentBlockFormat:n}},bt=s=>{if(!s.range)return;const e=window.getSelection();if(e)try{e.removeAllRanges(),e.addRange(s.range)}catch(t){console.warn("Failed to restore selection:",t)}},$t=()=>{const s=gt();return()=>{bt(s)}},kt=()=>{const s=new Set;try{document.queryCommandState("bold")&&s.add("bold"),document.queryCommandState("italic")&&s.add("italic"),document.queryCommandState("underline")&&s.add("underline"),document.queryCommandState("insertUnorderedList")&&s.add("insertUnorderedList"),document.queryCommandState("insertOrderedList")&&s.add("insertOrderedList"),document.queryCommandState("justifyLeft")&&s.add("justifyLeft"),document.queryCommandState("justifyCenter")&&s.add("justifyCenter"),document.queryCommandState("justifyRight")&&s.add("justifyRight")}catch(e){console.warn("Error checking command state:",e)}return s},St=()=>{var e;try{const t=document.queryCommandValue("formatBlock");if(t)return t.toLowerCase()}catch(t){console.warn("Error getting block format:",t)}const s=window.getSelection();if(s&&s.rangeCount>0){let n=s.getRangeAt(0).commonAncestorContainer;n.nodeType===Node.TEXT_NODE&&(n=n.parentElement||n);const a=(e=n.tagName)==null?void 0:e.toLowerCase();if(["h1","h2","h3","h4","h5","h6","p","div"].includes(a))return a}return"div"},Et=s=>{const e=window.getSelection();if(!e||e.rangeCount===0)return!1;const t=e.getRangeAt(0);return s.contains(t.commonAncestorContainer)},zt=s=>{s.focus();const e=window.getSelection();if(e){const t=document.createRange();t.selectNodeContents(s),t.collapse(!1),e.removeAllRanges(),e.addRange(t)}},Rt=(s,e)=>{s.focus(),e&&bt(e)},Wt={allowedTags:["p","br","strong","em","u","b","i","h1","h2","h3","h4","h5","h6","ul","ol","li","a","span","div"],allowedAttributes:{a:["href","title"],span:["style"],div:["style"],p:["style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"]},allowedProtocols:["http:","https:","mailto:"]};class wt{constructor(e=Wt){Ue(this,"config");this.config=e}sanitizeHtml(e){if(!e||typeof e!="string")return"";const t=document.createElement("div");return t.innerHTML=e,this.sanitizeElement(t),t.innerHTML}sanitizePastedContent(e){let t=this.cleanPasteArtifacts(e),n=this.sanitizeHtml(t);return n=this.normalizeWhitespace(n),n}sanitizeElement(e){var n;const t=Array.from(e.children);for(const a of t){const i=a.tagName.toLowerCase();if(!this.config.allowedTags.includes(i)){if(this.isDangerousTag(i)){a.remove();continue}const l=a.textContent||"";if(l.trim()){const u=document.createTextNode(l);(n=a.parentNode)==null||n.replaceChild(u,a)}else a.remove();continue}this.sanitizeAttributes(a),this.sanitizeElement(a)}}isDangerousTag(e){return["script","iframe","object","embed","form","input","button","textarea","select","option","style","link","meta","base","applet","frame","frameset"].includes(e)}sanitizeAttributes(e){const t=e.tagName.toLowerCase(),n=this.config.allowedAttributes[t]||[],a=Array.from(e.attributes);for(const i of a){const l=i.name.toLowerCase();if(!n.includes(l)){e.removeAttribute(i.name);continue}if(l==="href"){const u=this.sanitizeUrl(i.value);u?e.setAttribute("href",u):e.removeAttribute("href");continue}if(l==="style"){const u=this.sanitizeStyle(i.value);u?e.setAttribute("style",u):e.removeAttribute("style");continue}this.containsScript(i.value)&&e.removeAttribute(i.name)}}sanitizeUrl(e){if(!e||typeof e!="string")return null;const t=e.trim();if(/^(javascript|data|vbscript|file|ftp):/i.test(t))return null;if(t.startsWith("/")||t.startsWith("./")||t.startsWith("../")||t.startsWith("#"))return t;try{const n=new URL(t);if(this.config.allowedProtocols.includes(n.protocol))return t}catch{try{const a=`http://${t}`,i=new URL(a);if(this.config.allowedProtocols.includes(i.protocol))return a}catch{return null}}return null}sanitizeStyle(e){if(!e||typeof e!="string")return null;const t=[/expression\s*\(/i,/javascript\s*:/i,/vbscript\s*:/i,/data\s*:/i,/import\s*['"]/i,/@import/i,/binding\s*:/i,/behavior\s*:/i,/position\s*:\s*fixed/i,/position\s*:\s*absolute/i];for(const l of t)if(l.test(e))return null;const n=["color","background-color","font-size","font-weight","font-style","text-decoration","text-align","margin","padding","border","font-family"],a=e.split(";").filter(l=>l.trim()),i=[];for(const l of a){const[u,d]=l.split(":").map(f=>f.trim());u&&d&&n.includes(u.toLowerCase())&&(this.containsScript(d)||i.push(`${u}: ${d}`))}return i.length>0?i.join("; "):null}containsScript(e){return!e||typeof e!="string"?!1:[/javascript\s*:/i,/vbscript\s*:/i,/data\s*:/i,/on\w+\s*=/i,/<script/i,/<\/script/i,/expression\s*\(/i,/eval\s*\(/i,/setTimeout\s*\(/i,/setInterval\s*\(/i].some(n=>n.test(e))}cleanPasteArtifacts(e){let t=e;return t=t.replace(/<o:p\s*\/?>/gi,""),t=t.replace(/<\/o:p>/gi,""),t=t.replace(/\s*mso-[^:]+:[^;"]+;?/gi,""),t=t.replace(/\s*class="?Mso[^"]*"?/gi,""),t=t.replace(/<p[^>]*>\s*<\/p>/gi,""),t=t.replace(/<div[^>]*>\s*<\/div>/gi,""),t=t.replace(/<font[^>]*>/gi,"<span>"),t=t.replace(/<\/font>/gi,"</span>"),t=t.replace(/<!--[\s\S]*?-->/g,""),t=t.replace(/\s+/g," "),t=t.replace(/>\s+</g,"><"),t.trim()}normalizeWhitespace(e){let t=e;return t=t.replace(/(<br\s*\/?>){2,}/gi,"</p><p>"),t&&!t.match(/^<(p|h[1-6]|ul|ol|div)/i)&&(t=`<p>${t}</p>`),t=t.replace(/<p>\s*<\/p>/gi,""),t}extractPlainText(e){if(!e||typeof e!="string")return"";const t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}isContentSafe(e){return!e||typeof e!="string"?!0:![/<script/i,/javascript\s*:/i,/vbscript\s*:/i,/on\w+\s*=/i,/<iframe/i,/<object/i,/<embed/i,/<form/i,/<input/i,/<button/i].some(n=>n.test(e))}}const Tt=new wt,Lt=({content:s,placeholder:e,onContentChange:t,onFocus:n,onBlur:a,editorRef:i,onSelectionChange:l,onLinkClick:u,height:d="300px"})=>{const[f,p]=c.useState(!1),[y,m]=c.useState(null),x=c.useCallback(()=>{if(i.current&&Et(i.current)){const I=gt();m(I),l&&l(I)}},[i,l]),C=c.useCallback(()=>{i.current&&y&&Rt(i.current,y)},[i,y]),L=I=>{const N=I.currentTarget.innerHTML,z=j(N);t(z)},j=I=>{if(!I||I==="<br>"||I==="<div><br></div>")return"";let D=I.replace(/^<div><br><\/div>$/,"");return D=D.replace(/^<div>(.*)<\/div>$/,"$1"),D},Y=I=>{p(!0),n()},O=I=>{p(!1),a()},A=I=>{I.preventDefault();const D=I.clipboardData;if(!D)return;let N=D.getData("text/html");if(!N){const M=D.getData("text/plain");M&&(N=`<p>${M.replace(/\n/g,"<br>")}</p>`)}if(!N)return;const z=Tt.sanitizePastedContent(N);q(z)},q=I=>{const D=window.getSelection();if(!D||!D.rangeCount)return;const N=D.getRangeAt(0);N.deleteContents();const z=document.createElement("div");z.innerHTML=I;const M=document.createDocumentFragment();for(;z.firstChild;)M.appendChild(z.firstChild);if(N.insertNode(M),N.collapse(!1),D.removeAllRanges(),D.addRange(N),i.current){const ne=i.current.innerHTML;t(j(ne))}},h=I=>{const N=I.target.closest("a[href]");if(N&&N.href){I.preventDefault(),I.stopPropagation(),u&&u(I.nativeEvent,N);return}},S=I=>{I.key==="Enter"&&!I.shiftKey&&P(I)},P=I=>{var de,fe;const D=window.getSelection();if(!D||!D.rangeCount)return!1;const N=D.getRangeAt(0),z=N.startContainer.nodeType===Node.TEXT_NODE?N.startContainer.parentElement:N.startContainer,M=z==null?void 0:z.closest("li");if(!M)return!1;const ne=M.closest("ul, ol");return ne&&(((de=M.textContent)==null?void 0:de.trim())===""||N.startOffset===0&&((fe=M.textContent)==null?void 0:fe.trim())==="")?(I.preventDefault(),H(M,ne),!0):!1},H=(I,D)=>{var M,ne;I.remove();const N=document.createElement("p");N.innerHTML="<br>",D.nextSibling?(M=D.parentNode)==null||M.insertBefore(N,D.nextSibling):(ne=D.parentNode)==null||ne.appendChild(N);const z=window.getSelection();if(z){const oe=document.createRange();oe.setStart(N,0),oe.collapse(!0),z.removeAllRanges(),z.addRange(oe)}if(i.current){const oe=i.current.innerHTML;t(j(oe))}},V=()=>f?!1:!s||s===""||s==="<br>"||s==="<div><br></div>"||s.replace(/<[^>]*>/g,"").trim()==="";return c.useEffect(()=>{i.current&&i.current.innerHTML!==s&&(i.current.innerHTML=s||"")},[s,i]),c.useEffect(()=>(document.addEventListener("selectionchange",x),()=>{document.removeEventListener("selectionchange",x)}),[x]),c.useEffect(()=>{i.current&&(i.current.restoreFocus=C)},[i,C]),r.jsxs("div",{className:"editable-area-container",children:[r.jsx("div",{ref:i,className:"editable-area",contentEditable:!0,onInput:L,onFocus:Y,onBlur:O,onKeyDown:S,onPaste:A,onClick:h,suppressContentEditableWarning:!0,role:"textbox","aria-label":"Rich text editor content area","aria-multiline":"true","aria-describedby":"keyboard-shortcuts-help","data-placeholder":e,style:{height:typeof d=="number"?`${d}px`:d,minHeight:typeof d=="number"?`${d}px`:d}}),V()&&r.jsx("div",{className:"placeholder","aria-hidden":"true",children:e})]})};function xt(s,e,t){return ft.centerCrop(ft.makeAspectCrop({unit:"%",width:90},t,s,e),s,e)}const jt=({isOpen:s,onClose:e,onImageInsert:t})=>{const[n,a]=c.useState("upload"),[,i]=c.useState(null),[l,u]=c.useState(""),[d,f]=c.useState(),[p,y]=c.useState(),[m,x]=c.useState(""),[C,L]=c.useState(void 0),[j,Y]=c.useState(!1),[O,A]=c.useState(!1),[q,h]=c.useState(null),S=c.useRef(null),P=c.useRef(null),H=c.useRef(null),V=10*1024*1024,I=["image/jpeg","image/jpg","image/png","image/gif","image/webp"],D=c.useCallback(()=>{a("upload"),i(null),u(""),f(void 0),y(void 0),x(""),L(void 0),Y(!1),A(!1),h(null),l&&URL.revokeObjectURL(l),m&&URL.revokeObjectURL(m)},[l,m]),N=c.useCallback(()=>{D(),e()},[D,e]),z=c.useCallback(R=>R.size>V?"File size exceeds 10MB limit":I.includes(R.type)?null:"File type not supported. Please select a JPEG, PNG, GIF, or WebP image.",[]),M=c.useCallback(R=>{const B=z(R);if(B){h(B);return}h(null),i(R);const X=URL.createObjectURL(R);u(X),a("crop")},[z]),ne=c.useCallback(R=>{var X;const B=(X=R.target.files)==null?void 0:X[0];B&&M(B)},[M]),oe=c.useCallback(R=>{R.preventDefault(),A(!0)},[]),de=c.useCallback(R=>{R.preventDefault(),A(!1)},[]),fe=c.useCallback(R=>{R.preventDefault(),A(!1);const B=Array.from(R.dataTransfer.files);B.length>0&&M(B[0])},[M]),je=c.useCallback(()=>{var R;(R=S.current)==null||R.click()},[]),ge=c.useCallback(R=>{const{width:B,height:X}=R.currentTarget;f(xt(B,X,C||B/X))},[C]),be=c.useCallback(R=>{if(L(R),P.current){const{width:B,height:X}=P.current;f(xt(B,X,R||B/X))}},[]),ye=c.useCallback(async()=>{if(!p||!P.current||!H.current)return null;const R=P.current,B=H.current,X=B.getContext("2d");if(!X)return null;const ae=R.naturalWidth/R.width,ee=R.naturalHeight/R.height;return B.width=p.width,B.height=p.height,X.drawImage(R,p.x*ae,p.y*ee,p.width*ae,p.height*ee,0,0,p.width,p.height),new Promise(Ae=>{B.toBlob(w=>{if(w){const he=URL.createObjectURL(w);Ae(he)}},"image/jpeg",.9)})},[p]),Ne=c.useCallback(async()=>{Y(!0);try{const R=await ye();R&&(x(R),a("save"))}catch(R){console.error("Error cropping image:",R),h("Failed to process image. Please try again.")}finally{Y(!1)}},[ye]),Ie=c.useCallback(()=>{m&&(t(m),N())},[m,t,N]),Ce=c.useCallback(()=>{m&&URL.revokeObjectURL(m),x(""),a("crop")},[m]),ke=c.useCallback(R=>{if(R===0)return"0 Bytes";const B=1024,X=["Bytes","KB","MB","GB"],ae=Math.floor(Math.log(R)/Math.log(B));return parseFloat((R/Math.pow(B,ae)).toFixed(2))+" "+X[ae]},[]);return s?r.jsx("div",{className:"image-crop-modal",children:r.jsxs("div",{className:"image-crop-modal__content",style:{maxWidth:n==="crop"?"900px":"500px"},children:[r.jsxs("div",{className:"image-crop-modal__header",children:[r.jsx("h2",{className:"image-crop-modal__title",children:n==="upload"?"Upload Image":n==="crop"?"Crop Image":"Save Image"}),r.jsx("button",{onClick:N,className:"image-crop-modal__close","aria-label":"Close",children:r.jsx("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n==="upload"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{padding:"1.5rem"},children:[r.jsx("p",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:"1rem"},children:"Select an image to upload and crop"}),r.jsx("div",{style:{border:`2px dashed ${O?"#3b82f6":"#d1d5db"}`,borderRadius:"0.5rem",padding:"2rem",textAlign:"center",backgroundColor:O?"#eff6ff":"transparent",transition:"all 0.2s",cursor:"pointer"},onDragOver:oe,onDragLeave:de,onDrop:fe,onClick:je,children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("svg",{width:"48",height:"48",style:{marginBottom:"1rem",color:O?"#3b82f6":"#9ca3af"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),r.jsx("p",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:"0.5rem"},children:"Drag and drop your image here, or click to browse"}),r.jsx("button",{type:"button",style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:"500",color:"#3b82f6",backgroundColor:"#eff6ff",border:"1px solid #bfdbfe",borderRadius:"0.375rem",cursor:"pointer",transition:"all 0.2s"},children:"Browse Files"})]})}),r.jsxs("div",{style:{marginTop:"1rem",fontSize:"0.75rem",color:"#6b7280"},children:[r.jsx("p",{children:"Accepted formats: JPEG, PNG, GIF, WebP"}),r.jsxs("p",{children:["Maximum size: ",ke(V)]})]}),q&&r.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"0.375rem",display:"flex",alignItems:"center"},children:[r.jsx("svg",{width:"20",height:"20",style:{color:"#ef4444",marginRight:"0.5rem"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("p",{style:{fontSize:"0.875rem",color:"#dc2626"},children:q})]})]}),r.jsxs("div",{className:"image-crop-modal__footer",children:[r.jsx("div",{}),r.jsx("div",{className:"image-crop-modal__actions",children:r.jsx("button",{onClick:N,className:"image-crop-modal__button image-crop-modal__button--secondary",children:"Cancel"})})]})]}),n==="crop"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"image-crop-modal__controls",children:r.jsxs("div",{className:"image-crop-modal__aspect-controls",children:[r.jsx("span",{className:"image-crop-modal__aspect-label",children:"Aspect Ratio:"}),r.jsx("button",{onClick:()=>be(void 0),className:`image-crop-modal__aspect-button ${C===void 0?"image-crop-modal__aspect-button--active":""}`,children:"Free"}),r.jsx("button",{onClick:()=>be(1),className:`image-crop-modal__aspect-button ${C===1?"image-crop-modal__aspect-button--active":""}`,children:"1:1"}),r.jsx("button",{onClick:()=>be(16/9),className:`image-crop-modal__aspect-button ${C===16/9?"image-crop-modal__aspect-button--active":""}`,children:"16:9"}),r.jsx("button",{onClick:()=>be(4/3),className:`image-crop-modal__aspect-button ${C===4/3?"image-crop-modal__aspect-button--active":""}`,children:"4:3"})]})}),r.jsx("div",{className:"image-crop-modal__crop-area",children:r.jsx(ft,{crop:d,onChange:(R,B)=>f(B),onComplete:R=>y(R),aspect:C,minWidth:50,minHeight:50,children:r.jsx("img",{ref:P,alt:"Crop preview",src:l,style:{maxHeight:"500px",maxWidth:"100%"},onLoad:ge})})}),r.jsxs("div",{className:"image-crop-modal__footer",children:[r.jsx("div",{className:"image-crop-modal__help-text",children:"Drag to select the area you want to crop"}),r.jsxs("div",{className:"image-crop-modal__actions",children:[r.jsx("button",{onClick:N,className:"image-crop-modal__button image-crop-modal__button--secondary",children:"Cancel"}),r.jsx("button",{onClick:Ne,disabled:!p||j,className:"image-crop-modal__button image-crop-modal__button--primary",children:j?"Processing...":"Crop"})]})]})]}),n==="save"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{padding:"1.5rem",textAlign:"center"},children:[r.jsx("p",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:"1.5rem"},children:'Your image has been cropped successfully. Click "Save Image to Editor" to add it to your content.'}),r.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"1.5rem",padding:"1rem",backgroundColor:"#f9fafb",borderRadius:"0.5rem",border:"1px solid #e5e7eb"},children:r.jsx("img",{src:m,alt:"Cropped preview",style:{maxWidth:"300px",maxHeight:"300px",borderRadius:"0.375rem",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}})}),r.jsx("div",{style:{padding:"1rem",backgroundColor:"#f0f9ff",borderRadius:"0.375rem",border:"1px solid #bfdbfe",marginBottom:"1rem"},children:r.jsx("p",{style:{fontSize:"0.875rem",color:"#0c5460",margin:0},children:"✓ Image cropped and ready to be added to your editor"})})]}),r.jsxs("div",{className:"image-crop-modal__footer",children:[r.jsx("div",{}),r.jsxs("div",{className:"image-crop-modal__actions",children:[r.jsx("button",{onClick:Ce,className:"image-crop-modal__button image-crop-modal__button--secondary",children:"Back to Crop"}),r.jsx("button",{onClick:N,className:"image-crop-modal__button image-crop-modal__button--secondary",children:"Cancel"}),r.jsx("button",{onClick:Ie,className:"image-crop-modal__button image-crop-modal__button--primary",children:"Save Image to Editor"})]})]})]}),r.jsx("input",{ref:S,type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp",onChange:ne,style:{display:"none"}}),r.jsx("canvas",{ref:H,style:{display:"none"}})]})}):null},Kt=({isOpen:s,onClose:e,onFileSelect:t,accept:n="*/*",maxSize:a=10*1024*1024,title:i="Upload File",description:l="Select a file to upload"})=>{const[u,d]=c.useState(!1),[f,p]=c.useState(null),y=c.useRef(null),m=c.useCallback(h=>h.size>a?`File size exceeds ${Math.round(a/1048576)}MB limit`:n!=="*/*"&&!n.split(",").map(H=>H.trim()).some(H=>{if(H.startsWith("."))return h.name.toLowerCase().endsWith(H.toLowerCase());if(H.includes("/*")){const V=H.split("/")[0];return h.type.startsWith(V+"/")}else return h.type===H})?`File type not supported. Accepted types: ${n}`:null,[n,a]),x=c.useCallback(h=>{const S=m(h);if(S){p(S);return}p(null),t(h),e()},[m,t,e]),C=c.useCallback(h=>{var P;const S=(P=h.target.files)==null?void 0:P[0];S&&x(S)},[x]),L=c.useCallback(h=>{h.preventDefault(),d(!0)},[]),j=c.useCallback(h=>{h.preventDefault(),d(!1)},[]),Y=c.useCallback(h=>{h.preventDefault(),d(!1);const S=Array.from(h.dataTransfer.files);S.length>0&&x(S[0])},[x]),O=c.useCallback(()=>{var h;(h=y.current)==null||h.click()},[]),A=c.useCallback(h=>{if(h===0)return"0 Bytes";const S=1024,P=["Bytes","KB","MB","GB"],H=Math.floor(Math.log(h)/Math.log(S));return parseFloat((h/Math.pow(S,H)).toFixed(2))+" "+P[H]},[]),q=c.useCallback(()=>n==="*/*"?"All files":n.includes("image/*")?"Images":n.includes("video/*")?"Videos":n.includes("audio/*")?"Audio files":n.replace(/,/g,", "),[n]);return s?r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:i}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs("div",{className:"p-6",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:l}),r.jsx("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${u?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:L,onDragLeave:j,onDrop:Y,children:r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("svg",{className:`w-12 h-12 mb-4 ${u?"text-blue-500":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),r.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Drag and drop your file here, or"}),r.jsx("button",{onClick:O,className:"px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition-colors",children:"Browse Files"})]})}),r.jsxs("div",{className:"mt-4 text-xs text-gray-500 space-y-1",children:[r.jsxs("p",{children:["Accepted types: ",q()]}),r.jsxs("p",{children:["Maximum size: ",A(a)]})]}),f&&r.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-md",children:r.jsxs("div",{className:"flex",children:[r.jsx("svg",{className:"w-5 h-5 text-red-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("p",{className:"text-sm text-red-700",children:f})]})})]}),r.jsx("div",{className:"flex justify-end p-4 border-t border-gray-200 bg-gray-50",children:r.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"})}),r.jsx("input",{ref:y,type:"file",accept:n,onChange:C,className:"hidden"})]})}):null},Gt=({imageElement:s,onUpdate:e,onRemove:t})=>{const[n,a]=c.useState(!1),[i,l]=c.useState({x:0,y:0}),[u,d]=c.useState({width:0,height:0}),[f,p]=c.useState("none"),[y,m]=c.useState(!1),x=c.useRef(null);c.useEffect(()=>{var A;if(s){const q=s.getBoundingClientRect(),h=(A=s.closest(".editable-area"))==null?void 0:A.getBoundingClientRect();h&&l({x:q.left-h.left,y:q.top-h.top}),d({width:s.offsetWidth,height:s.offsetHeight});const S=window.getComputedStyle(s),P=S.display,H=S.marginLeft,V=S.marginRight;p(P==="block"?H==="auto"&&V==="auto"?"center":H==="auto"?"right":"left":"none")}},[s]);const C=c.useCallback(A=>{if(s){switch(p(A),A){case"left":s.style.display="block",s.style.marginLeft="0",s.style.marginRight="auto",s.style.float="none";break;case"center":s.style.display="block",s.style.marginLeft="auto",s.style.marginRight="auto",s.style.float="none";break;case"right":s.style.display="block",s.style.marginLeft="auto",s.style.marginRight="0",s.style.float="none";break;case"none":s.style.display="inline-block",s.style.marginLeft="",s.style.marginRight="",s.style.float="";break}e()}},[s,e]),L=c.useCallback(A=>{if(!s)return;const q=s.naturalHeight/s.naturalWidth,h=A*q;s.style.width=`${A}px`,s.style.height=`${h}px`,d({width:A,height:h}),e()},[s,e]),j=c.useCallback(A=>{if(s){switch(A){case"left":s.style.float="left",s.style.marginRight="15px",s.style.marginBottom="10px",s.style.display="block";break;case"right":s.style.float="right",s.style.marginLeft="15px",s.style.marginBottom="10px",s.style.display="block";break;case"none":s.style.float="none",s.style.marginLeft="",s.style.marginRight="",s.style.marginBottom="";break}e()}},[s,e]),Y=c.useCallback(()=>{if(!s)return;const A=s.alt||"",q=window.prompt("Enter alt text for the image (for accessibility):",A);q!==null&&(s.alt=q,e())},[s,e]),O=c.useCallback(()=>{confirm("Are you sure you want to remove this image?")&&(t(),a(!1))},[t]);return c.useEffect(()=>{const A=h=>{h.stopPropagation(),a(!0)},q=h=>{x.current&&!x.current.contains(h.target)&&a(!1)};return s&&(s.addEventListener("click",A),document.addEventListener("click",q)),()=>{s&&s.removeEventListener("click",A),document.removeEventListener("click",q)}},[s]),!n||!s?null:r.jsxs("div",{ref:x,className:"absolute z-50 bg-white border border-gray-300 rounded-lg shadow-lg p-3 min-w-64",style:{left:i.x+u.width+10,top:i.y,maxWidth:"300px"},children:[r.jsxs("div",{className:"flex items-center justify-between mb-3 pb-2 border-b border-gray-200",children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Image Settings"}),r.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs("div",{className:"mb-3",children:[r.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Width: ",Math.round(u.width),"px"]}),r.jsx("input",{type:"range",min:"50",max:"800",value:u.width,onChange:A=>L(parseInt(A.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),r.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[r.jsx("span",{children:"50px"}),r.jsx("span",{children:"800px"})]})]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Alignment"}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{onClick:()=>C("left"),className:`px-2 py-1 text-xs rounded ${f==="left"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"Left"}),r.jsx("button",{onClick:()=>C("center"),className:`px-2 py-1 text-xs rounded ${f==="center"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"Center"}),r.jsx("button",{onClick:()=>C("right"),className:`px-2 py-1 text-xs rounded ${f==="right"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"Right"}),r.jsx("button",{onClick:()=>C("none"),className:`px-2 py-1 text-xs rounded ${f==="none"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"Inline"})]})]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Text Wrapping"}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{onClick:()=>j("left"),className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 hover:bg-gray-200 rounded transition-colors",children:"Wrap Left"}),r.jsx("button",{onClick:()=>j("right"),className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 hover:bg-gray-200 rounded transition-colors",children:"Wrap Right"}),r.jsx("button",{onClick:()=>j("none"),className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 hover:bg-gray-200 rounded transition-colors",children:"No Wrap"})]})]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Quick Sizes"}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{onClick:()=>L(150),className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 hover:bg-gray-200 rounded transition-colors",children:"Small"}),r.jsx("button",{onClick:()=>L(300),className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 hover:bg-gray-200 rounded transition-colors",children:"Medium"}),r.jsx("button",{onClick:()=>L(500),className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 hover:bg-gray-200 rounded transition-colors",children:"Large"}),r.jsx("button",{onClick:()=>L(s.naturalWidth),className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 hover:bg-gray-200 rounded transition-colors",children:"Original"})]})]}),r.jsxs("div",{className:"flex gap-2 pt-2 border-t border-gray-200",children:[r.jsx("button",{onClick:Y,className:"flex-1 px-2 py-1 text-xs bg-blue-50 text-blue-700 hover:bg-blue-100 rounded transition-colors",children:"Alt Text"}),r.jsx("button",{onClick:O,className:"flex-1 px-2 py-1 text-xs bg-red-50 text-red-700 hover:bg-red-100 rounded transition-colors",children:"Remove"})]})]})},Yt=({isOpen:s,onClose:e,onInsert:t})=>{const[n,a]=c.useState(3),[i,l]=c.useState(3),[u,d]=c.useState(!0),[f]=c.useState(3),[p]=c.useState(3),y=()=>{t(n,i,u),e()};return s?r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Insert Table"}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs("div",{className:"p-6",children:[r.jsx("div",{className:"mb-6",children:r.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[f," × ",p," table"]})}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rows"}),r.jsx("input",{type:"number",min:"1",max:"20",value:n,onChange:m=>a(Math.max(1,parseInt(m.target.value)||1)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Columns"}),r.jsx("input",{type:"number",min:"1",max:"20",value:i,onChange:m=>l(Math.max(1,parseInt(m.target.value)||1)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),r.jsx("div",{className:"mb-6",children:r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:u,onChange:m=>d(m.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),r.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Include header row"})]})}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preview:"}),r.jsx("div",{className:"border border-gray-300 rounded overflow-hidden",children:r.jsx("table",{className:"w-full text-xs",children:r.jsxs("tbody",{children:[Array.from({length:Math.min(n,4)},(m,x)=>r.jsxs("tr",{children:[Array.from({length:Math.min(i,6)},(C,L)=>r.jsx("td",{className:`border border-gray-200 p-1 text-center ${u&&x===0?"bg-gray-100 font-medium":"bg-white"}`,children:u&&x===0?`Header ${L+1}`:`Cell ${x+1},${L+1}`},L)),i>6&&r.jsx("td",{className:"border border-gray-200 p-1 text-center bg-gray-50",children:"..."})]},x)),n>4&&r.jsx("tr",{children:Array.from({length:Math.min(i+(i>6?1:0),7)},(m,x)=>r.jsx("td",{className:"border border-gray-200 p-1 text-center bg-gray-50",children:"..."},x))})]})})})]})]}),r.jsxs("div",{className:"flex justify-end gap-3 p-4 border-t border-gray-200 bg-gray-50",children:[r.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),r.jsx("button",{onClick:y,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 transition-colors",children:"Insert Table"})]})]})}):null},mt={General:["©","®","™","§","¶","†","‡","•","‰","′","″","‴","‹","›","«","»","–","—","…","¡","¿"],Currency:["$","¢","£","¤","¥","€","₹","₽","₩","₪","₫","₦","₡","₨","₱","₵"],Math:["±","×","÷","=","≠","≈","≡","≤","≥","<",">","∞","∑","∏","∂","∆","∇","∈","∉","∋","∌","∩","∪","⊂","⊃","⊆","⊇","⊕","⊗","⊥","∥","∠"],Greek:["Α","Β","Γ","Δ","Ε","Ζ","Η","Θ","Ι","Κ","Λ","Μ","Ν","Ξ","Ο","Π","Ρ","Σ","Τ","Υ","Φ","Χ","Ψ","Ω","α","β","γ","δ","ε","ζ","η","θ","ι","κ","λ","μ","ν","ξ","ο","π","ρ","σ","τ","υ","φ","χ","ψ","ω"],Arrows:["←","↑","→","↓","↔","↕","↖","↗","↘","↙","↚","↛","↜","↝","↞","↟","↠","↡","↢","↣","↤","↥","↦","↧","↨","↩","↪","↫","↬","↭","↮","↯"],Symbols:["☀","☁","☂","☃","☄","★","☆","☇","☈","☉","☊","☋","☌","☍","☎","☏","☐","☑","☒","☓","☔","☕","☖","☗","☘","☙","☚","☛","☜","☝","☞","☟"],Fractions:["½","⅓","⅔","¼","¾","⅕","⅖","⅗","⅘","⅙","⅚","⅛","⅜","⅝","⅞","⅟"]},qt=({isOpen:s,onClose:e,onInsert:t})=>{const[n,a]=c.useState("General"),[i,l]=c.useState(""),u=f=>{t(f),e()},d=i?Object.values(mt).flat().filter(f=>f.includes(i)||f.toLowerCase().includes(i.toLowerCase())):mt[n];return s?r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Special Characters"}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsx("div",{className:"p-4 border-b border-gray-200",children:r.jsx("input",{type:"text",placeholder:"Search characters...",value:i,onChange:f=>l(f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})}),r.jsxs("div",{className:"flex h-96",children:[!i&&r.jsx("div",{className:"w-1/3 border-r border-gray-200 overflow-y-auto",children:r.jsx("div",{className:"p-2",children:Object.keys(mt).map(f=>r.jsx("button",{onClick:()=>a(f),className:`w-full text-left px-3 py-2 rounded-md text-sm transition-colors ${n===f?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-100"}`,children:f},f))})}),r.jsx("div",{className:`${i?"w-full":"w-2/3"} overflow-y-auto`,children:r.jsxs("div",{className:"p-4",children:[r.jsx("div",{className:"grid grid-cols-8 gap-2",children:d.map((f,p)=>r.jsx("button",{onClick:()=>u(f),className:"w-10 h-10 flex items-center justify-center text-lg border border-gray-300 rounded hover:bg-blue-50 hover:border-blue-300 transition-colors",title:`Insert ${f}`,children:f},`${f}-${p}`))}),d.length===0&&r.jsxs("div",{className:"text-center text-gray-500 py-8",children:['No characters found matching "',i,'"']})]})})]}),r.jsx("div",{className:"flex justify-end p-4 border-t border-gray-200 bg-gray-50",children:r.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Close"})})]})}):null},Vt=({isOpen:s,onClose:e,onSubmit:t,title:n,placeholder:a="Enter URL...",initialValue:i="",description:l})=>{const[u,d]=c.useState(i),[f,p]=c.useState("");c.useEffect(()=>{s&&(d(i),p(""))},[s,i]);const y=x=>{if(x.preventDefault(),!u.trim()){p("URL is required");return}try{if(u.trim().startsWith("http://")||u.trim().startsWith("https://")||u.trim().startsWith("/"))t(u.trim()),e();else{const C=`https://${u.trim()}`;new URL(C),t(C),e()}}catch{p("Please enter a valid URL")}},m=x=>{x.key==="Escape"&&e()};return s?r.jsx("div",{className:"modal-backdrop",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,animation:"fadeIn 0.2s ease-out"},onClick:x=>x.target===x.currentTarget&&e(),children:r.jsxs("div",{className:"modal-content",style:{backgroundColor:"white",borderRadius:"12px",padding:"24px",width:"90%",maxWidth:"500px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",animation:"slideIn 0.3s ease-out"},onKeyDown:m,children:[r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"18px",fontWeight:"600",color:"#1f2937"},children:n}),l&&r.jsx("p",{style:{margin:0,fontSize:"14px",color:"#6b7280",lineHeight:"1.5"},children:l})]}),r.jsxs("form",{onSubmit:y,children:[r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("input",{type:"text",value:u,onChange:x=>{d(x.target.value),p("")},placeholder:a,autoFocus:!0,style:{width:"100%",padding:"12px",border:`2px solid ${f?"#ef4444":"#e5e7eb"}`,borderRadius:"8px",fontSize:"16px",outline:"none",transition:"border-color 0.2s ease",boxSizing:"border-box"},onFocus:x=>{x.target.style.borderColor="#3b82f6"},onBlur:x=>{f||(x.target.style.borderColor="#e5e7eb")}}),f&&r.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"14px",color:"#ef4444"},children:f})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",onClick:e,style:{padding:"10px 20px",border:"1px solid #d1d5db",borderRadius:"8px",backgroundColor:"white",color:"#374151",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:x=>{x.currentTarget.style.backgroundColor="#f9fafb",x.currentTarget.style.borderColor="#9ca3af"},onMouseLeave:x=>{x.currentTarget.style.backgroundColor="white",x.currentTarget.style.borderColor="#d1d5db"},children:"Cancel"}),r.jsxs("button",{type:"submit",style:{padding:"10px 20px",border:"none",borderRadius:"8px",backgroundColor:"#3b82f6",color:"white",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:x=>{x.currentTarget.style.backgroundColor="#2563eb"},onMouseLeave:x=>{x.currentTarget.style.backgroundColor="#3b82f6"},children:[i?"Update":"Add"," Link"]})]})]})]})}):null},Jt=({isOpen:s,onClose:e,onFindReplace:t})=>{const[n,a]=c.useState(""),[i,l]=c.useState(""),[u,d]=c.useState("");c.useEffect(()=>{s&&(a(""),l(""),d(""))},[s]);const f=y=>{if(y.preventDefault(),!n.trim()){d("Find text is required");return}t(n.trim(),i.trim()),e()},p=y=>{y.key==="Escape"&&e()};return s?r.jsx("div",{className:"modal-backdrop",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,animation:"fadeIn 0.2s ease-out"},onClick:y=>y.target===y.currentTarget&&e(),children:r.jsxs("div",{className:"modal-content",style:{backgroundColor:"white",borderRadius:"12px",padding:"24px",width:"90%",maxWidth:"500px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",animation:"slideIn 0.3s ease-out"},onKeyDown:p,children:[r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"18px",fontWeight:"600",color:"#1f2937"},children:"🔍 Find & Replace"}),r.jsx("p",{style:{margin:0,fontSize:"14px",color:"#6b7280",lineHeight:"1.5"},children:"Search for text in your document and replace it with new text."})]}),r.jsxs("form",{onSubmit:f,children:[r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Find:"}),r.jsx("input",{type:"text",value:n,onChange:y=>{a(y.target.value),d("")},placeholder:"Enter text to find...",autoFocus:!0,style:{width:"100%",padding:"12px",border:`2px solid ${u?"#ef4444":"#e5e7eb"}`,borderRadius:"8px",fontSize:"16px",outline:"none",transition:"border-color 0.2s ease",boxSizing:"border-box"},onFocus:y=>{y.target.style.borderColor="#3b82f6"},onBlur:y=>{u||(y.target.style.borderColor="#e5e7eb")}}),u&&r.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"14px",color:"#ef4444"},children:u})]}),r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Replace with:"}),r.jsx("input",{type:"text",value:i,onChange:y=>l(y.target.value),placeholder:"Enter replacement text...",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"16px",outline:"none",transition:"border-color 0.2s ease",boxSizing:"border-box"},onFocus:y=>{y.target.style.borderColor="#3b82f6"},onBlur:y=>{y.target.style.borderColor="#e5e7eb"}})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",onClick:e,style:{padding:"10px 20px",border:"1px solid #d1d5db",borderRadius:"8px",backgroundColor:"white",color:"#374151",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:y=>{y.currentTarget.style.backgroundColor="#f9fafb",y.currentTarget.style.borderColor="#9ca3af"},onMouseLeave:y=>{y.currentTarget.style.backgroundColor="white",y.currentTarget.style.borderColor="#d1d5db"},children:"Cancel"}),r.jsx("button",{type:"submit",style:{padding:"10px 20px",border:"none",borderRadius:"8px",backgroundColor:"#3b82f6",color:"white",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:y=>{y.currentTarget.style.backgroundColor="#2563eb"},onMouseLeave:y=>{y.currentTarget.style.backgroundColor="#3b82f6"},children:"Replace All"})]})]})]})}):null},Xt=({isOpen:s,onClose:e,title:t,message:n,type:a="info",autoClose:i=!1,autoCloseDelay:l=3e3})=>{c.useEffect(()=>{if(s&&i){const p=setTimeout(()=>{e()},l);return()=>clearTimeout(p)}},[s,i,l,e]);const u=p=>{p.key==="Escape"&&e()};if(!s)return null;const f=(()=>{switch(a){case"success":return{icon:"✅",iconColor:"#10b981",borderColor:"#10b981",backgroundColor:"#f0fdf4"};case"warning":return{icon:"⚠️",iconColor:"#f59e0b",borderColor:"#f59e0b",backgroundColor:"#fffbeb"};case"error":return{icon:"❌",iconColor:"#ef4444",borderColor:"#ef4444",backgroundColor:"#fef2f2"};default:return{icon:"ℹ️",iconColor:"#3b82f6",borderColor:"#3b82f6",backgroundColor:"#eff6ff"}}})();return r.jsxs("div",{className:"modal-backdrop",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,animation:"fadeIn 0.2s ease-out"},onClick:p=>p.target===p.currentTarget&&e(),children:[r.jsxs("div",{className:"modal-content",style:{backgroundColor:"white",borderRadius:"12px",padding:"24px",width:"90%",maxWidth:"400px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",animation:"slideIn 0.3s ease-out",border:`2px solid ${f.borderColor}`},onKeyDown:u,children:[r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"20px"},children:[r.jsx("div",{style:{fontSize:"24px",flexShrink:0},children:f.icon}),r.jsxs("div",{style:{flex:1},children:[r.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"18px",fontWeight:"600",color:"#1f2937"},children:t}),r.jsx("p",{style:{margin:0,fontSize:"14px",color:"#6b7280",lineHeight:"1.5"},children:n})]})]}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:r.jsx("button",{onClick:e,autoFocus:!0,style:{padding:"10px 20px",border:"none",borderRadius:"8px",backgroundColor:f.iconColor,color:"white",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:p=>{p.currentTarget.style.opacity="0.9"},onMouseLeave:p=>{p.currentTarget.style.opacity="1"},children:"OK"})}),i&&r.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"3px",backgroundColor:f.backgroundColor,borderBottomLeftRadius:"12px",borderBottomRightRadius:"12px",overflow:"hidden"},children:r.jsx("div",{style:{height:"100%",backgroundColor:f.iconColor,animation:`shrink ${l}ms linear`,transformOrigin:"left"}})})]}),r.jsx("style",{children:`
        @keyframes shrink {
          from { transform: scaleX(1); }
          to { transform: scaleX(0); }
        }
      `})]})},Zt=({isOpen:s,linkUrl:e,linkText:t,position:n,onEdit:a,onRemove:i,onGoToLink:l,onClose:u})=>s?r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:999,background:"transparent"},onClick:u}),r.jsxs("div",{style:{position:"fixed",left:`${n.x}px`,top:`${n.y}px`,zIndex:1e3,background:"white",border:"1px solid #d1d5db",borderRadius:"8px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)",padding:"12px 16px",minWidth:"300px",maxWidth:"400px",fontSize:"14px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Helvetica Neue", Arial, sans-serif'},onClick:d=>d.stopPropagation(),children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[r.jsx("span",{style:{color:"#374151",fontWeight:"500"},children:"Go to link:"}),r.jsx("button",{onClick:l,style:{color:"#2563eb",textDecoration:"underline",background:"none",border:"none",cursor:"pointer",fontSize:"14px",padding:"0",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:e,children:e})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[r.jsx("button",{onClick:a,style:{color:"#2563eb",background:"none",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",padding:"4px 8px",borderRadius:"4px",transition:"background-color 0.2s"},onMouseEnter:d=>{d.currentTarget.style.backgroundColor="#eff6ff"},onMouseLeave:d=>{d.currentTarget.style.backgroundColor="transparent"},children:"Change"}),r.jsx("span",{style:{color:"#d1d5db"},children:"|"}),r.jsx("button",{onClick:i,style:{color:"#dc2626",background:"none",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",padding:"4px 8px",borderRadius:"4px",transition:"background-color 0.2s"},onMouseEnter:d=>{d.currentTarget.style.backgroundColor="#fef2f2"},onMouseLeave:d=>{d.currentTarget.style.backgroundColor="transparent"},children:"Remove"})]})]})]}):null,Nt={BOLD:{type:"execCommand",command:"bold",description:"Toggle bold formatting"},ITALIC:{type:"execCommand",command:"italic",description:"Toggle italic formatting"},UNDERLINE:{type:"execCommand",command:"underline",description:"Toggle underline formatting"},STRIKETHROUGH:{type:"execCommand",command:"strikeThrough",description:"Toggle strikethrough formatting"},SUBSCRIPT:{type:"execCommand",command:"subscript",description:"Toggle subscript formatting"},SUPERSCRIPT:{type:"execCommand",command:"superscript",description:"Toggle superscript formatting"},FORMAT_H1:{type:"execCommand",command:"formatBlock",value:"H1",description:"Format as heading 1"},FORMAT_H2:{type:"execCommand",command:"formatBlock",value:"H2",description:"Format as heading 2"},FORMAT_H3:{type:"execCommand",command:"formatBlock",value:"H3",description:"Format as heading 3"},FORMAT_H4:{type:"execCommand",command:"formatBlock",value:"H4",description:"Format as heading 4"},FORMAT_H5:{type:"execCommand",command:"formatBlock",value:"H5",description:"Format as heading 5"},FORMAT_H6:{type:"execCommand",command:"formatBlock",value:"H6",description:"Format as heading 6"},FORMAT_PARAGRAPH:{type:"execCommand",command:"formatBlock",value:"P",description:"Format as paragraph"},FORMAT_BLOCKQUOTE:{type:"execCommand",command:"formatBlock",value:"BLOCKQUOTE",description:"Format as blockquote"},FORMAT_PRE:{type:"execCommand",command:"formatBlock",value:"PRE",description:"Format as preformatted text"},INSERT_UNORDERED_LIST:{type:"execCommand",command:"insertUnorderedList",description:"Create bullet list"},INSERT_ORDERED_LIST:{type:"execCommand",command:"insertOrderedList",description:"Create numbered list"},JUSTIFY_LEFT:{type:"execCommand",command:"justifyLeft",description:"Align text left"},JUSTIFY_CENTER:{type:"execCommand",command:"justifyCenter",description:"Center align text"},JUSTIFY_RIGHT:{type:"execCommand",command:"justifyRight",description:"Align text right"},JUSTIFY_FULL:{type:"execCommand",command:"justifyFull",description:"Justify text"},INDENT:{type:"execCommand",command:"indent",description:"Increase indent"},OUTDENT:{type:"execCommand",command:"outdent",description:"Decrease indent"},FONT_COLOR:{type:"custom",command:"foreColor",description:"Change text color"},BACKGROUND_COLOR:{type:"custom",command:"backColor",description:"Change background color"},FONT_NAME:{type:"execCommand",command:"fontName",description:"Change font family"},FONT_SIZE:{type:"execCommand",command:"fontSize",description:"Change font size"},INSERT_HORIZONTAL_RULE:{type:"execCommand",command:"insertHorizontalRule",description:"Insert horizontal rule"},CREATE_LINK:{type:"custom",command:"createLink",description:"Create hyperlink"},EDIT_LINK:{type:"custom",command:"editLink",description:"Edit existing hyperlink"},UNLINK:{type:"execCommand",command:"unlink",description:"Remove hyperlink"},UNDO:{type:"execCommand",command:"undo",description:"Undo last action"},REDO:{type:"execCommand",command:"redo",description:"Redo last undone action"},REMOVE_FORMAT:{type:"execCommand",command:"removeFormat",description:"Clear all formatting"},INSERT_IMAGE:{type:"custom",command:"insertImage",description:"Insert image"},UPLOAD_FILE:{type:"custom",command:"uploadFile",description:"Upload and insert file"},INSERT_TABLE:{type:"custom",command:"insertTable",description:"Insert table"},INSERT_SPECIAL_CHAR:{type:"custom",command:"insertSpecialChar",description:"Insert special character"},FIND_REPLACE:{type:"custom",command:"findReplace",description:"Find and replace text"},SOURCE_CODE:{type:"custom",command:"sourceCode",description:"Edit HTML source code"},FULLSCREEN:{type:"custom",command:"fullscreen",description:"Toggle fullscreen mode"},PRINT:{type:"custom",command:"print",description:"Print document"},SPELL_CHECK:{type:"custom",command:"spellCheck",description:"Toggle spell check"}},Le=class Le{constructor(){}static getInstance(){return Le.instance||(Le.instance=new Le),Le.instance}executeCommand(e,t,n,a){const i=Nt[e];if(!i)return{success:!1,error:`Unknown command: ${e}`,command:e};if(i.type==="custom")return this.executeCustomCommand(e,t,n);if(i.requiresSelection&&this.isSelectionEmpty())return{success:!1,error:`Command ${e} requires text selection`,command:e};try{n&&document.activeElement!==n&&n.focus();const l=t||i.value||"";return document.execCommand(i.command,!1,l)?{success:!0,command:e,value:l}:{success:!1,error:`Command execution failed: ${i.command}`,command:e,value:l}}catch(l){return{success:!1,error:`Command execution error: ${l instanceof Error?l.message:"Unknown error"}`,command:e,value:t||i.value||""}}}executeCustomCommand(e,t,n){try{switch(n&&document.activeElement!==n&&n.focus(),e){case"FONT_COLOR":return this.setFontColor(t);case"BACKGROUND_COLOR":return this.setBackgroundColor(t);case"CREATE_LINK":return this.createLink(t);case"EDIT_LINK":return this.editLink(t);case"INSERT_IMAGE":return t?this.insertImage(t):this.triggerImageUpload();case"UPLOAD_FILE":return this.uploadFile(t);case"INSERT_TABLE":return this.insertTable(t);case"INSERT_SPECIAL_CHAR":return this.insertSpecialChar(t);case"FIND_REPLACE":return this.findReplace();case"SOURCE_CODE":return this.toggleSourceCode();case"FULLSCREEN":return this.toggleFullscreen();case"PRINT":return this.printDocument();case"SPELL_CHECK":return this.toggleSpellCheck();default:return{success:!1,error:`Unknown custom command: ${e}`,command:e}}}catch(a){return{success:!1,error:`Custom command execution error: ${a instanceof Error?a.message:"Unknown error"}`,command:e,value:t||""}}}isSelectionEmpty(){const e=window.getSelection();return!e||e.isCollapsed}hasMixedFormatting(){const e=window.getSelection();if(!e||e.rangeCount===0)return!1;const t=e.getRangeAt(0);if(!t.collapsed){if(e.toString().length>500)return!0;const a=t.startContainer.nodeType===Node.ELEMENT_NODE?t.startContainer:t.startContainer.parentElement,i=t.endContainer.nodeType===Node.ELEMENT_NODE?t.endContainer:t.endContainer.parentElement;if(a&&i&&a!==i){const l=a.closest("p, div, h1, h2, h3, h4, h5, h6, li, blockquote"),u=i.closest("p, div, h1, h2, h3, h4, h5, h6, li, blockquote");if(l!==u)return!0}}return!1}getActiveFormats(){const e=new Set;try{if(this.hasMixedFormatting())return e;document.queryCommandState("bold")&&e.add("BOLD"),document.queryCommandState("italic")&&e.add("ITALIC"),document.queryCommandState("underline")&&e.add("UNDERLINE"),document.queryCommandState("strikeThrough")&&e.add("STRIKETHROUGH"),document.queryCommandState("subscript")&&e.add("SUBSCRIPT"),document.queryCommandState("superscript")&&e.add("SUPERSCRIPT");const t=this.getCurrentBlockFormat();t==="H1"?e.add("FORMAT_H1"):t==="H2"?e.add("FORMAT_H2"):t==="H3"?e.add("FORMAT_H3"):t==="H4"?e.add("FORMAT_H4"):t==="H5"?e.add("FORMAT_H5"):t==="H6"?e.add("FORMAT_H6"):t==="BLOCKQUOTE"?e.add("FORMAT_BLOCKQUOTE"):t==="PRE"&&e.add("FORMAT_PRE");const n=window.getSelection();if(n&&n.rangeCount>0){let i=n.getRangeAt(0).commonAncestorContainer;for(;i&&i.nodeType!==Node.ELEMENT_NODE&&i.parentNode;)i=i.parentNode;if(i&&i.nodeType===Node.ELEMENT_NODE){const l=i,d=window.getComputedStyle(l).textAlign;d==="center"||l.style.textAlign==="center"?e.add("JUSTIFY_CENTER"):d==="right"||l.style.textAlign==="right"?e.add("JUSTIFY_RIGHT"):d==="justify"||l.style.textAlign==="justify"?e.add("JUSTIFY_FULL"):l.style.textAlign==="left"&&e.add("JUSTIFY_LEFT")}}document.queryCommandState("insertUnorderedList")&&e.add("INSERT_UNORDERED_LIST"),document.queryCommandState("insertOrderedList")&&e.add("INSERT_ORDERED_LIST"),this.isInLink()&&(e.add("CREATE_LINK"),e.add("EDIT_LINK"))}catch(t){console.warn("Error checking command states:",t)}return e}canUndo(){try{return document.queryCommandEnabled("undo")}catch{return!1}}canRedo(){try{return document.queryCommandEnabled("redo")}catch{return!1}}getCurrentBlockFormat(){try{return document.queryCommandValue("formatBlock").toUpperCase()}catch{return""}}createLink(e){const t=window.getSelection();if(!e)return{success:!1,error:"URL is required to create a link",command:"CREATE_LINK"};const n=this.normalizeUrl(e);if(!n)return{success:!1,error:"Invalid URL provided",command:"CREATE_LINK",value:e};try{if(!t||t.isCollapsed){const a=document.createElement("a");if(a.href=n,a.textContent=e,a.target="_blank",a.rel="noopener noreferrer",t&&t.rangeCount>0){const i=t.getRangeAt(0);i.insertNode(a),i.setStartAfter(a),i.setEndAfter(a),t.removeAllRanges(),t.addRange(i)}else{const i=document.querySelector(".editable-area");if(i)i.appendChild(a);else return{success:!1,error:"No cursor position found and no editor element",command:"CREATE_LINK"}}return{success:!0,command:"CREATE_LINK",value:n}}else return document.execCommand("createLink",!1,n)?(setTimeout(()=>{const i=window.getSelection();if(i&&i.rangeCount>0){const l=this.findLinkInSelection(i);if(l)l.setAttribute("target","_blank"),l.setAttribute("rel","noopener noreferrer");else{const u=document.querySelector(".editable-area");u&&u.querySelectorAll(`a[href="${n}"]`).forEach(f=>{f.hasAttribute("target")||(f.setAttribute("target","_blank"),f.setAttribute("rel","noopener noreferrer"))})}}},0),{success:!0,command:"CREATE_LINK",value:n}):{success:!1,error:"Failed to create link",command:"CREATE_LINK",value:n}}catch(a){return{success:!1,error:`Link creation error: ${a instanceof Error?a.message:"Unknown error"}`,command:"CREATE_LINK",value:n}}}editLink(e){const t=window.getSelection();if(!t||!t.rangeCount)return{success:!1,error:"No selection available",command:"EDIT_LINK"};const n=this.findLinkInSelection(t);if(!n)return{success:!1,error:"No link found in current selection or cursor position",command:"EDIT_LINK"};let a=e;if(!a)return{success:!1,error:"URL is required to edit the link",command:"EDIT_LINK"};if(!a||a.trim()==="")return this.removeLinkElement(n);const i=this.normalizeUrl(a);if(!i)return{success:!1,error:"Invalid URL provided",command:"EDIT_LINK",value:a};try{return n.setAttribute("href",i),n.hasAttribute("target")||n.setAttribute("target","_blank"),n.hasAttribute("rel")||n.setAttribute("rel","noopener noreferrer"),{success:!0,command:"EDIT_LINK",value:i}}catch(l){return{success:!1,error:`Link editing error: ${l instanceof Error?l.message:"Unknown error"}`,command:"EDIT_LINK",value:i}}}findLinkInSelection(e){if(!e.rangeCount)return null;const t=e.getRangeAt(0);let n=t.commonAncestorContainer;if(n.nodeType===Node.TEXT_NODE&&(n=n.parentElement),n instanceof HTMLAnchorElement)return n;const a=n.closest("a");if(a instanceof HTMLAnchorElement)return a;if(t.cloneContents().querySelector("a")){const u=document.createTreeWalker(t.commonAncestorContainer,NodeFilter.SHOW_ELEMENT,{acceptNode:f=>f instanceof HTMLAnchorElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});let d=u.nextNode();for(;d;){if(t.intersectsNode(d))return d;d=u.nextNode()}}return null}removeLinkElement(e){var t;try{const n=e.textContent||"",a=document.createTextNode(n);return(t=e.parentNode)==null||t.replaceChild(a,e),{success:!0,command:"EDIT_LINK",value:"Link removed"}}catch(n){return{success:!1,error:`Error removing link: ${n instanceof Error?n.message:"Unknown error"}`,command:"EDIT_LINK"}}}isInLink(){const e=window.getSelection();return!e||!e.rangeCount?!1:this.findLinkInSelection(e)!==null}insertImage(e,t){var n,a,i;if(!this.isValidImageUrl(e))return{success:!1,error:"Invalid image URL provided",command:"INSERT_IMAGE",value:e};try{const l=document.createElement("img");l.src=e,l.alt=(t==null?void 0:t.alt)||"Inserted image",l.className="editor-image",l.draggable=!0,l.style.maxWidth="100%",l.style.height="auto",l.style.cursor="pointer",l.style.border="2px solid transparent",l.style.borderRadius="4px",l.style.transition="all 0.2s ease",t!=null&&t.width&&(l.style.width=`${t.width}px`),t!=null&&t.height&&(l.style.height=`${t.height}px`),t!=null&&t.alignment&&this.applyImageAlignment(l,t.alignment),t!=null&&t.float&&t.float!=="none"&&this.applyImageFloat(l,t.float),l.addEventListener("mouseenter",()=>{l.style.borderColor="#3b82f6",l.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.15)"}),l.addEventListener("mouseleave",()=>{l.style.borderColor="transparent",l.style.boxShadow="none"});const u=window.getSelection();if(u&&u.rangeCount>0){const d=u.getRangeAt(0),f=d.commonAncestorContainer;if(f.nodeType===Node.TEXT_NODE&&((n=f.textContent)!=null&&n.trim())){const p=f,y=((a=p.textContent)==null?void 0:a.substring(0,d.startOffset))||"",m=((i=p.textContent)==null?void 0:i.substring(d.endOffset))||"";if(y||m){const x=document.createElement("p"),C=document.createElement("p"),L=document.createElement("p");y&&(x.textContent=y),L.appendChild(l),m&&(C.textContent=m);const j=p.parentNode;j&&(j.insertBefore(y?x:L,p),y&&j.insertBefore(L,p),m&&j.insertBefore(C,p),j.removeChild(p))}else d.deleteContents(),d.insertNode(l)}else d.deleteContents(),d.insertNode(l);d.setStartAfter(l),d.setEndAfter(l),u.removeAllRanges(),u.addRange(d)}else{const d=document.querySelector(".editable-area");if(d){const f=document.createElement("p");f.appendChild(l),d.appendChild(f)}else return{success:!1,error:"No cursor position found and no editor element",command:"INSERT_IMAGE"}}return{success:!0,command:"INSERT_IMAGE",value:e}}catch(l){return{success:!1,error:`Image insertion error: ${l instanceof Error?l.message:"Unknown error"}`,command:"INSERT_IMAGE",value:e}}}applyImageAlignment(e,t){switch(t){case"left":e.style.display="block",e.style.marginLeft="0",e.style.marginRight="auto";break;case"center":e.style.display="block",e.style.marginLeft="auto",e.style.marginRight="auto";break;case"right":e.style.display="block",e.style.marginLeft="auto",e.style.marginRight="0";break;case"none":e.style.display="inline-block",e.style.marginLeft="",e.style.marginRight="";break}}applyImageFloat(e,t){e.style.float=t,e.style.margin=t==="left"?"0 15px 10px 0":"0 0 10px 15px"}triggerImageUpload(){try{const e=document.createElement("input");return e.type="file",e.accept="image/*",e.style.display="none",e.onchange=t=>{var l;const n=(l=t.target.files)==null?void 0:l[0];if(!n)return;if(!n.type.startsWith("image/")){console.error("Selected file is not an image");return}const a=5*1024*1024;if(n.size>a){console.error("Image file is too large (max 5MB)");return}const i=new FileReader;i.onload=u=>{var f;const d=(f=u.target)==null?void 0:f.result;this.insertImage(d)},i.onerror=()=>{console.error("Failed to read image file")},i.readAsDataURL(n)},document.body.appendChild(e),e.click(),document.body.removeChild(e),{success:!0,command:"INSERT_IMAGE",value:"File upload triggered"}}catch(e){return{success:!1,error:`File upload error: ${e instanceof Error?e.message:"Unknown error"}`,command:"INSERT_IMAGE"}}}uploadFile(e){if(e)return this.insertFileLink(e);try{const t=document.createElement("input");return t.type="file",t.style.display="none",t.onchange=n=>{var u;const a=(u=n.target.files)==null?void 0:u[0];if(!a)return;const i=10*1024*1024;if(a.size>i){console.error("File is too large (max 10MB)");return}const l=URL.createObjectURL(a);this.insertFileLink(l,a.name,a.type)},document.body.appendChild(t),t.click(),document.body.removeChild(t),{success:!0,command:"UPLOAD_FILE",value:"File upload triggered"}}catch(t){return{success:!1,error:`File upload error: ${t instanceof Error?t.message:"Unknown error"}`,command:"UPLOAD_FILE"}}}insertFileLink(e,t,n){try{const a=document.createElement("a");a.href=e,a.download=t||"download",a.target="_blank",a.rel="noopener noreferrer";const i=t||"Download File",l=this.getFileIcon(n);a.innerHTML=`${l} ${i}`,a.style.display="inline-block",a.style.padding="8px 12px",a.style.margin="4px",a.style.backgroundColor="#f0f0f0",a.style.border="1px solid #ccc",a.style.borderRadius="4px",a.style.textDecoration="none",a.style.color="#333";const u=window.getSelection();if(u&&u.rangeCount>0){const d=u.getRangeAt(0);d.deleteContents(),d.insertNode(a),d.setStartAfter(a),d.setEndAfter(a),u.removeAllRanges(),u.addRange(d)}else return{success:!1,error:"No cursor position found",command:"UPLOAD_FILE"};return{success:!0,command:"UPLOAD_FILE",value:e}}catch(a){return{success:!1,error:`File insertion error: ${a instanceof Error?a.message:"Unknown error"}`,command:"UPLOAD_FILE",value:e}}}getFileIcon(e){return e?e.startsWith("image/")?"🖼️":e.startsWith("video/")?"🎥":e.startsWith("audio/")?"🎵":e.includes("pdf")?"📕":e.includes("word")||e.includes("document")?"📝":e.includes("excel")||e.includes("spreadsheet")||e.includes("powerpoint")||e.includes("presentation")?"📊":e.includes("zip")||e.includes("archive")?"🗜️":"📄":"📄"}insertTable(e){try{const t=e?e.split(","):["3","3","true"],n=parseInt(t[0])||3,a=parseInt(t[1])||3,i=t[2]==="true",l=document.createElement("table");l.className="editor-table",l.style.borderCollapse="collapse",l.style.width="100%",l.style.border="1px solid #ccc",l.style.margin="10px 0";const u=document.createElement("tbody");for(let f=0;f<n;f++){const p=document.createElement("tr");for(let y=0;y<a;y++){const m=document.createElement(i&&f===0?"th":"td");m.style.border="1px solid #ccc",m.style.padding="8px",m.style.minWidth="50px",m.style.minHeight="20px",i&&f===0?(m.style.backgroundColor="#f5f5f5",m.style.fontWeight="bold",m.textContent=`Header ${y+1}`):m.innerHTML="&nbsp;",p.appendChild(m)}u.appendChild(p)}l.appendChild(u);const d=window.getSelection();if(d&&d.rangeCount>0){const f=d.getRangeAt(0);f.deleteContents(),f.insertNode(l);const p=l.querySelector("td, th");p&&(f.selectNodeContents(p),f.collapse(!0),d.removeAllRanges(),d.addRange(f))}else return{success:!1,error:"No cursor position found",command:"INSERT_TABLE"};return{success:!0,command:"INSERT_TABLE",value:`${n}x${a} table inserted`}}catch(t){return{success:!1,error:`Table insertion error: ${t instanceof Error?t.message:"Unknown error"}`,command:"INSERT_TABLE"}}}insertSpecialChar(e){if(!e)return{success:!1,error:"No character specified",command:"INSERT_SPECIAL_CHAR"};try{const t=window.getSelection();if(t&&t.rangeCount>0){const n=t.getRangeAt(0);n.deleteContents(),n.insertNode(document.createTextNode(e)),n.setStartAfter(n.endContainer),n.collapse(!0),t.removeAllRanges(),t.addRange(n)}else return{success:!1,error:"No cursor position found",command:"INSERT_SPECIAL_CHAR"};return{success:!0,command:"INSERT_SPECIAL_CHAR",value:e}}catch(t){return{success:!1,error:`Special character insertion error: ${t instanceof Error?t.message:"Unknown error"}`,command:"INSERT_SPECIAL_CHAR"}}}findReplace(){return{success:!1,error:"Find and replace should be handled by the modal system",command:"FIND_REPLACE"}}toggleSourceCode(){try{const e=document.querySelector(".editable-area");if(!e)return{success:!1,error:"Editor element not found",command:"SOURCE_CODE"};const t=e.getAttribute("data-source-mode")==="true";if(t){const n=e.textContent||"";e.innerHTML=n,e.contentEditable="true",e.removeAttribute("data-source-mode"),e.style.fontFamily="",e.style.whiteSpace=""}else{const n=e.innerHTML;e.textContent=n,e.contentEditable="true",e.setAttribute("data-source-mode","true"),e.style.fontFamily="monospace",e.style.whiteSpace="pre-wrap"}return{success:!0,command:"SOURCE_CODE",value:t?"WYSIWYG mode":"Source mode"}}catch(e){return{success:!1,error:`Source code toggle error: ${e instanceof Error?e.message:"Unknown error"}`,command:"SOURCE_CODE"}}}toggleFullscreen(){try{const e=document.querySelector(".wysiwyg-editor");if(!e)return{success:!1,error:"Editor container not found",command:"FULLSCREEN"};const t=e.classList.contains("fullscreen");return t?(e.classList.remove("fullscreen"),document.body.style.overflow=""):(e.classList.add("fullscreen"),document.body.style.overflow="hidden"),{success:!0,command:"FULLSCREEN",value:t?"Exited fullscreen":"Entered fullscreen"}}catch(e){return{success:!1,error:`Fullscreen toggle error: ${e instanceof Error?e.message:"Unknown error"}`,command:"FULLSCREEN"}}}printDocument(){try{const e=document.querySelector(".editable-area");if(!e)return{success:!1,error:"Editor element not found",command:"PRINT"};const t=window.open("","_blank");if(!t)return{success:!1,error:"Could not open print window",command:"PRINT"};const n=e.innerHTML;return t.document.write(`
        <!DOCTYPE html>
        <html>
        <head>
          <title>Print Document</title>
          <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            table { border-collapse: collapse; width: 100%; }
            th, td { border: 1px solid #ccc; padding: 8px; }
            th { background-color: #f5f5f5; font-weight: bold; }
            img { max-width: 100%; height: auto; }
          </style>
        </head>
        <body>
          ${n}
        </body>
        </html>
      `),t.document.close(),t.focus(),t.print(),t.close(),{success:!0,command:"PRINT",value:"Print dialog opened"}}catch(e){return{success:!1,error:`Print error: ${e instanceof Error?e.message:"Unknown error"}`,command:"PRINT"}}}toggleSpellCheck(){try{const e=document.querySelector(".editable-area");if(!e)return{success:!1,error:"Editor element not found",command:"SPELL_CHECK"};const t=e.spellcheck;return e.spellcheck=!t,{success:!0,command:"SPELL_CHECK",value:t?"Spell check disabled":"Spell check enabled"}}catch(e){return{success:!1,error:`Spell check toggle error: ${e instanceof Error?e.message:"Unknown error"}`,command:"SPELL_CHECK"}}}isValidImageUrl(e){if(!e||e.trim()==="")return!1;if(e.startsWith("data:image/")||e.startsWith("blob:"))return!0;try{return new URL(e),/\.(jpg|jpeg|png|gif|bmp|webp|svg)(\?.*)?$/i.test(e)}catch{return!1}}setFontColor(e){if(!e)return{success:!1,error:"Color value is required",command:"FONT_COLOR"};try{return document.execCommand("foreColor",!1,e)?{success:!0,command:"FONT_COLOR",value:e}:{success:!1,error:"Failed to set font color",command:"FONT_COLOR",value:e}}catch(t){return{success:!1,error:`Font color error: ${t instanceof Error?t.message:"Unknown error"}`,command:"FONT_COLOR",value:e}}}setBackgroundColor(e){if(!e)return{success:!1,error:"Color value is required",command:"BACKGROUND_COLOR"};try{return document.execCommand("backColor",!1,e)?{success:!0,command:"BACKGROUND_COLOR",value:e}:{success:!1,error:"Failed to set background color",command:"BACKGROUND_COLOR",value:e}}catch(t){return{success:!1,error:`Background color error: ${t instanceof Error?t.message:"Unknown error"}`,command:"BACKGROUND_COLOR",value:e}}}normalizeUrl(e){if(!e||e.trim()==="")return null;const t=e.trim();try{return/^https?:\/\//i.test(t)?(new URL(t),t):t.includes("@")&&!t.includes(" ")?`mailto:${t}`:`http://${t}`}catch{return null}}};Ue(Le,"instance");let et=Le;const ve=et.getInstance(),Te=new Map,vt=100,Pe=class Pe{static validateConfigStructure(e){if(e==null)return!0;if(typeof e!="object"||Array.isArray(e))return console.warn("Toolbar configuration must be an object, received:",Array.isArray(e)?"array":typeof e),!1;if(e.preset!==void 0&&typeof e.preset!="string")return console.warn("Toolbar configuration preset must be a string, received:",typeof e.preset),!1;if(e.include!==void 0){if(typeof e.include!="object"||e.include===null)return console.warn("Toolbar configuration include must be an object, received:",typeof e.include),!1;const{categories:t,buttons:n,groups:a}=e.include;if(t!==void 0&&!Array.isArray(t))return console.warn("Toolbar configuration include.categories must be an array, received:",typeof t),!1;if(n!==void 0&&!Array.isArray(n))return console.warn("Toolbar configuration include.buttons must be an array, received:",typeof n),!1;if(a!==void 0){if(!Array.isArray(a))return console.warn("Toolbar configuration include.groups must be an array, received:",typeof a),!1;for(let i=0;i<a.length;i++){const l=a[i];if(typeof l!="object"||l===null)return console.warn(`Toolbar configuration include.groups[${i}] must be an object, received:`,typeof l),!1;if(typeof l.name!="string")return console.warn(`Toolbar configuration include.groups[${i}].name must be a string, received:`,typeof l.name),!1;if(!Array.isArray(l.buttons))return console.warn(`Toolbar configuration include.groups[${i}].buttons must be an array, received:`,typeof l.buttons),!1}}}if(e.exclude!==void 0){if(typeof e.exclude!="object"||e.exclude===null)return console.warn("Toolbar configuration exclude must be an object, received:",typeof e.exclude),!1;const{categories:t,buttons:n}=e.exclude;if(t!==void 0&&!Array.isArray(t))return console.warn("Toolbar configuration exclude.categories must be an array, received:",typeof t),!1;if(n!==void 0&&!Array.isArray(n))return console.warn("Toolbar configuration exclude.buttons must be an array, received:",typeof n),!1}if(e.order!==void 0){if(!Array.isArray(e.order))return console.warn("Toolbar configuration order must be an array, received:",typeof e.order),!1;for(let t=0;t<e.order.length;t++){const n=e.order[t];if(typeof n!="string"&&(typeof n!="object"||n===null))return console.warn(`Toolbar configuration order[${t}] must be a string or object, received:`,typeof n),!1;if(typeof n=="object"){if(typeof n.name!="string")return console.warn(`Toolbar configuration order[${t}].name must be a string, received:`,typeof n.name),!1;if(!Array.isArray(n.buttons))return console.warn(`Toolbar configuration order[${t}].buttons must be an array, received:`,typeof n.buttons),!1}}}return!0}static sanitizeConfig(e){if(!e||typeof e!="object")return;const t={};return typeof e.preset=="string"&&(t.preset=e.preset),e.include&&typeof e.include=="object"&&(t.include={},Array.isArray(e.include.categories)&&(t.include.categories=e.include.categories.filter(n=>typeof n=="string")),Array.isArray(e.include.buttons)&&(t.include.buttons=e.include.buttons.filter(n=>typeof n=="string")),Array.isArray(e.include.groups)&&(t.include.groups=e.include.groups.filter(n=>n&&typeof n=="object"&&typeof n.name=="string"&&Array.isArray(n.buttons)).map(n=>({name:n.name,buttons:n.buttons.filter(a=>typeof a=="string")})).filter(n=>n.buttons.length>0))),e.exclude&&typeof e.exclude=="object"&&(t.exclude={},Array.isArray(e.exclude.categories)&&(t.exclude.categories=e.exclude.categories.filter(n=>typeof n=="string")),Array.isArray(e.exclude.buttons)&&(t.exclude.buttons=e.exclude.buttons.filter(n=>typeof n=="string"))),Array.isArray(e.order)&&(t.order=e.order.filter(n=>!!(typeof n=="string"||n&&typeof n=="object"&&typeof n.name=="string"&&Array.isArray(n.buttons))).map(n=>typeof n=="string"?n:{name:n.name,buttons:n.buttons.filter(a=>typeof a=="string")})),t}static resolve(e){var i;let t=e;try{if(e!=null&&!this.validateConfigStructure(e)&&(console.warn("Invalid toolbar configuration structure detected, attempting to sanitize..."),t=this.sanitizeConfig(e),!t))return console.warn("Configuration could not be sanitized, falling back to default configuration"),this.createFallbackConfig()}catch(l){return console.warn("Error validating toolbar configuration, falling back to default:",l),this.createFallbackConfig()}const n=this.generateCacheKey(t),a=Te.get(n);if(a)return this.cloneResolvedConfig(a);try{let l=[];if((t==null?void 0:t.preset)!==void 0&&(l=this.applyPreset(t.preset)),t!=null&&t.include){const f=this.processIncludes(t.include),p=new Set([...l,...f]);l=Array.from(p)}t!=null&&t.exclude&&(l=this.processExcludes(l,t.exclude)),(!t||l.length===0)&&(l=[...this.PRESETS.full]);const d={groups:this.applyOrder(l,t==null?void 0:t.order,(i=t==null?void 0:t.include)==null?void 0:i.groups),enabledButtons:new Set(l)};return this.cacheResult(n,d),d}catch(l){return console.warn("Error processing toolbar configuration, falling back to default:",l),this.createFallbackConfig()}}static createFallbackConfig(){return{groups:[{name:"default",buttons:[...this.PRESETS.full]}],enabledButtons:new Set(this.PRESETS.full)}}static applyPreset(e){if(typeof e!="string")return console.warn(`Preset must be a string, received ${typeof e}, falling back to full preset`),[...this.PRESETS.full];const t=e.trim().toLowerCase();if(t==="")return console.warn("Empty preset name provided, falling back to full preset"),[...this.PRESETS.full];const n=this.PRESETS[t];if(!n){const a=Object.keys(this.PRESETS).join(", ");return console.warn(`Invalid preset "${e}". Available presets: ${a}. Falling back to full preset`),[...this.PRESETS.full]}return[...n]}static processIncludes(e){if(!e||typeof e!="object")return console.warn("Include configuration must be an object, ignoring include settings"),[];const t=new Set;if(e.categories)if(!Array.isArray(e.categories))console.warn("Include categories must be an array, ignoring categories");else for(const n of e.categories){if(typeof n!="string"){console.warn(`Category must be a string, received ${typeof n}, ignoring this category`);continue}const a=n.trim(),i=this.CATEGORY_MAPPINGS[a];if(i)i.forEach(l=>t.add(l));else{const l=Object.keys(this.CATEGORY_MAPPINGS).join(", ");console.warn(`Invalid category "${n}". Available categories: ${l}. Category ignored`)}}if(e.buttons)if(!Array.isArray(e.buttons))console.warn("Include buttons must be an array, ignoring buttons");else for(const n of e.buttons){if(typeof n!="string"){console.warn(`Button must be a string, received ${typeof n}, ignoring this button`);continue}const a=n.trim();if(this.isValidButton(a))t.add(a);else{const i=Array.from(this.VALID_BUTTONS).sort().join(", ");console.warn(`Invalid button "${n}". Available buttons: ${i}. Button ignored`)}}if(e.groups)if(!Array.isArray(e.groups))console.warn("Include groups must be an array, ignoring groups");else for(let n=0;n<e.groups.length;n++){const a=e.groups[n];if(!a||typeof a!="object"){console.warn(`Group at index ${n} must be an object, ignoring this group`);continue}if(typeof a.name!="string"){console.warn(`Group at index ${n} must have a string name, ignoring this group`);continue}if(!Array.isArray(a.buttons)){console.warn(`Group "${a.name}" must have a buttons array, ignoring this group`);continue}for(const i of a.buttons){if(typeof i!="string"){console.warn(`Button in group "${a.name}" must be a string, received ${typeof i}, ignoring this button`);continue}const l=i.trim();this.isValidButton(l)?t.add(l):console.warn(`Invalid button "${i}" in group "${a.name}" ignored`)}}return Array.from(t)}static generateCacheKey(e){if(!e)return"default";try{const t={preset:typeof e.preset=="string"?e.preset:void 0,include:e.include&&typeof e.include=="object"?{categories:Array.isArray(e.include.categories)?e.include.categories.filter(n=>typeof n=="string").sort():void 0,buttons:Array.isArray(e.include.buttons)?e.include.buttons.filter(n=>typeof n=="string").sort():void 0,groups:Array.isArray(e.include.groups)?e.include.groups.filter(n=>n&&typeof n=="object"&&typeof n.name=="string"&&Array.isArray(n.buttons)).map(n=>({name:n.name,buttons:n.buttons.filter(a=>typeof a=="string").sort()})).sort((n,a)=>n.name.localeCompare(a.name)):void 0}:void 0,exclude:e.exclude&&typeof e.exclude=="object"?{categories:Array.isArray(e.exclude.categories)?e.exclude.categories.filter(n=>typeof n=="string").sort():void 0,buttons:Array.isArray(e.exclude.buttons)?e.exclude.buttons.filter(n=>typeof n=="string").sort():void 0}:void 0,order:Array.isArray(e.order)?e.order.map(n=>typeof n=="string"?n:n&&typeof n=="object"&&typeof n.name=="string"&&Array.isArray(n.buttons)?{name:n.name,buttons:n.buttons.filter(a=>typeof a=="string").sort()}:"invalid-order-item"):void 0};return JSON.stringify(t)}catch(t){return console.warn("Failed to generate cache key for toolbar configuration:",t),`malformed-${Date.now()}-${Math.random()}`}}static cloneResolvedConfig(e){return{groups:e.groups.map(t=>({name:t.name,buttons:[...t.buttons]})),enabledButtons:new Set(e.enabledButtons)}}static cacheResult(e,t){if(Te.size>=vt){const n=Te.keys().next().value;n&&Te.delete(n)}Te.set(e,this.cloneResolvedConfig(t))}static clearCache(){Te.clear()}static getCacheStats(){return{size:Te.size,maxSize:vt}}static processExcludes(e,t){if(!t||typeof t!="object")return console.warn("Exclude configuration must be an object, ignoring exclude settings"),e;const n=new Set;if(t.categories)if(!Array.isArray(t.categories))console.warn("Exclude categories must be an array, ignoring categories");else for(const a of t.categories){if(typeof a!="string"){console.warn(`Exclude category must be a string, received ${typeof a}, ignoring this category`);continue}const i=a.trim(),l=this.CATEGORY_MAPPINGS[i];if(l)l.forEach(u=>n.add(u));else{const u=Object.keys(this.CATEGORY_MAPPINGS).join(", ");console.warn(`Invalid exclude category "${a}". Available categories: ${u}. Category ignored`)}}if(t.buttons)if(!Array.isArray(t.buttons))console.warn("Exclude buttons must be an array, ignoring buttons");else for(const a of t.buttons){if(typeof a!="string"){console.warn(`Exclude button must be a string, received ${typeof a}, ignoring this button`);continue}const i=a.trim();if(this.isValidButton(i))n.add(i);else{const l=Array.from(this.VALID_BUTTONS).sort().join(", ");console.warn(`Invalid exclude button "${a}". Available buttons: ${l}. Button ignored`)}}return e.filter(a=>!n.has(a))}static applyOrder(e,t,n){return t&&t.length>0?this.processCustomOrder(e,t):n&&n.length>0?this.processIncludeGroups(e,n):this.createDefaultGroups(e)}static processCustomOrder(e,t){if(!Array.isArray(t))return console.warn("Order configuration must be an array, falling back to default grouping"),this.createDefaultGroups(e);const n=[],a=new Set,i=new Set(e);for(let u=0;u<t.length;u++){const d=t[u];if(typeof d=="string"){const f=d.trim();i.has(f)&&this.isValidButton(f)?(n.push({name:`group-${n.length}`,buttons:[f]}),a.add(f)):this.isValidButton(f)||console.warn(`Invalid button "${d}" in order configuration ignored`)}else if(d&&typeof d=="object"){if(!("name"in d)||typeof d.name!="string"){console.warn(`Order item at index ${u} must have a string name property, ignoring this item`);continue}if(!("buttons"in d)||!Array.isArray(d.buttons)){console.warn(`Order item "${d.name}" at index ${u} must have a buttons array, ignoring this item`);continue}const f=[];for(const p of d.buttons){if(typeof p!="string"){console.warn(`Button in order group "${d.name}" must be a string, received ${typeof p}, ignoring this button`);continue}const y=p.trim();if(!this.isValidButton(y)){console.warn(`Invalid button "${p}" in order group "${d.name}" ignored`);continue}i.has(y)&&f.push(y)}f.length>0&&(n.push({name:d.name,buttons:f}),f.forEach(p=>a.add(p)))}else console.warn(`Order item at index ${u} must be a string or object, received ${typeof d}, ignoring this item`)}const l=e.filter(u=>!a.has(u));return l.length>0&&n.push({name:"remaining",buttons:l}),n}static processIncludeGroups(e,t){if(!Array.isArray(t))return console.warn("Include groups must be an array, falling back to default grouping"),this.createDefaultGroups(e);const n=[],a=new Set,i=new Set(e);for(let u=0;u<t.length;u++){const d=t[u];if(!d||typeof d!="object"){console.warn(`Include group at index ${u} must be an object, ignoring this group`);continue}if(!("name"in d)||typeof d.name!="string"){console.warn(`Include group at index ${u} must have a string name property, ignoring this group`);continue}if(!("buttons"in d)||!Array.isArray(d.buttons)){console.warn(`Include group "${d.name}" at index ${u} must have a buttons array, ignoring this group`);continue}const f=[];for(const p of d.buttons){if(typeof p!="string"){console.warn(`Button in include group "${d.name}" must be a string, received ${typeof p}, ignoring this button`);continue}const y=p.trim();if(!this.isValidButton(y)){console.warn(`Invalid button "${p}" in include group "${d.name}" ignored`);continue}i.has(y)&&f.push(y)}f.length>0&&(n.push({name:d.name,buttons:f}),f.forEach(p=>a.add(p)))}const l=e.filter(u=>!a.has(u));return l.length>0&&n.push({name:"remaining",buttons:l}),n}static createDefaultGroups(e){const t=[],n=new Set(e);for(const[a,i]of Object.entries(this.CATEGORY_MAPPINGS)){const l=i.filter(u=>n.has(u));l.length>0&&t.push({name:a,buttons:l})}return t}static isValidButton(e){return this.VALID_BUTTONS.has(e)}};Ue(Pe,"CATEGORY_MAPPINGS",{formatting:["bold","italic","underline","strikethrough","subscript","superscript"],structure:["h1","h2","h3","h4","h5","h6"],lists:["bulletList","numberedList","indent","outdent"],alignment:["alignLeft","alignCenter","alignRight","alignJustify"],media:["image","file","table"],links:["link","unlink"],advanced:["fontColor","backgroundColor","fontSize","fontFamily","specialChar","horizontalRule","findReplace","sourceCode","fullscreen","print","undo","redo","removeFormat"]}),Ue(Pe,"PRESETS",{minimal:["bold","italic","underline"],standard:["bold","italic","underline","h1","h2","h3","bulletList","numberedList","link","image"],full:["bold","italic","underline","strikethrough","h1","h2","h3","h4","h5","h6","bulletList","numberedList","indent","outdent","alignLeft","alignCenter","alignRight","alignJustify","image","file","table","link","unlink","fontColor","backgroundColor","fontSize","fontFamily","subscript","superscript","specialChar","horizontalRule","findReplace","sourceCode","fullscreen","print","undo","redo","removeFormat"]}),Ue(Pe,"VALID_BUTTONS",new Set(Object.values(Pe.CATEGORY_MAPPINGS).flat()));let tt=Pe;const It=({initialContent:s="",placeholder:e="Start typing...",onChange:t,onFocus:n,onBlur:a,toolbarConfig:i,showConfigDropdown:l=!1,configOptions:u,selectedConfigKey:d,onConfigChange:f,height:p="300px"})=>{const[y,m]=c.useState(s),[x,C]=c.useState(!1),[L,j]=c.useState(new Set),[Y,O]=c.useState(!1),[A,q]=c.useState(!1),[h,S]=c.useState(!1),[P,H]=c.useState(!1),[V,I]=c.useState(null),[D,N]=c.useState(!1),[z,M]=c.useState(!1),[ne,oe]=c.useState(!1),[de,fe]=c.useState("create"),[je,ge]=c.useState(""),[be,ye]=c.useState(!1),[Ne,Ie]=c.useState(!1),[Ce,ke]=c.useState({title:"",message:"",type:"info"}),[R,B]=c.useState(null),[X,ae]=c.useState(!1),[ee,Ae]=c.useState({url:"",text:"",position:{x:0,y:0},element:null}),w=c.useRef(null),he=c.useRef(null),Se=c.useMemo(()=>tt.resolve(i),[i]),Ee=c.useMemo(()=>Se,[Se]),J=c.useCallback(()=>{if(!x||!w.current)return;const b=ve.getActiveFormats();j(b),O(ve.canUndo()),q(ve.canRedo())},[x]),K=c.useCallback(b=>{he.current&&(he.current.textContent=b,setTimeout(()=>{he.current&&(he.current.textContent="")},1e3))},[]),Re=c.useCallback((b,E)=>{const k={bold:"bold",italic:"italic",underline:"underline",insertUnorderedList:"bullet list",insertOrderedList:"numbered list",justifyLeft:"left aligned",justifyCenter:"center aligned",justifyRight:"right aligned",createLink:"link",unlink:"link removed",insertImage:"image inserted",uploadFile:"file uploaded",undo:"undone",redo:"redone",removeFormat:"formatting cleared"};return b==="formatBlock"&&E?`heading ${E.toLowerCase()}`:k[b]||b},[]),Me=c.useCallback(b=>{b.stopPropagation();const E=b.target;I(E)},[]),Ge=c.useCallback(b=>{const E=b.target;b.dataTransfer&&(b.dataTransfer.effectAllowed="move",b.dataTransfer.setData("text/html",E.outerHTML),E.style.opacity="0.5")},[]),_e=c.useCallback(b=>{const E=b.target;E.style.opacity="1"},[]),Fe=c.useCallback(()=>{if(!w.current)return;const b=w.current.querySelectorAll("img.editor-image");Array.from(b).forEach(k=>{k.removeEventListener("click",Me),k.addEventListener("click",Me),k.addEventListener("dragstart",Ge),k.addEventListener("dragend",_e)})},[Me,Ge,_e]),rt=c.useCallback(b=>{const E=ve.insertImage(b);E.success?(K("Image inserted"),setTimeout(()=>{if(w.current){const k=w.current.innerHTML;m(k),t==null||t(k),J(),Fe()}},0)):(console.warn("Image insertion failed:",E.error),K("Image insertion failed"))},[t,J,K,Fe]),Ye=c.useCallback(()=>{if(w.current){const b=w.current.innerHTML;m(b),t==null||t(b)}},[t]),qe=c.useCallback(()=>{if(V&&V.parentNode){if(V.parentNode.removeChild(V),I(null),w.current){const b=w.current.innerHTML;m(b),t==null||t(b)}K("Image removed")}},[V,t,K]),Ve=c.useCallback(b=>{const E=URL.createObjectURL(b),k=document.createElement("a");k.href=E,k.download=b.name,k.target="_blank",k.rel="noopener noreferrer";const U=nt(b.type);k.innerHTML=`${U} ${b.name}`,k.style.display="inline-block",k.style.padding="8px 12px",k.style.margin="4px",k.style.backgroundColor="#f0f0f0",k.style.border="1px solid #ccc",k.style.borderRadius="4px",k.style.textDecoration="none",k.style.color="#333";const G=window.getSelection();if(G&&G.rangeCount>0){const se=G.getRangeAt(0);se.deleteContents(),se.insertNode(k),se.setStartAfter(k),se.setEndAfter(k),G.removeAllRanges(),G.addRange(se),K("File uploaded and inserted"),setTimeout(()=>{if(w.current){const ie=w.current.innerHTML;m(ie),t==null||t(ie),J()}},0)}else K("File upload failed - no cursor position");H(!1)},[t,J,K]),nt=c.useCallback(b=>b.startsWith("image/")?"🖼️":b.startsWith("video/")?"🎥":b.startsWith("audio/")?"🎵":b.includes("pdf")?"📕":b.includes("word")||b.includes("document")?"📝":b.includes("excel")||b.includes("spreadsheet")||b.includes("powerpoint")||b.includes("presentation")?"📊":b.includes("zip")||b.includes("archive")?"🗜️":"📄",[]),Je=c.useCallback((b,E,k)=>{if(!w.current)return;const U=`${b},${E},${k}`,G=ve.executeCommand("INSERT_TABLE",U,w.current);G.success?(K("Table inserted"),setTimeout(()=>{if(w.current){const se=w.current.innerHTML;m(se),t==null||t(se),J()}},0)):(console.warn("Table insertion failed:",G.error),K("Table insertion failed")),N(!1)},[t,J,K]),Xe=c.useCallback(b=>{if(!w.current)return;const E=ve.executeCommand("INSERT_SPECIAL_CHAR",b,w.current);E.success?(K(`Special character ${b} inserted`),setTimeout(()=>{if(w.current){const k=w.current.innerHTML;m(k),t==null||t(k),J()}},0)):(console.warn("Special character insertion failed:",E.error),K("Special character insertion failed")),M(!1)},[t,J,K]),ot=c.useCallback(b=>{if(!w.current)return;if(R&&de==="create"){const U=window.getSelection();U&&(U.removeAllRanges(),U.addRange(R),w.current.focus())}const E=de==="create"?"CREATE_LINK":"EDIT_LINK",k=ve.executeCommand(E,b,w.current);k.success?(K(`Link ${de==="create"?"created":"updated"}`),setTimeout(()=>{if(w.current){const G=w.current.innerHTML;m(G),t==null||t(G),J()}},0)):Oe("Error",k.error||"Failed to create link","error"),B(null),ge(""),oe(!1)},[de,R,t,J,K]),at=c.useCallback((b,E)=>{if(!w.current)return;const k=w.current.innerHTML,U=k.replace(new RegExp(b,"gi"),E);if(k!==U){w.current.innerHTML=U,m(U),t==null||t(U);const G=(k.match(new RegExp(b,"gi"))||[]).length;Oe("Find & Replace",`Replaced ${G} occurrence(s)`,"success"),K(`Replaced ${G} occurrences`)}else Oe("Find & Replace","No matches found","info")},[t,K]),Oe=c.useCallback((b,E,k="info")=>{ke({title:b,message:E,type:k}),Ie(!0)},[]),st=c.useCallback((b,E)=>{b.preventDefault(),b.stopPropagation();const k=E.getBoundingClientRect(),U={x:k.left,y:k.bottom+5};Ae({url:E.href,text:E.textContent||"",position:U,element:E}),ae(!0)},[]),it=c.useCallback(()=>{ee.element&&(ge(ee.element.href),fe("edit"),oe(!0),ae(!1))},[ee.element]),lt=c.useCallback(()=>{var b;if(ee.element){const E=ee.element.textContent||"",k=document.createTextNode(E);if((b=ee.element.parentNode)==null||b.replaceChild(k,ee.element),w.current){const U=w.current.innerHTML;m(U),t==null||t(U)}K("Link removed"),ae(!1)}},[ee.element,t,K]),ct=c.useCallback(()=>{ee.url&&(window.open(ee.url,"_blank","noopener,noreferrer"),ae(!1))},[ee.url]),He=c.useCallback(()=>{ae(!1)},[]),De=c.useCallback((b,E,k=!1)=>{if(!w.current)return;const U=window.getSelection();let G=null;if(U&&U.rangeCount>0){const te=U.getRangeAt(0);typeof te.cloneRange=="function"&&(G=te.cloneRange())}if(b==="insertImage"){S(!0);return}if(b==="uploadFile"){H(!0);return}if(b==="insertTable"){N(!0);return}if(b==="insertSpecialChar"){M(!0);return}if(b==="createLink"){B(G),fe("create"),ge(""),oe(!0);return}if(b==="editLink"){const te=window.getSelection();let re=null;if(te&&te.rangeCount>0){const le=te.getRangeAt(0),pe=o=>{var g;if(o.nodeType===Node.TEXT_NODE)return((g=o.parentElement)==null?void 0:g.closest("a"))||null;if(o.nodeType===Node.ELEMENT_NODE){const v=o;return v.tagName==="A"?v:v.closest("a")||null}return null};if(re=pe(le.startContainer),!re&&!te.isCollapsed){const o=pe(le.endContainer);o&&(re=o)}if(re||(re=pe(le.commonAncestorContainer)),!re&&w.current){const o=w.current.querySelectorAll("a[href]");for(const g of Array.from(o))if(le.intersectsNode(g)){re=g;break}}}if(!re&&w.current){const le=w.current.querySelectorAll("a[href]");le.length===1&&(re=le[0])}if(re&&re.href){ge(re.href),fe("edit"),oe(!0);return}Oe("Edit Link","Please place your cursor on a link to edit it, or select the link text first","info");return}if(b==="findReplace"){ye(!0);return}let ie={bold:"BOLD",italic:"ITALIC",underline:"UNDERLINE",strikethrough:"STRIKETHROUGH",subscript:"SUBSCRIPT",superscript:"SUPERSCRIPT",formatBlock:"FORMAT_H1",fontSize:"FONT_SIZE",fontName:"FONT_NAME",fontColor:"FONT_COLOR",backgroundColor:"BACKGROUND_COLOR",insertUnorderedList:"INSERT_UNORDERED_LIST",insertOrderedList:"INSERT_ORDERED_LIST",indent:"INDENT",outdent:"OUTDENT",justifyLeft:"JUSTIFY_LEFT",justifyCenter:"JUSTIFY_CENTER",justifyRight:"JUSTIFY_RIGHT",justifyFull:"JUSTIFY_FULL",createLink:"CREATE_LINK",editLink:"EDIT_LINK",unlink:"UNLINK",insertHorizontalRule:"INSERT_HORIZONTAL_RULE",findReplace:"FIND_REPLACE",sourceCode:"SOURCE_CODE",fullscreen:"FULLSCREEN",print:"PRINT",spellCheck:"SPELL_CHECK",undo:"UNDO",redo:"REDO",removeFormat:"REMOVE_FORMAT"}[b];if(b==="formatBlock"&&E&&(ie=`FORMAT_${E}`),ie){const te=ve.executeCommand(ie,E,w.current);if(te.success){const re=Re(b,E),pe=L.has(ie)?"removed":"applied";K(`${re} ${pe}`),setTimeout(()=>{if(w.current){const o=w.current.innerHTML;m(o),t==null||t(o),J()}},0)}else console.warn("Command execution failed:",te.error),K("Command failed")}},[t,J,L,Re,K]),xe=c.useCallback(b=>{if(!x)return;const{ctrlKey:E,metaKey:k,key:U,shiftKey:G}=b;if(!(E||k))return;const te={b:{command:"bold"},i:{command:"italic"},u:{command:"underline"},k:{command:"createLink"},z:{command:G?"redo":"undo"},y:{command:"redo"},1:{command:"formatBlock",value:"H1"},2:{command:"formatBlock",value:"H2"},3:{command:"formatBlock",value:"H3"},l:{command:G?"insertOrderedList":"justifyLeft"},e:{command:"justifyCenter"},r:{command:"justifyRight"},"\\":{command:"removeFormat"}}[U.toLowerCase()];te&&(b.preventDefault(),De(te.command,te.value,!0))},[x,De]),$e=c.useCallback(b=>{m(b),t==null||t(b),setTimeout(J,0)},[t,J]),ze=c.useCallback(b=>{J()},[J]),Ze=c.useCallback(()=>{C(!0),n==null||n(),setTimeout(J,0)},[n,J]),dt=c.useCallback(()=>{C(!1),a==null||a()},[a]);c.useEffect(()=>{x&&J()},[x,J]),c.useEffect(()=>{Fe(),Qe()},[y,Fe]);const Qe=c.useCallback(()=>{if(!w.current)return;w.current.querySelectorAll("a[href]").forEach(E=>{const k=E;k.hasAttribute("target")||k.setAttribute("target","_blank"),k.hasAttribute("rel")||k.setAttribute("rel","noopener noreferrer")})},[]);return c.useEffect(()=>{const b=E=>{const k=E.target;!k.closest("img.editor-image")&&!k.closest(".image-manager")&&I(null)};return document.addEventListener("click",b),()=>document.removeEventListener("click",b)},[]),c.useEffect(()=>{if(!w.current)return;const b=w.current,E=U=>{U.preventDefault(),U.dataTransfer.dropEffect="move"},k=U=>{var se;U.preventDefault();const G=(se=U.dataTransfer)==null?void 0:se.getData("text/html");if(G&&G.includes("<img")){const ie=window.getSelection();if(ie&&ie.rangeCount>0){const te=ie.getRangeAt(0),re=document.createElement("div");re.innerHTML=G;const le=re.querySelector("img");if(le){const pe=b.querySelector(`img[src="${le.src}"]`);pe&&pe!==le&&pe.remove(),te.deleteContents(),te.insertNode(le);const o=b.innerHTML;m(o),t==null||t(o)}}}};return b.addEventListener("dragover",E),b.addEventListener("drop",k),()=>{b.removeEventListener("dragover",E),b.removeEventListener("drop",k)}},[t]),r.jsxs("div",{className:"wysiwyg-editor",onKeyDown:xe,role:"application","aria-label":"Rich text editor with keyboard shortcuts",children:[r.jsx(Ct,{onCommand:De,activeFormats:L,canUndo:Y,canRedo:A,toolbarConfig:Ee,showConfigDropdown:l,configOptions:u,selectedConfigKey:d,onConfigChange:f}),r.jsx(Lt,{content:y,placeholder:e,onContentChange:$e,onFocus:Ze,onBlur:dt,editorRef:w,onSelectionChange:ze,onLinkClick:st,height:p}),r.jsx("div",{ref:he,"aria-live":"polite","aria-atomic":"true",className:"sr-only",role:"status"}),r.jsx("div",{className:"sr-only",id:"keyboard-shortcuts-help",children:"Keyboard shortcuts: Ctrl+B for bold, Ctrl+I for italic, Ctrl+U for underline, Ctrl+K for link, Ctrl+Z for undo, Ctrl+Y for redo, Ctrl+1/2/3 for headings, Ctrl+L for left align, Ctrl+E for center align, Ctrl+R for right align, Ctrl+Shift+L for numbered list, Ctrl+\\ for clear formatting"}),r.jsx(jt,{isOpen:h,onClose:()=>S(!1),onImageInsert:rt}),r.jsx(Kt,{isOpen:P,onClose:()=>H(!1),onFileSelect:Ve,accept:"*/*",maxSize:10*1024*1024,title:"Upload File",description:"Select a file to upload"}),r.jsx(Yt,{isOpen:D,onClose:()=>N(!1),onInsert:Je}),r.jsx(qt,{isOpen:z,onClose:()=>M(!1),onInsert:Xe}),r.jsx(Vt,{isOpen:ne,onClose:()=>oe(!1),onSubmit:ot,title:de==="create"?"Insert Link":"Edit Link",placeholder:"https://example.com",initialValue:je,description:de==="create"?"Enter the URL for the link":"Update the URL for this link"}),r.jsx(Jt,{isOpen:be,onClose:()=>ye(!1),onFindReplace:at}),r.jsx(Xt,{isOpen:Ne,onClose:()=>Ie(!1),title:Ce.title,message:Ce.message,type:Ce.type}),r.jsx(Zt,{isOpen:X,linkUrl:ee.url,linkText:ee.text,position:ee.position,onEdit:it,onRemove:lt,onGoToLink:ct,onClose:He}),V&&r.jsx(Gt,{imageElement:V,onUpdate:Ye,onRemove:qe})]})},Qt=[{command:"bold",icon:"B",title:"Bold"},{command:"italic",icon:"I",title:"Italic"},{command:"underline",icon:"U",title:"Underline"},{command:"formatBlock",value:"H1",icon:"H1",title:"Heading 1"},{command:"formatBlock",value:"H2",icon:"H2",title:"Heading 2"},{command:"formatBlock",value:"H3",icon:"H3",title:"Heading 3"},{command:"insertUnorderedList",icon:"•",title:"Bullet List"},{command:"insertOrderedList",icon:"1.",title:"Numbered List"},{command:"justifyLeft",icon:"⬅",title:"Align Left"},{command:"justifyCenter",icon:"⬌",title:"Align Center"},{command:"justifyRight",icon:"➡",title:"Align Right"},{command:"createLink",icon:"🔗",title:"Insert Link"},{command:"editLink",icon:"✏️🔗",title:"Edit Link"},{command:"unlink",icon:"🔗✕",title:"Remove Link"},{command:"insertImage",icon:"🖼️",title:"Insert Image"},{command:"uploadFile",icon:"📎",title:"Upload File"},{command:"undo",icon:"↶",title:"Undo"},{command:"redo",icon:"↷",title:"Redo"},{command:"removeFormat",icon:"✕",title:"Clear Formatting"}],er={bold:{command:"bold",icon:"B",title:"Bold"},italic:{command:"italic",icon:"I",title:"Italic"},underline:{command:"underline",icon:"U",title:"Underline"},strikethrough:{command:"strikethrough",icon:"S̶",title:"Strikethrough"},subscript:{command:"subscript",icon:"X₂",title:"Subscript"},superscript:{command:"superscript",icon:"X²",title:"Superscript"},h1:{command:"formatBlock",value:"H1",icon:"H1",title:"Heading 1"},h2:{command:"formatBlock",value:"H2",icon:"H2",title:"Heading 2"},h3:{command:"formatBlock",value:"H3",icon:"H3",title:"Heading 3"},h4:{command:"formatBlock",value:"H4",icon:"H4",title:"Heading 4"},h5:{command:"formatBlock",value:"H5",icon:"H5",title:"Heading 5"},h6:{command:"formatBlock",value:"H6",icon:"H6",title:"Heading 6"},bulletList:{command:"insertUnorderedList",icon:"•",title:"Bullet List"},numberedList:{command:"insertOrderedList",icon:"1.",title:"Numbered List"},indent:{command:"indent",icon:"⇥",title:"Increase Indent"},outdent:{command:"outdent",icon:"⇤",title:"Decrease Indent"},alignLeft:{command:"justifyLeft",icon:"⬅",title:"Align Left"},alignCenter:{command:"justifyCenter",icon:"⬌",title:"Align Center"},alignRight:{command:"justifyRight",icon:"➡",title:"Align Right"},alignJustify:{command:"justifyFull",icon:"⬌",title:"Justify"},image:{command:"insertImage",icon:"🖼️",title:"Insert Image"},file:{command:"uploadFile",icon:"📎",title:"Upload File"},table:{command:"insertTable",icon:"⊞",title:"Insert Table"},link:{command:"createLink",icon:"🔗",title:"Insert Link"},unlink:{command:"unlink",icon:"🔗✕",title:"Remove Link"},fontColor:{command:"fontColor",icon:"A",title:"Text Color"},backgroundColor:{command:"backgroundColor",icon:"🎨",title:"Background Color"},fontSize:{command:"fontSize",icon:"🔤",title:"Font Size"},fontFamily:{command:"fontName",icon:"Aa",title:"Font Family"},specialChar:{command:"insertSpecialChar",icon:"Ω",title:"Special Characters"},horizontalRule:{command:"insertHorizontalRule",icon:"―",title:"Horizontal Rule"},findReplace:{command:"findReplace",icon:"🔍",title:"Find & Replace"},sourceCode:{command:"sourceCode",icon:"</>",title:"Source Code"},fullscreen:{command:"fullscreen",icon:"⛶",title:"Fullscreen"},print:{command:"print",icon:"🖨️",title:"Print"},undo:{command:"undo",icon:"↶",title:"Undo"},redo:{command:"redo",icon:"↷",title:"Redo"},removeFormat:{command:"removeFormat",icon:"🧹",title:"Clear Formatting"}},tr=c.memo(({button:s,isActive:e,isDisabled:t,ariaLabel:n,buttonId:a,onButtonClick:i,onKeyDown:l})=>r.jsx("button",{id:a,className:`toolbar-button ${e?"active":""}`,title:s.title,"aria-label":n,"aria-pressed":e,disabled:t,tabIndex:t?-1:0,onClick:()=>i(s),onKeyDown:u=>l(u,s),onMouseDown:u=>{u.preventDefault()},children:r.jsx("span",{"aria-hidden":"true",children:s.icon})},a)),rr=({onCommand:s,activeFormats:e,canUndo:t,canRedo:n,toolbarConfig:a})=>{const i=c.useMemo(()=>{if(a){const m=[],x=a.enabledButtons;for(const C of a.groups)for(const L of C.buttons)if(x.has(L)){const j=er[L];j&&m.push(j)}return m}return Qt},[a]),l=c.useCallback(m=>{s(m.command,m.value)},[s]),u=c.useCallback((m,x)=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),l(x))},[l]),d=c.useCallback((m,x)=>{const C={bold:"BOLD",italic:"ITALIC",underline:"UNDERLINE",strikethrough:"STRIKETHROUGH",subscript:"SUBSCRIPT",superscript:"SUPERSCRIPT",insertUnorderedList:"INSERT_UNORDERED_LIST",insertOrderedList:"INSERT_ORDERED_LIST",justifyLeft:"JUSTIFY_LEFT",justifyCenter:"JUSTIFY_CENTER",justifyRight:"JUSTIFY_RIGHT",justifyFull:"JUSTIFY_FULL",createLink:"CREATE_LINK",editLink:"EDIT_LINK",unlink:"UNLINK"};if(m==="formatBlock"&&x){const j=`FORMAT_${x}`;return e.has(j)}const L=C[m];return L?e.has(L):!1},[e]),f=c.useCallback(m=>m==="undo"?!t:m==="redo"?!n:!1,[t,n]),p=m=>{const x=d(m.command,m.value),C=f(m.command);let L=m.title;const j={bold:"Ctrl+B",italic:"Ctrl+I",underline:"Ctrl+U",createLink:"Ctrl+K",undo:"Ctrl+Z",redo:"Ctrl+Y",removeFormat:"Ctrl+\\"};if(m.command==="formatBlock"&&m.value){const A=m.value.replace("H","");j[`${m.command}-${m.value}`]=`Ctrl+${A}`}m.command==="justifyLeft"&&(j[m.command]="Ctrl+L"),m.command==="justifyCenter"&&(j[m.command]="Ctrl+E"),m.command==="justifyRight"&&(j[m.command]="Ctrl+R"),m.command==="insertOrderedList"&&(j[m.command]="Ctrl+Shift+L");const Y=m.value?`${m.command}-${m.value}`:m.command,O=j[Y];return O&&(L+=`, keyboard shortcut ${O}`),C?L+=", disabled":x&&(L+=", currently active"),L},y=(m,x)=>`toolbar-${m.value?`${m.command}-${m.value}`:m.command}-${x}`;return r.jsx("div",{className:"toolbar",role:"toolbar","aria-label":"Text formatting toolbar",children:i.map((m,x)=>{const C=y(m,x),L=d(m.command,m.value),j=f(m.command),Y=p(m);return r.jsx(tr,{button:m,isActive:L,isDisabled:j,ariaLabel:Y,buttonId:C,onButtonClick:l,onKeyDown:u},C)})})},nr={allowedTags:["p","br","strong","em","u","h1","h2","h3","ul","ol","li","a"],allowedAttributes:{a:["href","title"],"*":["style"]}};exports.AdvancedToolbar=Ct;exports.COMMANDS=Nt;exports.CommandExecutor=et;exports.ContentSanitizer=wt;exports.DEFAULT_SANITIZATION_CONFIG=nr;exports.EditableArea=Lt;exports.ImageUploadCropModal=jt;exports.Toolbar=rr;exports.ToolbarConfigResolver=tt;exports.WYSIWYGEditor=It;exports.contentSanitizer=Tt;exports.default=It;exports.focusEditor=zt;exports.focusEditorWithSelection=Rt;exports.getActiveFormats=kt;exports.getCurrentBlockFormat=St;exports.getCurrentSelection=gt;exports.isSelectionInEditor=Et;exports.restoreSelection=bt;exports.saveSelection=$t;
//# sourceMappingURL=wysiwyg-editor.cjs.js.map
