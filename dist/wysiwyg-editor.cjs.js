"use strict";var Nt=Object.defineProperty;var It=(s,e,t)=>e in s?Nt(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var lt=(s,e,t)=>It(s,typeof e!="symbol"?e+"":e,t);Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const d=require("react"),dt=require("react-image-crop");var ut={exports:{}},Oe={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pt;function jt(){if(pt)return Oe;pt=1;var s=d,e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function a(m,u,g){var c,b={},C=null,x=null;g!==void 0&&(C=""+g),u.key!==void 0&&(C=""+u.key),u.ref!==void 0&&(x=u.ref);for(c in u)o.call(u,c)&&!i.hasOwnProperty(c)&&(b[c]=u[c]);if(m&&m.defaultProps)for(c in u=m.defaultProps,u)b[c]===void 0&&(b[c]=u[c]);return{$$typeof:e,type:m,key:C,ref:x,props:b,_owner:l.current}}return Oe.Fragment=t,Oe.jsx=a,Oe.jsxs=a,Oe}var Fe={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gt;function _t(){return gt||(gt=1,process.env.NODE_ENV!=="production"&&function(){var s=d,e=Symbol.for("react.element"),t=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),m=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),c=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),x=Symbol.for("react.offscreen"),j=Symbol.iterator,h="@@iterator";function I(n){if(n===null||typeof n!="object")return null;var f=j&&n[j]||n[h];return typeof f=="function"?f:null}var F=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function R(n){{for(var f=arguments.length,y=new Array(f>1?f-1:0),L=1;L<f;L++)y[L-1]=arguments[L];w("error",n,y)}}function w(n,f,y){{var L=F.ReactDebugCurrentFrame,U=L.getStackAddendum();U!==""&&(f+="%s",y=y.concat([U]));var $=y.map(function(O){return String(O)});$.unshift("Warning: "+f),Function.prototype.apply.call(console[n],console,$)}}var D=!1,E=!1,S=!1,Y=!1,K=!1,N;N=Symbol.for("react.module.reference");function M(n){return!!(typeof n=="string"||typeof n=="function"||n===o||n===i||K||n===l||n===g||n===c||Y||n===x||D||E||S||typeof n=="object"&&n!==null&&(n.$$typeof===C||n.$$typeof===b||n.$$typeof===a||n.$$typeof===m||n.$$typeof===u||n.$$typeof===N||n.getModuleId!==void 0))}function P(n,f,y){var L=n.displayName;if(L)return L;var U=f.displayName||f.name||"";return U!==""?y+"("+U+")":y}function q(n){return n.displayName||"Context"}function z(n){if(n==null)return null;if(typeof n.tag=="number"&&R("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case o:return"Fragment";case t:return"Portal";case i:return"Profiler";case l:return"StrictMode";case g:return"Suspense";case c:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case m:var f=n;return q(f)+".Consumer";case a:var y=n;return q(y._context)+".Provider";case u:return P(n,n.render,"ForwardRef");case b:var L=n.displayName||null;return L!==null?L:z(n.type)||"Memo";case C:{var U=n,$=U._payload,O=U._init;try{return z(O($))}catch{return null}}}return null}var X=Object.assign,se=0,ce,ie,Ce,De,pe,Ue,Se;function Me(){}Me.__reactDisabledLog=!0;function Pe(){{if(se===0){ce=console.log,ie=console.info,Ce=console.warn,De=console.error,pe=console.group,Ue=console.groupCollapsed,Se=console.groupEnd;var n={configurable:!0,enumerable:!0,value:Me,writable:!0};Object.defineProperties(console,{info:n,log:n,warn:n,error:n,group:n,groupCollapsed:n,groupEnd:n})}se++}}function Le(){{if(se--,se===0){var n={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:X({},n,{value:ce}),info:X({},n,{value:ie}),warn:X({},n,{value:Ce}),error:X({},n,{value:De}),group:X({},n,{value:pe}),groupCollapsed:X({},n,{value:Ue}),groupEnd:X({},n,{value:Se})})}se<0&&R("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var Te=F.ReactCurrentDispatcher,ge;function he(n,f,y){{if(ge===void 0)try{throw Error()}catch(U){var L=U.stack.trim().match(/\n( *(at )?)/);ge=L&&L[1]||""}return`
`+ge+n}}var we=!1,ue;{var ee=typeof WeakMap=="function"?WeakMap:Map;ue=new ee}function He(n,f){if(!n||we)return"";{var y=ue.get(n);if(y!==void 0)return y}var L;we=!0;var U=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var $;$=Te.current,Te.current=null,Pe();try{if(f){var O=function(){throw Error()};if(Object.defineProperty(O.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(O,[])}catch(ae){L=ae}Reflect.construct(n,[],O)}else{try{O.call()}catch(ae){L=ae}n.call(O.prototype)}}else{try{throw Error()}catch(ae){L=ae}n()}}catch(ae){if(ae&&L&&typeof ae.stack=="string"){for(var _=ae.stack.split(`
`),oe=L.stack.split(`
`),G=_.length-1,V=oe.length-1;G>=1&&V>=0&&_[G]!==oe[V];)V--;for(;G>=1&&V>=0;G--,V--)if(_[G]!==oe[V]){if(G!==1||V!==1)do if(G--,V--,V<0||_[G]!==oe[V]){var le=`
`+_[G].replace(" at new "," at ");return n.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",n.displayName)),typeof n=="function"&&ue.set(n,le),le}while(G>=1&&V>=0);break}}}finally{we=!1,Te.current=$,Le(),Error.prepareStackTrace=U}var Ee=n?n.displayName||n.name:"",ye=Ee?he(Ee):"";return typeof n=="function"&&ue.set(n,ye),ye}function T(n,f,y){return He(n,!1)}function be(n){var f=n.prototype;return!!(f&&f.isReactComponent)}function W(n,f,y){if(n==null)return"";if(typeof n=="function")return He(n,be(n));if(typeof n=="string")return he(n);switch(n){case g:return he("Suspense");case c:return he("SuspenseList")}if(typeof n=="object")switch(n.$$typeof){case u:return T(n.render);case b:return W(n.type,f,y);case C:{var L=n,U=L._payload,$=L._init;try{return W($(U),f,y)}catch{}}}return""}var H=Object.prototype.hasOwnProperty,Ne={},Be=F.ReactDebugCurrentFrame;function ke(n){if(n){var f=n._owner,y=W(n.type,n._source,f?f.type:null);Be.setExtraStackFrame(y)}else Be.setExtraStackFrame(null)}function Ie(n,f,y,L,U){{var $=Function.call.bind(H);for(var O in n)if($(n,O)){var _=void 0;try{if(typeof n[O]!="function"){var oe=Error((L||"React class")+": "+y+" type `"+O+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof n[O]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw oe.name="Invariant Violation",oe}_=n[O](f,O,L,y,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(G){_=G}_&&!(_ instanceof Error)&&(ke(U),R("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",L||"React class",y,O,typeof _),ke(null)),_ instanceof Error&&!(_.message in Ne)&&(Ne[_.message]=!0,ke(U),R("Failed %s type: %s",y,_.message),ke(null))}}}var $e=Array.isArray;function je(n){return $e(n)}function Xe(n){{var f=typeof Symbol=="function"&&Symbol.toStringTag,y=f&&n[Symbol.toStringTag]||n.constructor.name||"Object";return y}}function Ze(n){try{return ze(n),!1}catch{return!0}}function ze(n){return""+n}function We(n){if(Ze(n))return R("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",Xe(n)),ze(n)}var Ke=F.ReactCurrentOwner,Qe={key:!0,ref:!0,__self:!0,__source:!0},qe,Ye;function et(n){if(H.call(n,"ref")){var f=Object.getOwnPropertyDescriptor(n,"ref").get;if(f&&f.isReactWarning)return!1}return n.ref!==void 0}function Re(n){if(H.call(n,"key")){var f=Object.getOwnPropertyDescriptor(n,"key").get;if(f&&f.isReactWarning)return!1}return n.key!==void 0}function tt(n,f){typeof n.ref=="string"&&Ke.current}function rt(n,f){{var y=function(){qe||(qe=!0,R("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",f))};y.isReactWarning=!0,Object.defineProperty(n,"key",{get:y,configurable:!0})}}function nt(n,f){{var y=function(){Ye||(Ye=!0,R("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",f))};y.isReactWarning=!0,Object.defineProperty(n,"ref",{get:y,configurable:!0})}}var ot=function(n,f,y,L,U,$,O){var _={$$typeof:e,type:n,key:f,ref:y,props:O,_owner:$};return _._store={},Object.defineProperty(_._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(_,"_self",{configurable:!1,enumerable:!1,writable:!1,value:L}),Object.defineProperty(_,"_source",{configurable:!1,enumerable:!1,writable:!1,value:U}),Object.freeze&&(Object.freeze(_.props),Object.freeze(_)),_};function st(n,f,y,L,U){{var $,O={},_=null,oe=null;y!==void 0&&(We(y),_=""+y),Re(f)&&(We(f.key),_=""+f.key),et(f)&&(oe=f.ref,tt(f,U));for($ in f)H.call(f,$)&&!Qe.hasOwnProperty($)&&(O[$]=f[$]);if(n&&n.defaultProps){var G=n.defaultProps;for($ in G)O[$]===void 0&&(O[$]=G[$])}if(_||oe){var V=typeof n=="function"?n.displayName||n.name||"Unknown":n;_&&rt(O,V),oe&&nt(O,V)}return ot(n,_,oe,U,L,Ke.current,O)}}var xe=F.ReactCurrentOwner,Ge=F.ReactDebugCurrentFrame;function me(n){if(n){var f=n._owner,y=W(n.type,n._source,f?f.type:null);Ge.setExtraStackFrame(y)}else Ge.setExtraStackFrame(null)}var _e;_e=!1;function Ae(n){return typeof n=="object"&&n!==null&&n.$$typeof===e}function Je(){{if(xe.current){var n=z(xe.current.type);if(n)return`

Check the render method of \``+n+"`."}return""}}function at(n){return""}var p={};function k(n){{var f=Je();if(!f){var y=typeof n=="string"?n:n.displayName||n.name;y&&(f=`

Check the top-level render call using <`+y+">.")}return f}}function v(n,f){{if(!n._store||n._store.validated||n.key!=null)return;n._store.validated=!0;var y=k(f);if(p[y])return;p[y]=!0;var L="";n&&n._owner&&n._owner!==xe.current&&(L=" It was passed a child from "+z(n._owner.type)+"."),me(n),R('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',y,L),me(null)}}function A(n,f){{if(typeof n!="object")return;if(je(n))for(var y=0;y<n.length;y++){var L=n[y];Ae(L)&&v(L,f)}else if(Ae(n))n._store&&(n._store.validated=!0);else if(n){var U=I(n);if(typeof U=="function"&&U!==n.entries)for(var $=U.call(n),O;!(O=$.next()).done;)Ae(O.value)&&v(O.value,f)}}}function B(n){{var f=n.type;if(f==null||typeof f=="string")return;var y;if(typeof f=="function")y=f.propTypes;else if(typeof f=="object"&&(f.$$typeof===u||f.$$typeof===b))y=f.propTypes;else return;if(y){var L=z(f);Ie(y,n.props,"prop",L,n)}else if(f.PropTypes!==void 0&&!_e){_e=!0;var U=z(f);R("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",U||"Unknown")}typeof f.getDefaultProps=="function"&&!f.getDefaultProps.isReactClassApproved&&R("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function te(n){{for(var f=Object.keys(n.props),y=0;y<f.length;y++){var L=f[y];if(L!=="children"&&L!=="key"){me(n),R("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",L),me(null);break}}n.ref!==null&&(me(n),R("Invalid attribute `ref` supplied to `React.Fragment`."),me(null))}}var re={};function J(n,f,y,L,U,$){{var O=M(n);if(!O){var _="";(n===void 0||typeof n=="object"&&n!==null&&Object.keys(n).length===0)&&(_+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var oe=at();oe?_+=oe:_+=Je();var G;n===null?G="null":je(n)?G="array":n!==void 0&&n.$$typeof===e?(G="<"+(z(n.type)||"Unknown")+" />",_=" Did you accidentally export a JSX literal instead of a component?"):G=typeof n,R("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",G,_)}var V=st(n,f,y,U,$);if(V==null)return V;if(O){var le=f.children;if(le!==void 0)if(L)if(je(le)){for(var Ee=0;Ee<le.length;Ee++)A(le[Ee],n);Object.freeze&&Object.freeze(le)}else R("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else A(le,n)}if(H.call(f,"key")){var ye=z(n),ae=Object.keys(f).filter(function(wt){return wt!=="key"}),it=ae.length>0?"{key: someKey, "+ae.join(": ..., ")+": ...}":"{key: someKey}";if(!re[ye+it]){var Tt=ae.length>0?"{"+ae.join(": ..., ")+": ...}":"{}";R(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,it,ye,Tt,ye),re[ye+it]=!0}}return n===o?te(V):B(V),V}}function Z(n,f,y){return J(n,f,y,!0)}function ne(n,f,y){return J(n,f,y,!1)}var de=ne,Q=Z;Fe.Fragment=o,Fe.jsx=de,Fe.jsxs=Q}()),Fe}process.env.NODE_ENV==="production"?ut.exports=jt():ut.exports=_t();var r=ut.exports;const At=[{name:"clipboard",buttons:[{command:"undo",icon:"↶",title:"Undo"},{command:"redo",icon:"↷",title:"Redo"},{type:"separator",command:"",icon:"",title:""}]},{name:"editing",buttons:[{command:"findReplace",icon:"🔍",title:"Find & Replace"},{type:"separator",command:"",icon:"",title:""}]},{name:"basicstyles",buttons:[{command:"bold",icon:"B",title:"Bold"},{command:"italic",icon:"I",title:"Italic"},{command:"underline",icon:"U",title:"Underline"},{command:"strikethrough",icon:"S̶",title:"Strikethrough"},{command:"subscript",icon:"X₂",title:"Subscript"},{command:"superscript",icon:"X²",title:"Superscript"},{command:"removeFormat",icon:"🧹",title:"Clear Formatting"},{type:"separator",command:"",icon:"",title:""}]},{name:"paragraph",buttons:[{command:"formatBlock",value:"H1",icon:"H1",title:"Heading 1"},{command:"formatBlock",value:"H2",icon:"H2",title:"Heading 2"},{command:"formatBlock",value:"H3",icon:"H3",title:"Heading 3"},{command:"formatBlock",icon:"¶",title:"Format",type:"dropdown",options:[{value:"P",label:"Normal",icon:"¶"},{value:"H1",label:"Heading 1",icon:"H1"},{value:"H2",label:"Heading 2",icon:"H2"},{value:"H3",label:"Heading 3",icon:"H3"},{value:"H4",label:"Heading 4",icon:"H4"},{value:"H5",label:"Heading 5",icon:"H5"},{value:"H6",label:"Heading 6",icon:"H6"},{value:"BLOCKQUOTE",label:"Quote",icon:'"'},{value:"PRE",label:"Code Block",icon:"</>"}]},{command:"fontSize",icon:"🔤",title:"Font Size",type:"dropdown",options:[{value:"1",label:"8pt"},{value:"2",label:"10pt"},{value:"3",label:"12pt"},{value:"4",label:"14pt"},{value:"5",label:"18pt"},{value:"6",label:"24pt"},{value:"7",label:"36pt"}]},{command:"fontName",icon:"Aa",title:"Font Family",type:"dropdown",options:[{value:"Arial",label:"Arial"},{value:"Georgia",label:"Georgia"},{value:"Times New Roman",label:"Times New Roman"},{value:"Courier New",label:"Courier New"},{value:"Verdana",label:"Verdana"},{value:"Helvetica",label:"Helvetica"}]},{type:"separator",command:"",icon:"",title:""}]},{name:"colors",buttons:[{command:"fontColor",icon:"A",title:"Text Color",type:"color"},{command:"backgroundColor",icon:"🎨",title:"Background Color",type:"color"},{type:"separator",command:"",icon:"",title:""}]},{name:"list",buttons:[{command:"insertUnorderedList",icon:"•",title:"Bullet List"},{command:"insertOrderedList",icon:"1.",title:"Numbered List"},{command:"outdent",icon:"⇤",title:"Decrease Indent"},{command:"indent",icon:"⇥",title:"Increase Indent"},{type:"separator",command:"",icon:"",title:""}]},{name:"align",buttons:[{command:"justifyLeft",icon:"⬅",title:"Align Left"},{command:"justifyCenter",icon:"⬌",title:"Align Center"},{command:"justifyRight",icon:"➡",title:"Align Right"},{command:"justifyFull",icon:"⬌",title:"Justify"},{type:"separator",command:"",icon:"",title:""}]},{name:"links",buttons:[{command:"createLink",icon:"🔗",title:"Insert Link"},{command:"unlink",icon:"🔗✕",title:"Remove Link"},{type:"separator",command:"",icon:"",title:""}]},{name:"insert",buttons:[{command:"insertImage",icon:"🖼️",title:"Insert Image"},{command:"insertTable",icon:"⊞",title:"Insert Table"},{command:"insertHorizontalRule",icon:"―",title:"Horizontal Rule"},{command:"insertSpecialChar",icon:"Ω",title:"Special Characters"},{command:"uploadFile",icon:"📎",title:"Upload File"},{type:"separator",command:"",icon:"",title:""}]},{name:"tools",buttons:[{command:"sourceCode",icon:"</>",title:"Source Code"},{command:"fullscreen",icon:"⛶",title:"Fullscreen"},{command:"print",icon:"🖨️",title:"Print"},{command:"spellCheck",icon:"✓",title:"Spell Check"}]}],Ot=["#ffffff","#e6e6e6","#999999","#4d4d4d","#1a1a1a","#000000","#ffebee","#ef9a9a","#ef5350","#f44336","#d32f2f","#b71c1c","#e3f2fd","#90caf9","#42a5f5","#2196f3","#1976d2","#0d47a1","#e8f5e9","#a5d6a7","#66bb6a","#4caf50","#388e3c","#1b5e20","#fff3e0","#ffcc80","#ffa726","#ff9800","#f57c00","#e65100","#fafafa","#eeeeee","#bdbdbd","#9e9e9e","#616161","#212121"],bt=({onCommand:s,activeFormats:e,canUndo:t,canRedo:o})=>{const[l,i]=d.useState(null),[a,m]=d.useState(null),u=d.useRef({});d.useEffect(()=>{const h=I=>{const F=I.target;!F.closest(".toolbar-dropdown")&&!F.closest(".toolbar-color-picker")&&!F.closest(".toolbar-button")&&(i(null),m(null))};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]);const g=h=>{h.type==="dropdown"?(i(l===h.command?null:h.command),m(null)):h.type==="color"?(m(a===h.command?null:h.command),i(null)):(s(h.command,h.value),i(null),m(null))},c=(h,I)=>{s(h,I),i(null)},b=(h,I)=>{s(h,I),m(null)},C=(h,I)=>{const F={bold:"BOLD",italic:"ITALIC",underline:"UNDERLINE",strikethrough:"STRIKETHROUGH",subscript:"SUBSCRIPT",superscript:"SUPERSCRIPT",insertUnorderedList:"INSERT_UNORDERED_LIST",insertOrderedList:"INSERT_ORDERED_LIST",justifyLeft:"JUSTIFY_LEFT",justifyCenter:"JUSTIFY_CENTER",justifyRight:"JUSTIFY_RIGHT",justifyFull:"JUSTIFY_FULL",createLink:"CREATE_LINK"};if(h==="formatBlock"&&I){const w=`FORMAT_${I}`;return e.has(w)}const R=F[h];return R?e.has(R):!1},x=h=>h==="undo"?!t:h==="redo"?!o:!1,j=(h,I,F)=>{var E;if(h.type==="separator")return r.jsx("div",{className:"toolbar-separator"},`${I}-sep-${F}`);const R=C(h.command,h.value),w=x(h.command),D=`${I}-${h.command}-${F}`;return r.jsxs("div",{className:"relative",children:[r.jsxs("button",{className:`toolbar-button ${R?"active":""} ${h.type==="dropdown"||h.type==="color"?"dropdown":""}`,title:h.title,"aria-label":h.title,disabled:w,onClick:()=>g(h),onMouseDown:S=>S.preventDefault(),children:[r.jsx("span",{className:"button-icon","aria-hidden":"true",children:h.icon}),(h.type==="dropdown"||h.type==="color")&&r.jsx("span",{className:"dropdown-arrow",children:"▼"})]}),h.type==="dropdown"&&l===h.command&&r.jsx("div",{ref:S=>u.current[h.command]=S,className:"toolbar-dropdown",children:(E=h.options)==null?void 0:E.map(S=>r.jsxs("button",{className:"dropdown-item",onClick:()=>c(h.command,S.value),children:[S.icon&&r.jsx("span",{className:"option-icon",children:S.icon}),r.jsx("span",{className:"option-label",children:S.label})]},S.value))}),h.type==="color"&&a===h.command&&r.jsxs("div",{ref:S=>u.current[h.command]=S,className:"toolbar-color-picker",children:[r.jsxs("div",{className:"color-picker-header",children:[r.jsx("h4",{className:"color-picker-title",children:h.command==="fontColor"?"Text Color":"Background Color"}),r.jsx("button",{className:"color-picker-close",onClick:()=>m(null),"aria-label":"Close color picker",children:"×"})]}),r.jsx("div",{className:"color-grid",children:Ot.map(S=>r.jsx("button",{className:"color-swatch",style:{backgroundColor:S},onClick:()=>b(h.command,S),title:S,"aria-label":`Select color ${S}`},S))}),r.jsxs("div",{className:"color-input-section",children:[r.jsx("input",{type:"color",className:"color-input",onChange:S=>b(h.command,S.target.value),title:"Choose custom color"}),r.jsx("span",{className:"color-input-label",children:"Custom Color"}),r.jsx("button",{className:"color-remove-btn",onClick:()=>b(h.command,h.command==="fontColor"?"inherit":"transparent"),title:"Remove color",children:"Remove"})]})]})]},D)};return r.jsx("div",{className:"advanced-toolbar toolbar",role:"toolbar","aria-label":"Rich text formatting toolbar",children:At.map(h=>r.jsx("div",{className:"toolbar-group",children:h.buttons.map((I,F)=>j(I,h.name,F))},h.name))})},mt=()=>{const s=window.getSelection();if(!s||s.rangeCount===0)return{range:null,isCollapsed:!0,activeFormats:new Set,currentBlockFormat:"div"};const e=s.getRangeAt(0),t=xt(),o=yt();return{range:e.cloneRange(),isCollapsed:s.isCollapsed,activeFormats:t,currentBlockFormat:o}},ft=s=>{if(!s.range)return;const e=window.getSelection();if(e)try{e.removeAllRanges(),e.addRange(s.range)}catch(t){console.warn("Failed to restore selection:",t)}},Ft=()=>{const s=mt();return()=>{ft(s)}},xt=()=>{const s=new Set;try{document.queryCommandState("bold")&&s.add("bold"),document.queryCommandState("italic")&&s.add("italic"),document.queryCommandState("underline")&&s.add("underline"),document.queryCommandState("insertUnorderedList")&&s.add("insertUnorderedList"),document.queryCommandState("insertOrderedList")&&s.add("insertOrderedList"),document.queryCommandState("justifyLeft")&&s.add("justifyLeft"),document.queryCommandState("justifyCenter")&&s.add("justifyCenter"),document.queryCommandState("justifyRight")&&s.add("justifyRight")}catch(e){console.warn("Error checking command state:",e)}return s},yt=()=>{var e;try{const t=document.queryCommandValue("formatBlock");if(t)return t.toLowerCase()}catch(t){console.warn("Error getting block format:",t)}const s=window.getSelection();if(s&&s.rangeCount>0){let o=s.getRangeAt(0).commonAncestorContainer;o.nodeType===Node.TEXT_NODE&&(o=o.parentElement||o);const l=(e=o.tagName)==null?void 0:e.toLowerCase();if(["h1","h2","h3","h4","h5","h6","p","div"].includes(l))return l}return"div"},vt=s=>{const e=window.getSelection();if(!e||e.rangeCount===0)return!1;const t=e.getRangeAt(0);return s.contains(t.commonAncestorContainer)},Dt=s=>{s.focus();const e=window.getSelection();if(e){const t=document.createRange();t.selectNodeContents(s),t.collapse(!1),e.removeAllRanges(),e.addRange(t)}},Ct=(s,e)=>{s.focus(),e&&ft(e)},Ut={allowedTags:["p","br","strong","em","u","b","i","h1","h2","h3","h4","h5","h6","ul","ol","li","a","span","div"],allowedAttributes:{a:["href","title"],span:["style"],div:["style"],p:["style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"]},allowedProtocols:["http:","https:","mailto:"]};class kt{constructor(e=Ut){lt(this,"config");this.config=e}sanitizeHtml(e){if(!e||typeof e!="string")return"";const t=document.createElement("div");return t.innerHTML=e,this.sanitizeElement(t),t.innerHTML}sanitizePastedContent(e){let t=this.cleanPasteArtifacts(e),o=this.sanitizeHtml(t);return o=this.normalizeWhitespace(o),o}sanitizeElement(e){var o;const t=Array.from(e.children);for(const l of t){const i=l.tagName.toLowerCase();if(!this.config.allowedTags.includes(i)){if(this.isDangerousTag(i)){l.remove();continue}const a=l.textContent||"";if(a.trim()){const m=document.createTextNode(a);(o=l.parentNode)==null||o.replaceChild(m,l)}else l.remove();continue}this.sanitizeAttributes(l),this.sanitizeElement(l)}}isDangerousTag(e){return["script","iframe","object","embed","form","input","button","textarea","select","option","style","link","meta","base","applet","frame","frameset"].includes(e)}sanitizeAttributes(e){const t=e.tagName.toLowerCase(),o=this.config.allowedAttributes[t]||[],l=Array.from(e.attributes);for(const i of l){const a=i.name.toLowerCase();if(!o.includes(a)){e.removeAttribute(i.name);continue}if(a==="href"){const m=this.sanitizeUrl(i.value);m?e.setAttribute("href",m):e.removeAttribute("href");continue}if(a==="style"){const m=this.sanitizeStyle(i.value);m?e.setAttribute("style",m):e.removeAttribute("style");continue}this.containsScript(i.value)&&e.removeAttribute(i.name)}}sanitizeUrl(e){if(!e||typeof e!="string")return null;const t=e.trim();if(/^(javascript|data|vbscript|file|ftp):/i.test(t))return null;if(t.startsWith("/")||t.startsWith("./")||t.startsWith("../")||t.startsWith("#"))return t;try{const o=new URL(t);if(this.config.allowedProtocols.includes(o.protocol))return t}catch{try{const l=`http://${t}`,i=new URL(l);if(this.config.allowedProtocols.includes(i.protocol))return l}catch{return null}}return null}sanitizeStyle(e){if(!e||typeof e!="string")return null;const t=[/expression\s*\(/i,/javascript\s*:/i,/vbscript\s*:/i,/data\s*:/i,/import\s*['"]/i,/@import/i,/binding\s*:/i,/behavior\s*:/i,/position\s*:\s*fixed/i,/position\s*:\s*absolute/i];for(const a of t)if(a.test(e))return null;const o=["color","background-color","font-size","font-weight","font-style","text-decoration","text-align","margin","padding","border","font-family"],l=e.split(";").filter(a=>a.trim()),i=[];for(const a of l){const[m,u]=a.split(":").map(g=>g.trim());m&&u&&o.includes(m.toLowerCase())&&(this.containsScript(u)||i.push(`${m}: ${u}`))}return i.length>0?i.join("; "):null}containsScript(e){return!e||typeof e!="string"?!1:[/javascript\s*:/i,/vbscript\s*:/i,/data\s*:/i,/on\w+\s*=/i,/<script/i,/<\/script/i,/expression\s*\(/i,/eval\s*\(/i,/setTimeout\s*\(/i,/setInterval\s*\(/i].some(o=>o.test(e))}cleanPasteArtifacts(e){let t=e;return t=t.replace(/<o:p\s*\/?>/gi,""),t=t.replace(/<\/o:p>/gi,""),t=t.replace(/\s*mso-[^:]+:[^;"]+;?/gi,""),t=t.replace(/\s*class="?Mso[^"]*"?/gi,""),t=t.replace(/<p[^>]*>\s*<\/p>/gi,""),t=t.replace(/<div[^>]*>\s*<\/div>/gi,""),t=t.replace(/<font[^>]*>/gi,"<span>"),t=t.replace(/<\/font>/gi,"</span>"),t=t.replace(/<!--[\s\S]*?-->/g,""),t=t.replace(/\s+/g," "),t=t.replace(/>\s+</g,"><"),t.trim()}normalizeWhitespace(e){let t=e;return t=t.replace(/(<br\s*\/?>){2,}/gi,"</p><p>"),t&&!t.match(/^<(p|h[1-6]|ul|ol|div)/i)&&(t=`<p>${t}</p>`),t=t.replace(/<p>\s*<\/p>/gi,""),t}extractPlainText(e){if(!e||typeof e!="string")return"";const t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}isContentSafe(e){return!e||typeof e!="string"?!0:![/<script/i,/javascript\s*:/i,/vbscript\s*:/i,/on\w+\s*=/i,/<iframe/i,/<object/i,/<embed/i,/<form/i,/<input/i,/<button/i].some(o=>o.test(e))}}const Rt=new kt,Et=({content:s,placeholder:e,onContentChange:t,onFocus:o,onBlur:l,editorRef:i,onSelectionChange:a,onLinkClick:m})=>{const[u,g]=d.useState(!1),[c,b]=d.useState(null),C=d.useCallback(()=>{if(i.current&&vt(i.current)){const N=mt();b(N),a&&a(N)}},[i,a]),x=d.useCallback(()=>{i.current&&c&&Ct(i.current,c)},[i,c]),j=N=>{const P=N.currentTarget.innerHTML,q=h(P);t(q)},h=N=>{if(!N||N==="<br>"||N==="<div><br></div>")return"";let M=N.replace(/^<div><br><\/div>$/,"");return M=M.replace(/^<div>(.*)<\/div>$/,"$1"),M},I=N=>{g(!0),o()},F=N=>{g(!1),l()},R=N=>{N.preventDefault();const M=N.clipboardData;if(!M)return;let P=M.getData("text/html");if(!P){const z=M.getData("text/plain");z&&(P=`<p>${z.replace(/\n/g,"<br>")}</p>`)}if(!P)return;const q=Rt.sanitizePastedContent(P);w(q)},w=N=>{const M=window.getSelection();if(!M||!M.rangeCount)return;const P=M.getRangeAt(0);P.deleteContents();const q=document.createElement("div");q.innerHTML=N;const z=document.createDocumentFragment();for(;q.firstChild;)z.appendChild(q.firstChild);if(P.insertNode(z),P.collapse(!1),M.removeAllRanges(),M.addRange(P),i.current){const X=i.current.innerHTML;t(h(X))}},D=N=>{const P=N.target.closest("a[href]");if(P&&P.href){N.preventDefault(),N.stopPropagation(),m&&m(N.nativeEvent,P);return}},E=N=>{N.key==="Enter"&&!N.shiftKey&&S(N)},S=N=>{var ce,ie;const M=window.getSelection();if(!M||!M.rangeCount)return!1;const P=M.getRangeAt(0),q=P.startContainer.nodeType===Node.TEXT_NODE?P.startContainer.parentElement:P.startContainer,z=q==null?void 0:q.closest("li");if(!z)return!1;const X=z.closest("ul, ol");return X&&(((ce=z.textContent)==null?void 0:ce.trim())===""||P.startOffset===0&&((ie=z.textContent)==null?void 0:ie.trim())==="")?(N.preventDefault(),Y(z,X),!0):!1},Y=(N,M)=>{var z,X;N.remove();const P=document.createElement("p");P.innerHTML="<br>",M.nextSibling?(z=M.parentNode)==null||z.insertBefore(P,M.nextSibling):(X=M.parentNode)==null||X.appendChild(P);const q=window.getSelection();if(q){const se=document.createRange();se.setStart(P,0),se.collapse(!0),q.removeAllRanges(),q.addRange(se)}if(i.current){const se=i.current.innerHTML;t(h(se))}},K=()=>u?!1:!s||s===""||s==="<br>"||s==="<div><br></div>"||s.replace(/<[^>]*>/g,"").trim()==="";return d.useEffect(()=>{i.current&&i.current.innerHTML!==s&&(i.current.innerHTML=s||"")},[s,i]),d.useEffect(()=>(document.addEventListener("selectionchange",C),()=>{document.removeEventListener("selectionchange",C)}),[C]),d.useEffect(()=>{i.current&&(i.current.restoreFocus=x)},[i,x]),r.jsxs("div",{className:"editable-area-container",children:[r.jsx("div",{ref:i,className:"editable-area",contentEditable:!0,onInput:j,onFocus:I,onBlur:F,onKeyDown:E,onPaste:R,onClick:D,suppressContentEditableWarning:!0,role:"textbox","aria-label":"Rich text editor content area","aria-multiline":"true","aria-describedby":"keyboard-shortcuts-help","data-placeholder":e}),K()&&r.jsx("div",{className:"placeholder","aria-hidden":"true",children:e})]})};function ht(s,e,t){return dt.centerCrop(dt.makeAspectCrop({unit:"%",width:90},t,s,e),s,e)}const Mt=({isOpen:s,imageUrl:e,onClose:t,onCropComplete:o})=>{const[l,i]=d.useState(),[a,m]=d.useState(),[u,g]=d.useState(void 0),[c,b]=d.useState(!1),C=d.useRef(null),x=d.useRef(null),j=d.useCallback(R=>{const{width:w,height:D}=R.currentTarget;i(ht(w,D,u||w/D))},[u]),h=d.useCallback(async()=>{if(!a||!C.current||!x.current)return null;const R=C.current,w=x.current,D=w.getContext("2d");if(!D)return null;const E=R.naturalWidth/R.width,S=R.naturalHeight/R.height;return w.width=a.width,w.height=a.height,D.drawImage(R,a.x*E,a.y*S,a.width*E,a.height*S,0,0,a.width,a.height),new Promise(Y=>{w.toBlob(K=>{if(K){const N=URL.createObjectURL(K);Y(N)}},"image/jpeg",.9)})},[a]),I=async()=>{b(!0);try{const R=await h();R&&(o(R),t())}catch(R){console.error("Error cropping image:",R)}finally{b(!1)}},F=R=>{if(g(R),C.current){const{width:w,height:D}=C.current;i(ht(w,D,R||w/D))}};return s?r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl max-h-[90vh] w-full mx-4 overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Crop Image"}),r.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Aspect Ratio:"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>F(void 0),className:`px-3 py-1 text-sm rounded ${u===void 0?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"} transition-colors`,children:"Free"}),r.jsx("button",{onClick:()=>F(1),className:`px-3 py-1 text-sm rounded ${u===1?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"} transition-colors`,children:"1:1"}),r.jsx("button",{onClick:()=>F(16/9),className:`px-3 py-1 text-sm rounded ${u===16/9?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"} transition-colors`,children:"16:9"}),r.jsx("button",{onClick:()=>F(4/3),className:`px-3 py-1 text-sm rounded ${u===4/3?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"} transition-colors`,children:"4:3"})]})]})}),r.jsx("div",{className:"p-4 max-h-96 overflow-auto",children:r.jsx("div",{className:"flex justify-center",children:r.jsx(dt,{crop:l,onChange:(R,w)=>i(w),onComplete:R=>m(R),aspect:u,minWidth:50,minHeight:50,children:r.jsx("img",{ref:C,alt:"Crop preview",src:e,style:{maxHeight:"400px",maxWidth:"100%"},onLoad:j})})})}),r.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-gray-200 bg-gray-50",children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Drag to select the area you want to crop"}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),r.jsx("button",{onClick:I,disabled:!a||c,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:c?"Processing...":"Apply Crop"})]})]}),r.jsx("canvas",{ref:x,style:{display:"none"}})]})}):null},Pt=({isOpen:s,onClose:e,onFileSelect:t,accept:o="*/*",maxSize:l=10*1024*1024,title:i="Upload File",description:a="Select a file to upload"})=>{const[m,u]=d.useState(!1),[g,c]=d.useState(null),b=d.useRef(null),C=d.useCallback(E=>E.size>l?`File size exceeds ${Math.round(l/1048576)}MB limit`:o!=="*/*"&&!o.split(",").map(K=>K.trim()).some(K=>{if(K.startsWith("."))return E.name.toLowerCase().endsWith(K.toLowerCase());if(K.includes("/*")){const N=K.split("/")[0];return E.type.startsWith(N+"/")}else return E.type===K})?`File type not supported. Accepted types: ${o}`:null,[o,l]),x=d.useCallback(E=>{const S=C(E);if(S){c(S);return}c(null),t(E),e()},[C,t,e]),j=d.useCallback(E=>{var Y;const S=(Y=E.target.files)==null?void 0:Y[0];S&&x(S)},[x]),h=d.useCallback(E=>{E.preventDefault(),u(!0)},[]),I=d.useCallback(E=>{E.preventDefault(),u(!1)},[]),F=d.useCallback(E=>{E.preventDefault(),u(!1);const S=Array.from(E.dataTransfer.files);S.length>0&&x(S[0])},[x]),R=d.useCallback(()=>{var E;(E=b.current)==null||E.click()},[]),w=d.useCallback(E=>{if(E===0)return"0 Bytes";const S=1024,Y=["Bytes","KB","MB","GB"],K=Math.floor(Math.log(E)/Math.log(S));return parseFloat((E/Math.pow(S,K)).toFixed(2))+" "+Y[K]},[]),D=d.useCallback(()=>o==="*/*"?"All files":o.includes("image/*")?"Images":o.includes("video/*")?"Videos":o.includes("audio/*")?"Audio files":o.replace(/,/g,", "),[o]);return s?r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:i}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs("div",{className:"p-6",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:a}),r.jsx("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${m?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:h,onDragLeave:I,onDrop:F,children:r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("svg",{className:`w-12 h-12 mb-4 ${m?"text-blue-500":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),r.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Drag and drop your file here, or"}),r.jsx("button",{onClick:R,className:"px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition-colors",children:"Browse Files"})]})}),r.jsxs("div",{className:"mt-4 text-xs text-gray-500 space-y-1",children:[r.jsxs("p",{children:["Accepted types: ",D()]}),r.jsxs("p",{children:["Maximum size: ",w(l)]})]}),g&&r.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-md",children:r.jsxs("div",{className:"flex",children:[r.jsx("svg",{className:"w-5 h-5 text-red-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("p",{className:"text-sm text-red-700",children:g})]})})]}),r.jsx("div",{className:"flex justify-end p-4 border-t border-gray-200 bg-gray-50",children:r.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"})}),r.jsx("input",{ref:b,type:"file",accept:o,onChange:j,className:"hidden"})]})}):null},Ht=({imageElement:s,onUpdate:e,onRemove:t})=>{const[o,l]=d.useState(!1),[i,a]=d.useState({x:0,y:0}),[m,u]=d.useState({width:0,height:0}),[g,c]=d.useState("none"),[b,C]=d.useState(!1),x=d.useRef(null);d.useEffect(()=>{var w;if(s){const D=s.getBoundingClientRect(),E=(w=s.closest(".editable-area"))==null?void 0:w.getBoundingClientRect();E&&a({x:D.left-E.left,y:D.top-E.top}),u({width:s.offsetWidth,height:s.offsetHeight});const S=window.getComputedStyle(s),Y=S.display,K=S.marginLeft,N=S.marginRight;c(Y==="block"?K==="auto"&&N==="auto"?"center":K==="auto"?"right":"left":"none")}},[s]);const j=d.useCallback(w=>{if(s){switch(c(w),w){case"left":s.style.display="block",s.style.marginLeft="0",s.style.marginRight="auto",s.style.float="none";break;case"center":s.style.display="block",s.style.marginLeft="auto",s.style.marginRight="auto",s.style.float="none";break;case"right":s.style.display="block",s.style.marginLeft="auto",s.style.marginRight="0",s.style.float="none";break;case"none":s.style.display="inline-block",s.style.marginLeft="",s.style.marginRight="",s.style.float="";break}e()}},[s,e]),h=d.useCallback(w=>{if(!s)return;const D=s.naturalHeight/s.naturalWidth,E=w*D;s.style.width=`${w}px`,s.style.height=`${E}px`,u({width:w,height:E}),e()},[s,e]),I=d.useCallback(w=>{if(s){switch(w){case"left":s.style.float="left",s.style.marginRight="15px",s.style.marginBottom="10px",s.style.display="block";break;case"right":s.style.float="right",s.style.marginLeft="15px",s.style.marginBottom="10px",s.style.display="block";break;case"none":s.style.float="none",s.style.marginLeft="",s.style.marginRight="",s.style.marginBottom="";break}e()}},[s,e]),F=d.useCallback(()=>{if(!s)return;const w=s.alt||"",D=window.prompt("Enter alt text for the image (for accessibility):",w);D!==null&&(s.alt=D,e())},[s,e]),R=d.useCallback(()=>{confirm("Are you sure you want to remove this image?")&&(t(),l(!1))},[t]);return d.useEffect(()=>{const w=E=>{E.stopPropagation(),l(!0)},D=E=>{x.current&&!x.current.contains(E.target)&&l(!1)};return s&&(s.addEventListener("click",w),document.addEventListener("click",D)),()=>{s&&s.removeEventListener("click",w),document.removeEventListener("click",D)}},[s]),!o||!s?null:r.jsxs("div",{ref:x,className:"absolute z-50 bg-white border border-gray-300 rounded-lg shadow-lg p-3 min-w-64",style:{left:i.x+m.width+10,top:i.y,maxWidth:"300px"},children:[r.jsxs("div",{className:"flex items-center justify-between mb-3 pb-2 border-b border-gray-200",children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Image Settings"}),r.jsx("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs("div",{className:"mb-3",children:[r.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Width: ",Math.round(m.width),"px"]}),r.jsx("input",{type:"range",min:"50",max:"800",value:m.width,onChange:w=>h(parseInt(w.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),r.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[r.jsx("span",{children:"50px"}),r.jsx("span",{children:"800px"})]})]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Alignment"}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{onClick:()=>j("left"),className:`px-2 py-1 text-xs rounded ${g==="left"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"Left"}),r.jsx("button",{onClick:()=>j("center"),className:`px-2 py-1 text-xs rounded ${g==="center"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"Center"}),r.jsx("button",{onClick:()=>j("right"),className:`px-2 py-1 text-xs rounded ${g==="right"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"Right"}),r.jsx("button",{onClick:()=>j("none"),className:`px-2 py-1 text-xs rounded ${g==="none"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"Inline"})]})]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Text Wrapping"}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{onClick:()=>I("left"),className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 hover:bg-gray-200 rounded transition-colors",children:"Wrap Left"}),r.jsx("button",{onClick:()=>I("right"),className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 hover:bg-gray-200 rounded transition-colors",children:"Wrap Right"}),r.jsx("button",{onClick:()=>I("none"),className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 hover:bg-gray-200 rounded transition-colors",children:"No Wrap"})]})]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Quick Sizes"}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{onClick:()=>h(150),className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 hover:bg-gray-200 rounded transition-colors",children:"Small"}),r.jsx("button",{onClick:()=>h(300),className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 hover:bg-gray-200 rounded transition-colors",children:"Medium"}),r.jsx("button",{onClick:()=>h(500),className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 hover:bg-gray-200 rounded transition-colors",children:"Large"}),r.jsx("button",{onClick:()=>h(s.naturalWidth),className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 hover:bg-gray-200 rounded transition-colors",children:"Original"})]})]}),r.jsxs("div",{className:"flex gap-2 pt-2 border-t border-gray-200",children:[r.jsx("button",{onClick:F,className:"flex-1 px-2 py-1 text-xs bg-blue-50 text-blue-700 hover:bg-blue-100 rounded transition-colors",children:"Alt Text"}),r.jsx("button",{onClick:R,className:"flex-1 px-2 py-1 text-xs bg-red-50 text-red-700 hover:bg-red-100 rounded transition-colors",children:"Remove"})]})]})},Bt=({isOpen:s,onClose:e,onInsert:t})=>{const[o,l]=d.useState(3),[i,a]=d.useState(3),[m,u]=d.useState(!0),[g]=d.useState(3),[c]=d.useState(3),b=()=>{t(o,i,m),e()};return s?r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Insert Table"}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs("div",{className:"p-6",children:[r.jsx("div",{className:"mb-6",children:r.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[g," × ",c," table"]})}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rows"}),r.jsx("input",{type:"number",min:"1",max:"20",value:o,onChange:C=>l(Math.max(1,parseInt(C.target.value)||1)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Columns"}),r.jsx("input",{type:"number",min:"1",max:"20",value:i,onChange:C=>a(Math.max(1,parseInt(C.target.value)||1)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),r.jsx("div",{className:"mb-6",children:r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:m,onChange:C=>u(C.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),r.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Include header row"})]})}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preview:"}),r.jsx("div",{className:"border border-gray-300 rounded overflow-hidden",children:r.jsx("table",{className:"w-full text-xs",children:r.jsxs("tbody",{children:[Array.from({length:Math.min(o,4)},(C,x)=>r.jsxs("tr",{children:[Array.from({length:Math.min(i,6)},(j,h)=>r.jsx("td",{className:`border border-gray-200 p-1 text-center ${m&&x===0?"bg-gray-100 font-medium":"bg-white"}`,children:m&&x===0?`Header ${h+1}`:`Cell ${x+1},${h+1}`},h)),i>6&&r.jsx("td",{className:"border border-gray-200 p-1 text-center bg-gray-50",children:"..."})]},x)),o>4&&r.jsx("tr",{children:Array.from({length:Math.min(i+(i>6?1:0),7)},(C,x)=>r.jsx("td",{className:"border border-gray-200 p-1 text-center bg-gray-50",children:"..."},x))})]})})})]})]}),r.jsxs("div",{className:"flex justify-end gap-3 p-4 border-t border-gray-200 bg-gray-50",children:[r.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),r.jsx("button",{onClick:b,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 transition-colors",children:"Insert Table"})]})]})}):null},ct={General:["©","®","™","§","¶","†","‡","•","‰","′","″","‴","‹","›","«","»","–","—","…","¡","¿"],Currency:["$","¢","£","¤","¥","€","₹","₽","₩","₪","₫","₦","₡","₨","₱","₵"],Math:["±","×","÷","=","≠","≈","≡","≤","≥","<",">","∞","∑","∏","∂","∆","∇","∈","∉","∋","∌","∩","∪","⊂","⊃","⊆","⊇","⊕","⊗","⊥","∥","∠"],Greek:["Α","Β","Γ","Δ","Ε","Ζ","Η","Θ","Ι","Κ","Λ","Μ","Ν","Ξ","Ο","Π","Ρ","Σ","Τ","Υ","Φ","Χ","Ψ","Ω","α","β","γ","δ","ε","ζ","η","θ","ι","κ","λ","μ","ν","ξ","ο","π","ρ","σ","τ","υ","φ","χ","ψ","ω"],Arrows:["←","↑","→","↓","↔","↕","↖","↗","↘","↙","↚","↛","↜","↝","↞","↟","↠","↡","↢","↣","↤","↥","↦","↧","↨","↩","↪","↫","↬","↭","↮","↯"],Symbols:["☀","☁","☂","☃","☄","★","☆","☇","☈","☉","☊","☋","☌","☍","☎","☏","☐","☑","☒","☓","☔","☕","☖","☗","☘","☙","☚","☛","☜","☝","☞","☟"],Fractions:["½","⅓","⅔","¼","¾","⅕","⅖","⅗","⅘","⅙","⅚","⅛","⅜","⅝","⅞","⅟"]},$t=({isOpen:s,onClose:e,onInsert:t})=>{const[o,l]=d.useState("General"),[i,a]=d.useState(""),m=g=>{t(g),e()},u=i?Object.values(ct).flat().filter(g=>g.includes(i)||g.toLowerCase().includes(i.toLowerCase())):ct[o];return s?r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Special Characters"}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsx("div",{className:"p-4 border-b border-gray-200",children:r.jsx("input",{type:"text",placeholder:"Search characters...",value:i,onChange:g=>a(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})}),r.jsxs("div",{className:"flex h-96",children:[!i&&r.jsx("div",{className:"w-1/3 border-r border-gray-200 overflow-y-auto",children:r.jsx("div",{className:"p-2",children:Object.keys(ct).map(g=>r.jsx("button",{onClick:()=>l(g),className:`w-full text-left px-3 py-2 rounded-md text-sm transition-colors ${o===g?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-100"}`,children:g},g))})}),r.jsx("div",{className:`${i?"w-full":"w-2/3"} overflow-y-auto`,children:r.jsxs("div",{className:"p-4",children:[r.jsx("div",{className:"grid grid-cols-8 gap-2",children:u.map((g,c)=>r.jsx("button",{onClick:()=>m(g),className:"w-10 h-10 flex items-center justify-center text-lg border border-gray-300 rounded hover:bg-blue-50 hover:border-blue-300 transition-colors",title:`Insert ${g}`,children:g},`${g}-${c}`))}),u.length===0&&r.jsxs("div",{className:"text-center text-gray-500 py-8",children:['No characters found matching "',i,'"']})]})})]}),r.jsx("div",{className:"flex justify-end p-4 border-t border-gray-200 bg-gray-50",children:r.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Close"})})]})}):null},zt=({isOpen:s,onClose:e,onSubmit:t,title:o,placeholder:l="Enter URL...",initialValue:i="",description:a})=>{const[m,u]=d.useState(i),[g,c]=d.useState("");d.useEffect(()=>{s&&(u(i),c(""))},[s,i]);const b=x=>{if(x.preventDefault(),!m.trim()){c("URL is required");return}try{if(m.trim().startsWith("http://")||m.trim().startsWith("https://")||m.trim().startsWith("/"))t(m.trim()),e();else{const j=`https://${m.trim()}`;new URL(j),t(j),e()}}catch{c("Please enter a valid URL")}},C=x=>{x.key==="Escape"&&e()};return s?r.jsx("div",{className:"modal-backdrop",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,animation:"fadeIn 0.2s ease-out"},onClick:x=>x.target===x.currentTarget&&e(),children:r.jsxs("div",{className:"modal-content",style:{backgroundColor:"white",borderRadius:"12px",padding:"24px",width:"90%",maxWidth:"500px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",animation:"slideIn 0.3s ease-out"},onKeyDown:C,children:[r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"18px",fontWeight:"600",color:"#1f2937"},children:o}),a&&r.jsx("p",{style:{margin:0,fontSize:"14px",color:"#6b7280",lineHeight:"1.5"},children:a})]}),r.jsxs("form",{onSubmit:b,children:[r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("input",{type:"text",value:m,onChange:x=>{u(x.target.value),c("")},placeholder:l,autoFocus:!0,style:{width:"100%",padding:"12px",border:`2px solid ${g?"#ef4444":"#e5e7eb"}`,borderRadius:"8px",fontSize:"16px",outline:"none",transition:"border-color 0.2s ease",boxSizing:"border-box"},onFocus:x=>{x.target.style.borderColor="#3b82f6"},onBlur:x=>{g||(x.target.style.borderColor="#e5e7eb")}}),g&&r.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"14px",color:"#ef4444"},children:g})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",onClick:e,style:{padding:"10px 20px",border:"1px solid #d1d5db",borderRadius:"8px",backgroundColor:"white",color:"#374151",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:x=>{x.currentTarget.style.backgroundColor="#f9fafb",x.currentTarget.style.borderColor="#9ca3af"},onMouseLeave:x=>{x.currentTarget.style.backgroundColor="white",x.currentTarget.style.borderColor="#d1d5db"},children:"Cancel"}),r.jsxs("button",{type:"submit",style:{padding:"10px 20px",border:"none",borderRadius:"8px",backgroundColor:"#3b82f6",color:"white",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:x=>{x.currentTarget.style.backgroundColor="#2563eb"},onMouseLeave:x=>{x.currentTarget.style.backgroundColor="#3b82f6"},children:[i?"Update":"Add"," Link"]})]})]})]})}):null},Wt=({isOpen:s,onClose:e,onFindReplace:t})=>{const[o,l]=d.useState(""),[i,a]=d.useState(""),[m,u]=d.useState("");d.useEffect(()=>{s&&(l(""),a(""),u(""))},[s]);const g=b=>{if(b.preventDefault(),!o.trim()){u("Find text is required");return}t(o.trim(),i.trim()),e()},c=b=>{b.key==="Escape"&&e()};return s?r.jsx("div",{className:"modal-backdrop",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,animation:"fadeIn 0.2s ease-out"},onClick:b=>b.target===b.currentTarget&&e(),children:r.jsxs("div",{className:"modal-content",style:{backgroundColor:"white",borderRadius:"12px",padding:"24px",width:"90%",maxWidth:"500px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",animation:"slideIn 0.3s ease-out"},onKeyDown:c,children:[r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"18px",fontWeight:"600",color:"#1f2937"},children:"🔍 Find & Replace"}),r.jsx("p",{style:{margin:0,fontSize:"14px",color:"#6b7280",lineHeight:"1.5"},children:"Search for text in your document and replace it with new text."})]}),r.jsxs("form",{onSubmit:g,children:[r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Find:"}),r.jsx("input",{type:"text",value:o,onChange:b=>{l(b.target.value),u("")},placeholder:"Enter text to find...",autoFocus:!0,style:{width:"100%",padding:"12px",border:`2px solid ${m?"#ef4444":"#e5e7eb"}`,borderRadius:"8px",fontSize:"16px",outline:"none",transition:"border-color 0.2s ease",boxSizing:"border-box"},onFocus:b=>{b.target.style.borderColor="#3b82f6"},onBlur:b=>{m||(b.target.style.borderColor="#e5e7eb")}}),m&&r.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"14px",color:"#ef4444"},children:m})]}),r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Replace with:"}),r.jsx("input",{type:"text",value:i,onChange:b=>a(b.target.value),placeholder:"Enter replacement text...",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"16px",outline:"none",transition:"border-color 0.2s ease",boxSizing:"border-box"},onFocus:b=>{b.target.style.borderColor="#3b82f6"},onBlur:b=>{b.target.style.borderColor="#e5e7eb"}})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",onClick:e,style:{padding:"10px 20px",border:"1px solid #d1d5db",borderRadius:"8px",backgroundColor:"white",color:"#374151",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:b=>{b.currentTarget.style.backgroundColor="#f9fafb",b.currentTarget.style.borderColor="#9ca3af"},onMouseLeave:b=>{b.currentTarget.style.backgroundColor="white",b.currentTarget.style.borderColor="#d1d5db"},children:"Cancel"}),r.jsx("button",{type:"submit",style:{padding:"10px 20px",border:"none",borderRadius:"8px",backgroundColor:"#3b82f6",color:"white",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:b=>{b.currentTarget.style.backgroundColor="#2563eb"},onMouseLeave:b=>{b.currentTarget.style.backgroundColor="#3b82f6"},children:"Replace All"})]})]})]})}):null},Kt=({isOpen:s,onClose:e,title:t,message:o,type:l="info",autoClose:i=!1,autoCloseDelay:a=3e3})=>{d.useEffect(()=>{if(s&&i){const c=setTimeout(()=>{e()},a);return()=>clearTimeout(c)}},[s,i,a,e]);const m=c=>{c.key==="Escape"&&e()};if(!s)return null;const g=(()=>{switch(l){case"success":return{icon:"✅",iconColor:"#10b981",borderColor:"#10b981",backgroundColor:"#f0fdf4"};case"warning":return{icon:"⚠️",iconColor:"#f59e0b",borderColor:"#f59e0b",backgroundColor:"#fffbeb"};case"error":return{icon:"❌",iconColor:"#ef4444",borderColor:"#ef4444",backgroundColor:"#fef2f2"};default:return{icon:"ℹ️",iconColor:"#3b82f6",borderColor:"#3b82f6",backgroundColor:"#eff6ff"}}})();return r.jsxs("div",{className:"modal-backdrop",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,animation:"fadeIn 0.2s ease-out"},onClick:c=>c.target===c.currentTarget&&e(),children:[r.jsxs("div",{className:"modal-content",style:{backgroundColor:"white",borderRadius:"12px",padding:"24px",width:"90%",maxWidth:"400px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",animation:"slideIn 0.3s ease-out",border:`2px solid ${g.borderColor}`},onKeyDown:m,children:[r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"20px"},children:[r.jsx("div",{style:{fontSize:"24px",flexShrink:0},children:g.icon}),r.jsxs("div",{style:{flex:1},children:[r.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"18px",fontWeight:"600",color:"#1f2937"},children:t}),r.jsx("p",{style:{margin:0,fontSize:"14px",color:"#6b7280",lineHeight:"1.5"},children:o})]})]}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:r.jsx("button",{onClick:e,autoFocus:!0,style:{padding:"10px 20px",border:"none",borderRadius:"8px",backgroundColor:g.iconColor,color:"white",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:c=>{c.currentTarget.style.opacity="0.9"},onMouseLeave:c=>{c.currentTarget.style.opacity="1"},children:"OK"})}),i&&r.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"3px",backgroundColor:g.backgroundColor,borderBottomLeftRadius:"12px",borderBottomRightRadius:"12px",overflow:"hidden"},children:r.jsx("div",{style:{height:"100%",backgroundColor:g.iconColor,animation:`shrink ${a}ms linear`,transformOrigin:"left"}})})]}),r.jsx("style",{children:`
        @keyframes shrink {
          from { transform: scaleX(1); }
          to { transform: scaleX(0); }
        }
      `})]})},qt=({isOpen:s,linkUrl:e,linkText:t,position:o,onEdit:l,onRemove:i,onGoToLink:a,onClose:m})=>s?r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:999,background:"transparent"},onClick:m}),r.jsxs("div",{style:{position:"fixed",left:`${o.x}px`,top:`${o.y}px`,zIndex:1e3,background:"white",border:"1px solid #d1d5db",borderRadius:"8px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)",padding:"12px 16px",minWidth:"300px",maxWidth:"400px",fontSize:"14px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Helvetica Neue", Arial, sans-serif'},onClick:u=>u.stopPropagation(),children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[r.jsx("span",{style:{color:"#374151",fontWeight:"500"},children:"Go to link:"}),r.jsx("button",{onClick:a,style:{color:"#2563eb",textDecoration:"underline",background:"none",border:"none",cursor:"pointer",fontSize:"14px",padding:"0",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:e,children:e})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[r.jsx("button",{onClick:l,style:{color:"#2563eb",background:"none",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",padding:"4px 8px",borderRadius:"4px",transition:"background-color 0.2s"},onMouseEnter:u=>{u.currentTarget.style.backgroundColor="#eff6ff"},onMouseLeave:u=>{u.currentTarget.style.backgroundColor="transparent"},children:"Change"}),r.jsx("span",{style:{color:"#d1d5db"},children:"|"}),r.jsx("button",{onClick:i,style:{color:"#dc2626",background:"none",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",padding:"4px 8px",borderRadius:"4px",transition:"background-color 0.2s"},onMouseEnter:u=>{u.currentTarget.style.backgroundColor="#fef2f2"},onMouseLeave:u=>{u.currentTarget.style.backgroundColor="transparent"},children:"Remove"})]})]})]}):null,St={BOLD:{type:"execCommand",command:"bold",description:"Toggle bold formatting"},ITALIC:{type:"execCommand",command:"italic",description:"Toggle italic formatting"},UNDERLINE:{type:"execCommand",command:"underline",description:"Toggle underline formatting"},STRIKETHROUGH:{type:"execCommand",command:"strikeThrough",description:"Toggle strikethrough formatting"},SUBSCRIPT:{type:"execCommand",command:"subscript",description:"Toggle subscript formatting"},SUPERSCRIPT:{type:"execCommand",command:"superscript",description:"Toggle superscript formatting"},FORMAT_H1:{type:"execCommand",command:"formatBlock",value:"H1",description:"Format as heading 1"},FORMAT_H2:{type:"execCommand",command:"formatBlock",value:"H2",description:"Format as heading 2"},FORMAT_H3:{type:"execCommand",command:"formatBlock",value:"H3",description:"Format as heading 3"},FORMAT_H4:{type:"execCommand",command:"formatBlock",value:"H4",description:"Format as heading 4"},FORMAT_H5:{type:"execCommand",command:"formatBlock",value:"H5",description:"Format as heading 5"},FORMAT_H6:{type:"execCommand",command:"formatBlock",value:"H6",description:"Format as heading 6"},FORMAT_PARAGRAPH:{type:"execCommand",command:"formatBlock",value:"P",description:"Format as paragraph"},FORMAT_BLOCKQUOTE:{type:"execCommand",command:"formatBlock",value:"BLOCKQUOTE",description:"Format as blockquote"},FORMAT_PRE:{type:"execCommand",command:"formatBlock",value:"PRE",description:"Format as preformatted text"},INSERT_UNORDERED_LIST:{type:"execCommand",command:"insertUnorderedList",description:"Create bullet list"},INSERT_ORDERED_LIST:{type:"execCommand",command:"insertOrderedList",description:"Create numbered list"},JUSTIFY_LEFT:{type:"execCommand",command:"justifyLeft",description:"Align text left"},JUSTIFY_CENTER:{type:"execCommand",command:"justifyCenter",description:"Center align text"},JUSTIFY_RIGHT:{type:"execCommand",command:"justifyRight",description:"Align text right"},JUSTIFY_FULL:{type:"execCommand",command:"justifyFull",description:"Justify text"},INDENT:{type:"execCommand",command:"indent",description:"Increase indent"},OUTDENT:{type:"execCommand",command:"outdent",description:"Decrease indent"},FONT_COLOR:{type:"custom",command:"foreColor",description:"Change text color"},BACKGROUND_COLOR:{type:"custom",command:"backColor",description:"Change background color"},FONT_NAME:{type:"execCommand",command:"fontName",description:"Change font family"},FONT_SIZE:{type:"execCommand",command:"fontSize",description:"Change font size"},INSERT_HORIZONTAL_RULE:{type:"execCommand",command:"insertHorizontalRule",description:"Insert horizontal rule"},CREATE_LINK:{type:"custom",command:"createLink",description:"Create hyperlink"},EDIT_LINK:{type:"custom",command:"editLink",description:"Edit existing hyperlink"},UNLINK:{type:"execCommand",command:"unlink",description:"Remove hyperlink"},UNDO:{type:"execCommand",command:"undo",description:"Undo last action"},REDO:{type:"execCommand",command:"redo",description:"Redo last undone action"},REMOVE_FORMAT:{type:"execCommand",command:"removeFormat",description:"Clear all formatting"},INSERT_IMAGE:{type:"custom",command:"insertImage",description:"Insert image"},UPLOAD_FILE:{type:"custom",command:"uploadFile",description:"Upload and insert file"},INSERT_TABLE:{type:"custom",command:"insertTable",description:"Insert table"},INSERT_SPECIAL_CHAR:{type:"custom",command:"insertSpecialChar",description:"Insert special character"},FIND_REPLACE:{type:"custom",command:"findReplace",description:"Find and replace text"},SOURCE_CODE:{type:"custom",command:"sourceCode",description:"Edit HTML source code"},FULLSCREEN:{type:"custom",command:"fullscreen",description:"Toggle fullscreen mode"},PRINT:{type:"custom",command:"print",description:"Print document"},SPELL_CHECK:{type:"custom",command:"spellCheck",description:"Toggle spell check"}},ve=class ve{constructor(){}static getInstance(){return ve.instance||(ve.instance=new ve),ve.instance}executeCommand(e,t,o,l){const i=St[e];if(!i)return{success:!1,error:`Unknown command: ${e}`,command:e};if(i.type==="custom")return this.executeCustomCommand(e,t,o);if(i.requiresSelection&&this.isSelectionEmpty())return{success:!1,error:`Command ${e} requires text selection`,command:e};try{o&&document.activeElement!==o&&o.focus();const a=t||i.value||"";return document.execCommand(i.command,!1,a)?{success:!0,command:e,value:a}:{success:!1,error:`Command execution failed: ${i.command}`,command:e,value:a}}catch(a){return{success:!1,error:`Command execution error: ${a instanceof Error?a.message:"Unknown error"}`,command:e,value:t||i.value||""}}}executeCustomCommand(e,t,o){try{switch(o&&document.activeElement!==o&&o.focus(),e){case"FONT_COLOR":return this.setFontColor(t);case"BACKGROUND_COLOR":return this.setBackgroundColor(t);case"CREATE_LINK":return this.createLink(t);case"EDIT_LINK":return this.editLink(t);case"INSERT_IMAGE":return t?this.insertImage(t):this.triggerImageUpload();case"UPLOAD_FILE":return this.uploadFile(t);case"INSERT_TABLE":return this.insertTable(t);case"INSERT_SPECIAL_CHAR":return this.insertSpecialChar(t);case"FIND_REPLACE":return this.findReplace();case"SOURCE_CODE":return this.toggleSourceCode();case"FULLSCREEN":return this.toggleFullscreen();case"PRINT":return this.printDocument();case"SPELL_CHECK":return this.toggleSpellCheck();default:return{success:!1,error:`Unknown custom command: ${e}`,command:e}}}catch(l){return{success:!1,error:`Custom command execution error: ${l instanceof Error?l.message:"Unknown error"}`,command:e,value:t||""}}}isSelectionEmpty(){const e=window.getSelection();return!e||e.isCollapsed}getActiveFormats(){const e=new Set;try{document.queryCommandState("bold")&&e.add("BOLD"),document.queryCommandState("italic")&&e.add("ITALIC"),document.queryCommandState("underline")&&e.add("UNDERLINE"),document.queryCommandState("strikeThrough")&&e.add("STRIKETHROUGH"),document.queryCommandState("subscript")&&e.add("SUBSCRIPT"),document.queryCommandState("superscript")&&e.add("SUPERSCRIPT");const t=this.getCurrentBlockFormat();t==="H1"?e.add("FORMAT_H1"):t==="H2"?e.add("FORMAT_H2"):t==="H3"?e.add("FORMAT_H3"):t==="H4"?e.add("FORMAT_H4"):t==="H5"?e.add("FORMAT_H5"):t==="H6"?e.add("FORMAT_H6"):t==="BLOCKQUOTE"?e.add("FORMAT_BLOCKQUOTE"):t==="PRE"&&e.add("FORMAT_PRE"),document.queryCommandState("justifyLeft")&&e.add("JUSTIFY_LEFT"),document.queryCommandState("justifyCenter")&&e.add("JUSTIFY_CENTER"),document.queryCommandState("justifyRight")&&e.add("JUSTIFY_RIGHT"),document.queryCommandState("justifyFull")&&e.add("JUSTIFY_FULL"),document.queryCommandState("insertUnorderedList")&&e.add("INSERT_UNORDERED_LIST"),document.queryCommandState("insertOrderedList")&&e.add("INSERT_ORDERED_LIST"),this.isInLink()&&(e.add("CREATE_LINK"),e.add("EDIT_LINK"))}catch(t){console.warn("Error checking command states:",t)}return e}canUndo(){try{return document.queryCommandEnabled("undo")}catch{return!1}}canRedo(){try{return document.queryCommandEnabled("redo")}catch{return!1}}getCurrentBlockFormat(){try{return document.queryCommandValue("formatBlock").toUpperCase()}catch{return""}}createLink(e){const t=window.getSelection();if(!e)return{success:!1,error:"URL is required to create a link",command:"CREATE_LINK"};const o=this.normalizeUrl(e);if(!o)return{success:!1,error:"Invalid URL provided",command:"CREATE_LINK",value:e};try{if(!t||t.isCollapsed){const l=document.createElement("a");if(l.href=o,l.textContent=e,l.target="_blank",l.rel="noopener noreferrer",t&&t.rangeCount>0){const i=t.getRangeAt(0);i.insertNode(l),i.setStartAfter(l),i.setEndAfter(l),t.removeAllRanges(),t.addRange(i)}else{const i=document.querySelector(".editable-area");if(i)i.appendChild(l);else return{success:!1,error:"No cursor position found and no editor element",command:"CREATE_LINK"}}return{success:!0,command:"CREATE_LINK",value:o}}else return document.execCommand("createLink",!1,o)?(setTimeout(()=>{const i=window.getSelection();if(i&&i.rangeCount>0){const a=this.findLinkInSelection(i);if(a)a.setAttribute("target","_blank"),a.setAttribute("rel","noopener noreferrer");else{const m=document.querySelector(".editable-area");m&&m.querySelectorAll(`a[href="${o}"]`).forEach(g=>{g.hasAttribute("target")||(g.setAttribute("target","_blank"),g.setAttribute("rel","noopener noreferrer"))})}}},0),{success:!0,command:"CREATE_LINK",value:o}):{success:!1,error:"Failed to create link",command:"CREATE_LINK",value:o}}catch(l){return{success:!1,error:`Link creation error: ${l instanceof Error?l.message:"Unknown error"}`,command:"CREATE_LINK",value:o}}}editLink(e){const t=window.getSelection();if(!t||!t.rangeCount)return{success:!1,error:"No selection available",command:"EDIT_LINK"};const o=this.findLinkInSelection(t);if(!o)return{success:!1,error:"No link found in current selection or cursor position",command:"EDIT_LINK"};let l=e;if(!l)return{success:!1,error:"URL is required to edit the link",command:"EDIT_LINK"};if(!l||l.trim()==="")return this.removeLinkElement(o);const i=this.normalizeUrl(l);if(!i)return{success:!1,error:"Invalid URL provided",command:"EDIT_LINK",value:l};try{return o.setAttribute("href",i),o.hasAttribute("target")||o.setAttribute("target","_blank"),o.hasAttribute("rel")||o.setAttribute("rel","noopener noreferrer"),{success:!0,command:"EDIT_LINK",value:i}}catch(a){return{success:!1,error:`Link editing error: ${a instanceof Error?a.message:"Unknown error"}`,command:"EDIT_LINK",value:i}}}findLinkInSelection(e){if(!e.rangeCount)return null;const t=e.getRangeAt(0);let o=t.commonAncestorContainer;if(o.nodeType===Node.TEXT_NODE&&(o=o.parentElement),o instanceof HTMLAnchorElement)return o;const l=o.closest("a");if(l instanceof HTMLAnchorElement)return l;if(t.cloneContents().querySelector("a")){const m=document.createTreeWalker(t.commonAncestorContainer,NodeFilter.SHOW_ELEMENT,{acceptNode:g=>g instanceof HTMLAnchorElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});let u=m.nextNode();for(;u;){if(t.intersectsNode(u))return u;u=m.nextNode()}}return null}removeLinkElement(e){var t;try{const o=e.textContent||"",l=document.createTextNode(o);return(t=e.parentNode)==null||t.replaceChild(l,e),{success:!0,command:"EDIT_LINK",value:"Link removed"}}catch(o){return{success:!1,error:`Error removing link: ${o instanceof Error?o.message:"Unknown error"}`,command:"EDIT_LINK"}}}isInLink(){const e=window.getSelection();return!e||!e.rangeCount?!1:this.findLinkInSelection(e)!==null}insertImage(e,t){var o,l,i;if(!this.isValidImageUrl(e))return{success:!1,error:"Invalid image URL provided",command:"INSERT_IMAGE",value:e};try{const a=document.createElement("img");a.src=e,a.alt=(t==null?void 0:t.alt)||"Inserted image",a.className="editor-image",a.draggable=!0,a.style.maxWidth="100%",a.style.height="auto",a.style.cursor="pointer",a.style.border="2px solid transparent",a.style.borderRadius="4px",a.style.transition="all 0.2s ease",t!=null&&t.width&&(a.style.width=`${t.width}px`),t!=null&&t.height&&(a.style.height=`${t.height}px`),t!=null&&t.alignment&&this.applyImageAlignment(a,t.alignment),t!=null&&t.float&&t.float!=="none"&&this.applyImageFloat(a,t.float),a.addEventListener("mouseenter",()=>{a.style.borderColor="#3b82f6",a.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.15)"}),a.addEventListener("mouseleave",()=>{a.style.borderColor="transparent",a.style.boxShadow="none"});const m=window.getSelection();if(m&&m.rangeCount>0){const u=m.getRangeAt(0),g=u.commonAncestorContainer;if(g.nodeType===Node.TEXT_NODE&&((o=g.textContent)!=null&&o.trim())){const c=g,b=((l=c.textContent)==null?void 0:l.substring(0,u.startOffset))||"",C=((i=c.textContent)==null?void 0:i.substring(u.endOffset))||"";if(b||C){const x=document.createElement("p"),j=document.createElement("p"),h=document.createElement("p");b&&(x.textContent=b),h.appendChild(a),C&&(j.textContent=C);const I=c.parentNode;I&&(I.insertBefore(b?x:h,c),b&&I.insertBefore(h,c),C&&I.insertBefore(j,c),I.removeChild(c))}else u.deleteContents(),u.insertNode(a)}else u.deleteContents(),u.insertNode(a);u.setStartAfter(a),u.setEndAfter(a),m.removeAllRanges(),m.addRange(u)}else{const u=document.querySelector(".editable-area");if(u){const g=document.createElement("p");g.appendChild(a),u.appendChild(g)}else return{success:!1,error:"No cursor position found and no editor element",command:"INSERT_IMAGE"}}return{success:!0,command:"INSERT_IMAGE",value:e}}catch(a){return{success:!1,error:`Image insertion error: ${a instanceof Error?a.message:"Unknown error"}`,command:"INSERT_IMAGE",value:e}}}applyImageAlignment(e,t){switch(t){case"left":e.style.display="block",e.style.marginLeft="0",e.style.marginRight="auto";break;case"center":e.style.display="block",e.style.marginLeft="auto",e.style.marginRight="auto";break;case"right":e.style.display="block",e.style.marginLeft="auto",e.style.marginRight="0";break;case"none":e.style.display="inline-block",e.style.marginLeft="",e.style.marginRight="";break}}applyImageFloat(e,t){e.style.float=t,e.style.margin=t==="left"?"0 15px 10px 0":"0 0 10px 15px"}triggerImageUpload(){try{const e=document.createElement("input");return e.type="file",e.accept="image/*",e.style.display="none",e.onchange=t=>{var a;const o=(a=t.target.files)==null?void 0:a[0];if(!o)return;if(!o.type.startsWith("image/")){console.error("Selected file is not an image");return}const l=5*1024*1024;if(o.size>l){console.error("Image file is too large (max 5MB)");return}const i=new FileReader;i.onload=m=>{var g;const u=(g=m.target)==null?void 0:g.result;this.insertImage(u)},i.onerror=()=>{console.error("Failed to read image file")},i.readAsDataURL(o)},document.body.appendChild(e),e.click(),document.body.removeChild(e),{success:!0,command:"INSERT_IMAGE",value:"File upload triggered"}}catch(e){return{success:!1,error:`File upload error: ${e instanceof Error?e.message:"Unknown error"}`,command:"INSERT_IMAGE"}}}uploadFile(e){if(e)return this.insertFileLink(e);try{const t=document.createElement("input");return t.type="file",t.style.display="none",t.onchange=o=>{var m;const l=(m=o.target.files)==null?void 0:m[0];if(!l)return;const i=10*1024*1024;if(l.size>i){console.error("File is too large (max 10MB)");return}const a=URL.createObjectURL(l);this.insertFileLink(a,l.name,l.type)},document.body.appendChild(t),t.click(),document.body.removeChild(t),{success:!0,command:"UPLOAD_FILE",value:"File upload triggered"}}catch(t){return{success:!1,error:`File upload error: ${t instanceof Error?t.message:"Unknown error"}`,command:"UPLOAD_FILE"}}}insertFileLink(e,t,o){try{const l=document.createElement("a");l.href=e,l.download=t||"download",l.target="_blank",l.rel="noopener noreferrer";const i=t||"Download File",a=this.getFileIcon(o);l.innerHTML=`${a} ${i}`,l.style.display="inline-block",l.style.padding="8px 12px",l.style.margin="4px",l.style.backgroundColor="#f0f0f0",l.style.border="1px solid #ccc",l.style.borderRadius="4px",l.style.textDecoration="none",l.style.color="#333";const m=window.getSelection();if(m&&m.rangeCount>0){const u=m.getRangeAt(0);u.deleteContents(),u.insertNode(l),u.setStartAfter(l),u.setEndAfter(l),m.removeAllRanges(),m.addRange(u)}else return{success:!1,error:"No cursor position found",command:"UPLOAD_FILE"};return{success:!0,command:"UPLOAD_FILE",value:e}}catch(l){return{success:!1,error:`File insertion error: ${l instanceof Error?l.message:"Unknown error"}`,command:"UPLOAD_FILE",value:e}}}getFileIcon(e){return e?e.startsWith("image/")?"🖼️":e.startsWith("video/")?"🎥":e.startsWith("audio/")?"🎵":e.includes("pdf")?"📕":e.includes("word")||e.includes("document")?"📝":e.includes("excel")||e.includes("spreadsheet")||e.includes("powerpoint")||e.includes("presentation")?"📊":e.includes("zip")||e.includes("archive")?"🗜️":"📄":"📄"}insertTable(e){try{const t=e?e.split(","):["3","3","true"],o=parseInt(t[0])||3,l=parseInt(t[1])||3,i=t[2]==="true",a=document.createElement("table");a.className="editor-table",a.style.borderCollapse="collapse",a.style.width="100%",a.style.border="1px solid #ccc",a.style.margin="10px 0";const m=document.createElement("tbody");for(let g=0;g<o;g++){const c=document.createElement("tr");for(let b=0;b<l;b++){const C=document.createElement(i&&g===0?"th":"td");C.style.border="1px solid #ccc",C.style.padding="8px",C.style.minWidth="50px",C.style.minHeight="20px",i&&g===0?(C.style.backgroundColor="#f5f5f5",C.style.fontWeight="bold",C.textContent=`Header ${b+1}`):C.innerHTML="&nbsp;",c.appendChild(C)}m.appendChild(c)}a.appendChild(m);const u=window.getSelection();if(u&&u.rangeCount>0){const g=u.getRangeAt(0);g.deleteContents(),g.insertNode(a);const c=a.querySelector("td, th");c&&(g.selectNodeContents(c),g.collapse(!0),u.removeAllRanges(),u.addRange(g))}else return{success:!1,error:"No cursor position found",command:"INSERT_TABLE"};return{success:!0,command:"INSERT_TABLE",value:`${o}x${l} table inserted`}}catch(t){return{success:!1,error:`Table insertion error: ${t instanceof Error?t.message:"Unknown error"}`,command:"INSERT_TABLE"}}}insertSpecialChar(e){if(!e)return{success:!1,error:"No character specified",command:"INSERT_SPECIAL_CHAR"};try{const t=window.getSelection();if(t&&t.rangeCount>0){const o=t.getRangeAt(0);o.deleteContents(),o.insertNode(document.createTextNode(e)),o.setStartAfter(o.endContainer),o.collapse(!0),t.removeAllRanges(),t.addRange(o)}else return{success:!1,error:"No cursor position found",command:"INSERT_SPECIAL_CHAR"};return{success:!0,command:"INSERT_SPECIAL_CHAR",value:e}}catch(t){return{success:!1,error:`Special character insertion error: ${t instanceof Error?t.message:"Unknown error"}`,command:"INSERT_SPECIAL_CHAR"}}}findReplace(){return{success:!1,error:"Find and replace should be handled by the modal system",command:"FIND_REPLACE"}}toggleSourceCode(){try{const e=document.querySelector(".editable-area");if(!e)return{success:!1,error:"Editor element not found",command:"SOURCE_CODE"};const t=e.getAttribute("data-source-mode")==="true";if(t){const o=e.textContent||"";e.innerHTML=o,e.contentEditable="true",e.removeAttribute("data-source-mode"),e.style.fontFamily="",e.style.whiteSpace=""}else{const o=e.innerHTML;e.textContent=o,e.contentEditable="true",e.setAttribute("data-source-mode","true"),e.style.fontFamily="monospace",e.style.whiteSpace="pre-wrap"}return{success:!0,command:"SOURCE_CODE",value:t?"WYSIWYG mode":"Source mode"}}catch(e){return{success:!1,error:`Source code toggle error: ${e instanceof Error?e.message:"Unknown error"}`,command:"SOURCE_CODE"}}}toggleFullscreen(){try{const e=document.querySelector(".wysiwyg-editor");if(!e)return{success:!1,error:"Editor container not found",command:"FULLSCREEN"};const t=e.classList.contains("fullscreen");return t?(e.classList.remove("fullscreen"),document.body.style.overflow=""):(e.classList.add("fullscreen"),document.body.style.overflow="hidden"),{success:!0,command:"FULLSCREEN",value:t?"Exited fullscreen":"Entered fullscreen"}}catch(e){return{success:!1,error:`Fullscreen toggle error: ${e instanceof Error?e.message:"Unknown error"}`,command:"FULLSCREEN"}}}printDocument(){try{const e=document.querySelector(".editable-area");if(!e)return{success:!1,error:"Editor element not found",command:"PRINT"};const t=window.open("","_blank");if(!t)return{success:!1,error:"Could not open print window",command:"PRINT"};const o=e.innerHTML;return t.document.write(`
        <!DOCTYPE html>
        <html>
        <head>
          <title>Print Document</title>
          <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            table { border-collapse: collapse; width: 100%; }
            th, td { border: 1px solid #ccc; padding: 8px; }
            th { background-color: #f5f5f5; font-weight: bold; }
            img { max-width: 100%; height: auto; }
          </style>
        </head>
        <body>
          ${o}
        </body>
        </html>
      `),t.document.close(),t.focus(),t.print(),t.close(),{success:!0,command:"PRINT",value:"Print dialog opened"}}catch(e){return{success:!1,error:`Print error: ${e instanceof Error?e.message:"Unknown error"}`,command:"PRINT"}}}toggleSpellCheck(){try{const e=document.querySelector(".editable-area");if(!e)return{success:!1,error:"Editor element not found",command:"SPELL_CHECK"};const t=e.spellcheck;return e.spellcheck=!t,{success:!0,command:"SPELL_CHECK",value:t?"Spell check disabled":"Spell check enabled"}}catch(e){return{success:!1,error:`Spell check toggle error: ${e instanceof Error?e.message:"Unknown error"}`,command:"SPELL_CHECK"}}}isValidImageUrl(e){if(!e||e.trim()==="")return!1;if(e.startsWith("data:image/")||e.startsWith("blob:"))return!0;try{return new URL(e),/\.(jpg|jpeg|png|gif|bmp|webp|svg)(\?.*)?$/i.test(e)}catch{return!1}}setFontColor(e){if(!e)return{success:!1,error:"Color value is required",command:"FONT_COLOR"};try{return document.execCommand("foreColor",!1,e)?{success:!0,command:"FONT_COLOR",value:e}:{success:!1,error:"Failed to set font color",command:"FONT_COLOR",value:e}}catch(t){return{success:!1,error:`Font color error: ${t instanceof Error?t.message:"Unknown error"}`,command:"FONT_COLOR",value:e}}}setBackgroundColor(e){if(!e)return{success:!1,error:"Color value is required",command:"BACKGROUND_COLOR"};try{return document.execCommand("backColor",!1,e)?{success:!0,command:"BACKGROUND_COLOR",value:e}:{success:!1,error:"Failed to set background color",command:"BACKGROUND_COLOR",value:e}}catch(t){return{success:!1,error:`Background color error: ${t instanceof Error?t.message:"Unknown error"}`,command:"BACKGROUND_COLOR",value:e}}}normalizeUrl(e){if(!e||e.trim()==="")return null;const t=e.trim();try{return/^https?:\/\//i.test(t)?(new URL(t),t):t.includes("@")&&!t.includes(" ")?`mailto:${t}`:`http://${t}`}catch{return null}}};lt(ve,"instance");let Ve=ve;const fe=Ve.getInstance(),Lt=({initialContent:s="",placeholder:e="Start typing...",onChange:t,onFocus:o,onBlur:l})=>{const[i,a]=d.useState(s),[m,u]=d.useState(!1),[g,c]=d.useState(new Set),[b,C]=d.useState(!1),[x,j]=d.useState(!1),[h,I]=d.useState(!1),[F,R]=d.useState(!1),[w,D]=d.useState(""),[E,S]=d.useState("image"),[Y,K]=d.useState(null),[N,M]=d.useState([]),[P,q]=d.useState(!1),[z,X]=d.useState(!1),[se,ce]=d.useState(!1),[ie,Ce]=d.useState("create"),[De,pe]=d.useState(""),[Ue,Se]=d.useState(!1),[Me,Pe]=d.useState(!1),[Le,Te]=d.useState({title:"",message:"",type:"info"}),[ge,he]=d.useState(null),[we,ue]=d.useState(!1),[ee,He]=d.useState({url:"",text:"",position:{x:0,y:0},element:null}),T=d.useRef(null),be=d.useRef(null),W=d.useCallback(()=>{if(!m||!T.current)return;const p=fe.getActiveFormats();c(p),C(fe.canUndo()),j(fe.canRedo())},[m]),H=d.useCallback(p=>{be.current&&(be.current.textContent=p,setTimeout(()=>{be.current&&(be.current.textContent="")},1e3))},[]),Ne=d.useCallback((p,k)=>{const v={bold:"bold",italic:"italic",underline:"underline",insertUnorderedList:"bullet list",insertOrderedList:"numbered list",justifyLeft:"left aligned",justifyCenter:"center aligned",justifyRight:"right aligned",createLink:"link",unlink:"link removed",insertImage:"image inserted",uploadFile:"file uploaded",undo:"undone",redo:"redone",removeFormat:"formatting cleared"};return p==="formatBlock"&&k?`heading ${k.toLowerCase()}`:v[p]||p},[]),Be=d.useCallback(p=>{const k=new FileReader;k.onload=v=>{var B;const A=(B=v.target)==null?void 0:B.result;D(A),R(!1),I(!0)},k.readAsDataURL(p)},[]),ke=d.useCallback(p=>{const k=fe.insertImage(p);k.success?(H("Image inserted"),setTimeout(()=>{if(T.current){const v=T.current.innerHTML;a(v),t==null||t(v),W(),Ie()}},0)):(console.warn("Image insertion failed:",k.error),H("Image insertion failed")),I(!1),D("")},[t,W,H]),Ie=d.useCallback(()=>{if(!T.current)return;const p=T.current.querySelectorAll("img.editor-image"),k=Array.from(p);k.forEach(v=>{v.removeEventListener("click",$e),v.addEventListener("click",$e),v.addEventListener("dragstart",je),v.addEventListener("dragend",Xe)}),M(k)},[]),$e=d.useCallback(p=>{p.stopPropagation();const k=p.target;K(k)},[]),je=d.useCallback(p=>{const k=p.target;p.dataTransfer&&(p.dataTransfer.effectAllowed="move",p.dataTransfer.setData("text/html",k.outerHTML),k.style.opacity="0.5")},[]),Xe=d.useCallback(p=>{const k=p.target;k.style.opacity="1"},[]),Ze=d.useCallback(()=>{if(T.current){const p=T.current.innerHTML;a(p),t==null||t(p)}},[t]),ze=d.useCallback(()=>{if(Y&&Y.parentNode){if(Y.parentNode.removeChild(Y),K(null),T.current){const p=T.current.innerHTML;a(p),t==null||t(p)}H("Image removed")}},[Y,t,H]),We=d.useCallback(p=>{const k=URL.createObjectURL(p),v=document.createElement("a");v.href=k,v.download=p.name,v.target="_blank",v.rel="noopener noreferrer";const A=Ke(p.type);v.innerHTML=`${A} ${p.name}`,v.style.display="inline-block",v.style.padding="8px 12px",v.style.margin="4px",v.style.backgroundColor="#f0f0f0",v.style.border="1px solid #ccc",v.style.borderRadius="4px",v.style.textDecoration="none",v.style.color="#333";const B=window.getSelection();if(B&&B.rangeCount>0){const te=B.getRangeAt(0);te.deleteContents(),te.insertNode(v),te.setStartAfter(v),te.setEndAfter(v),B.removeAllRanges(),B.addRange(te),H("File uploaded and inserted"),setTimeout(()=>{if(T.current){const re=T.current.innerHTML;a(re),t==null||t(re),W()}},0)}else H("File upload failed - no cursor position");R(!1)},[t,W,H]),Ke=d.useCallback(p=>p.startsWith("image/")?"🖼️":p.startsWith("video/")?"🎥":p.startsWith("audio/")?"🎵":p.includes("pdf")?"📕":p.includes("word")||p.includes("document")?"📝":p.includes("excel")||p.includes("spreadsheet")||p.includes("powerpoint")||p.includes("presentation")?"📊":p.includes("zip")||p.includes("archive")?"🗜️":"📄",[]),Qe=d.useCallback((p,k,v)=>{if(!T.current)return;const A=`${p},${k},${v}`,B=fe.executeCommand("INSERT_TABLE",A,T.current);B.success?(H("Table inserted"),setTimeout(()=>{if(T.current){const te=T.current.innerHTML;a(te),t==null||t(te),W()}},0)):(console.warn("Table insertion failed:",B.error),H("Table insertion failed")),q(!1)},[t,W,H]),qe=d.useCallback(p=>{if(!T.current)return;const k=fe.executeCommand("INSERT_SPECIAL_CHAR",p,T.current);k.success?(H(`Special character ${p} inserted`),setTimeout(()=>{if(T.current){const v=T.current.innerHTML;a(v),t==null||t(v),W()}},0)):(console.warn("Special character insertion failed:",k.error),H("Special character insertion failed")),X(!1)},[t,W,H]),Ye=d.useCallback(p=>{if(!T.current)return;if(ge&&ie==="create"){const A=window.getSelection();A&&(A.removeAllRanges(),A.addRange(ge),T.current.focus())}const k=ie==="create"?"CREATE_LINK":"EDIT_LINK",v=fe.executeCommand(k,p,T.current);v.success?(H(`Link ${ie==="create"?"created":"updated"}`),setTimeout(()=>{if(T.current){const B=T.current.innerHTML;a(B),t==null||t(B),W()}},0)):Re("Error",v.error||"Failed to create link","error"),he(null),pe(""),ce(!1)},[ie,ge,t,W,H]),et=d.useCallback((p,k)=>{if(!T.current)return;const v=T.current.innerHTML,A=v.replace(new RegExp(p,"gi"),k);if(v!==A){T.current.innerHTML=A,a(A),t==null||t(A);const B=(v.match(new RegExp(p,"gi"))||[]).length;Re("Find & Replace",`Replaced ${B} occurrence(s)`,"success"),H(`Replaced ${B} occurrences`)}else Re("Find & Replace","No matches found","info")},[t,H]),Re=d.useCallback((p,k,v="info")=>{Te({title:p,message:k,type:v}),Pe(!0)},[]),tt=d.useCallback((p,k)=>{p.preventDefault(),p.stopPropagation();const v=k.getBoundingClientRect(),A={x:v.left,y:v.bottom+5};He({url:k.href,text:k.textContent||"",position:A,element:k}),ue(!0)},[]),rt=d.useCallback(()=>{ee.element&&(pe(ee.element.href),Ce("edit"),ce(!0),ue(!1))},[ee.element]),nt=d.useCallback(()=>{var p;if(ee.element){const k=ee.element.textContent||"",v=document.createTextNode(k);if((p=ee.element.parentNode)==null||p.replaceChild(v,ee.element),T.current){const A=T.current.innerHTML;a(A),t==null||t(A)}H("Link removed"),ue(!1)}},[ee.element,t,H]),ot=d.useCallback(()=>{ee.url&&(window.open(ee.url,"_blank","noopener,noreferrer"),ue(!1))},[ee.url]),st=d.useCallback(()=>{ue(!1)},[]),xe=d.useCallback((p,k,v=!1)=>{if(!T.current)return;const A=window.getSelection();let B=null;if(A&&A.rangeCount>0){const J=A.getRangeAt(0);typeof J.cloneRange=="function"&&(B=J.cloneRange())}if(p==="insertImage"){S("image"),R(!0);return}if(p==="uploadFile"){S("file"),R(!0);return}if(p==="insertTable"){q(!0);return}if(p==="insertSpecialChar"){X(!0);return}if(p==="createLink"){he(B),Ce("create"),pe(""),ce(!0);return}if(p==="editLink"){const J=window.getSelection();let Z=null;if(J&&J.rangeCount>0){const ne=J.getRangeAt(0),de=Q=>{var n;if(Q.nodeType===Node.TEXT_NODE)return((n=Q.parentElement)==null?void 0:n.closest("a"))||null;if(Q.nodeType===Node.ELEMENT_NODE){const f=Q;return f.tagName==="A"?f:f.closest("a")||null}return null};if(Z=de(ne.startContainer),!Z&&!J.isCollapsed){const Q=de(ne.endContainer);Q&&(Z=Q)}if(Z||(Z=de(ne.commonAncestorContainer)),!Z&&T.current){const Q=T.current.querySelectorAll("a[href]");for(const n of Array.from(Q))if(ne.intersectsNode(n)){Z=n;break}}}if(!Z&&T.current){const ne=T.current.querySelectorAll("a[href]");ne.length===1&&(Z=ne[0])}if(Z&&Z.href){pe(Z.href),Ce("edit"),ce(!0);return}Re("Edit Link","Please place your cursor on a link to edit it, or select the link text first","info");return}if(p==="findReplace"){Se(!0);return}let re={bold:"BOLD",italic:"ITALIC",underline:"UNDERLINE",strikethrough:"STRIKETHROUGH",subscript:"SUBSCRIPT",superscript:"SUPERSCRIPT",formatBlock:"FORMAT_H1",fontSize:"FONT_SIZE",fontName:"FONT_NAME",fontColor:"FONT_COLOR",backgroundColor:"BACKGROUND_COLOR",insertUnorderedList:"INSERT_UNORDERED_LIST",insertOrderedList:"INSERT_ORDERED_LIST",indent:"INDENT",outdent:"OUTDENT",justifyLeft:"JUSTIFY_LEFT",justifyCenter:"JUSTIFY_CENTER",justifyRight:"JUSTIFY_RIGHT",justifyFull:"JUSTIFY_FULL",createLink:"CREATE_LINK",editLink:"EDIT_LINK",unlink:"UNLINK",insertHorizontalRule:"INSERT_HORIZONTAL_RULE",findReplace:"FIND_REPLACE",sourceCode:"SOURCE_CODE",fullscreen:"FULLSCREEN",print:"PRINT",spellCheck:"SPELL_CHECK",undo:"UNDO",redo:"REDO",removeFormat:"REMOVE_FORMAT"}[p];if(p==="formatBlock"&&k&&(re=`FORMAT_${k}`),re){const J=fe.executeCommand(re,k,T.current);if(J.success){const Z=Ne(p,k),de=g.has(re)?"removed":"applied";H(`${Z} ${de}`),setTimeout(()=>{if(T.current){const Q=T.current.innerHTML;a(Q),t==null||t(Q),W()}},0)}else console.warn("Command execution failed:",J.error),H("Command failed")}},[t,W,g,Ne,H]),Ge=d.useCallback(p=>{if(!m)return;const{ctrlKey:k,metaKey:v,key:A,shiftKey:B}=p;if(!(k||v))return;const J={b:{command:"bold"},i:{command:"italic"},u:{command:"underline"},k:{command:"createLink"},z:{command:B?"redo":"undo"},y:{command:"redo"},1:{command:"formatBlock",value:"H1"},2:{command:"formatBlock",value:"H2"},3:{command:"formatBlock",value:"H3"},l:{command:B?"insertOrderedList":"justifyLeft"},e:{command:"justifyCenter"},r:{command:"justifyRight"},"\\":{command:"removeFormat"}}[A.toLowerCase()];J&&(p.preventDefault(),xe(J.command,J.value,!0))},[m,xe]),me=d.useCallback(p=>{a(p),t==null||t(p),setTimeout(W,0)},[t,W]),_e=d.useCallback(p=>{W()},[W]),Ae=d.useCallback(()=>{u(!0),o==null||o(),setTimeout(W,0)},[o,W]),Je=d.useCallback(()=>{u(!1),l==null||l()},[l]);d.useEffect(()=>{m&&W()},[m,W]),d.useEffect(()=>{Ie(),at()},[i,Ie]);const at=d.useCallback(()=>{if(!T.current)return;T.current.querySelectorAll("a[href]").forEach(k=>{const v=k;v.hasAttribute("target")||v.setAttribute("target","_blank"),v.hasAttribute("rel")||v.setAttribute("rel","noopener noreferrer")})},[]);return d.useEffect(()=>{const p=k=>{const v=k.target;!v.closest("img.editor-image")&&!v.closest(".image-manager")&&K(null)};return document.addEventListener("click",p),()=>document.removeEventListener("click",p)},[]),d.useEffect(()=>{if(!T.current)return;const p=T.current,k=A=>{A.preventDefault(),A.dataTransfer.dropEffect="move"},v=A=>{var te;A.preventDefault();const B=(te=A.dataTransfer)==null?void 0:te.getData("text/html");if(B&&B.includes("<img")){const re=window.getSelection();if(re&&re.rangeCount>0){const J=re.getRangeAt(0),Z=document.createElement("div");Z.innerHTML=B;const ne=Z.querySelector("img");if(ne){const de=p.querySelector(`img[src="${ne.src}"]`);de&&de!==ne&&de.remove(),J.deleteContents(),J.insertNode(ne);const Q=p.innerHTML;a(Q),t==null||t(Q)}}}};return p.addEventListener("dragover",k),p.addEventListener("drop",v),()=>{p.removeEventListener("dragover",k),p.removeEventListener("drop",v)}},[t]),r.jsxs("div",{className:"wysiwyg-editor",onKeyDown:Ge,role:"application","aria-label":"Rich text editor with keyboard shortcuts",children:[r.jsx(bt,{onCommand:xe,activeFormats:g,canUndo:b,canRedo:x}),r.jsx(Et,{content:i,placeholder:e,onContentChange:me,onFocus:Ae,onBlur:Je,editorRef:T,onSelectionChange:_e,onLinkClick:tt}),r.jsx("div",{ref:be,"aria-live":"polite","aria-atomic":"true",className:"sr-only",role:"status"}),r.jsx("div",{className:"sr-only",id:"keyboard-shortcuts-help",children:"Keyboard shortcuts: Ctrl+B for bold, Ctrl+I for italic, Ctrl+U for underline, Ctrl+K for link, Ctrl+Z for undo, Ctrl+Y for redo, Ctrl+1/2/3 for headings, Ctrl+L for left align, Ctrl+E for center align, Ctrl+R for right align, Ctrl+Shift+L for numbered list, Ctrl+\\ for clear formatting"}),r.jsx(Pt,{isOpen:F,onClose:()=>R(!1),onFileSelect:E==="image"?Be:We,accept:E==="image"?"image/*":"*/*",maxSize:E==="image"?5*1024*1024:10*1024*1024,title:E==="image"?"Upload Image":"Upload File",description:E==="image"?"Select an image to upload and crop":"Select a file to upload"}),r.jsx(Mt,{isOpen:h,imageUrl:w,onClose:()=>{I(!1),D("")},onCropComplete:ke}),r.jsx(Bt,{isOpen:P,onClose:()=>q(!1),onInsert:Qe}),r.jsx($t,{isOpen:z,onClose:()=>X(!1),onInsert:qe}),r.jsx(zt,{isOpen:se,onClose:()=>ce(!1),onSubmit:Ye,title:ie==="create"?"Insert Link":"Edit Link",placeholder:"https://example.com",initialValue:De,description:ie==="create"?"Enter the URL for the link":"Update the URL for this link"}),r.jsx(Wt,{isOpen:Ue,onClose:()=>Se(!1),onFindReplace:et}),r.jsx(Kt,{isOpen:Me,onClose:()=>Pe(!1),title:Le.title,message:Le.message,type:Le.type}),r.jsx(qt,{isOpen:we,linkUrl:ee.url,linkText:ee.text,position:ee.position,onEdit:rt,onRemove:nt,onGoToLink:ot,onClose:st}),Y&&r.jsx(Ht,{imageElement:Y,onUpdate:Ze,onRemove:ze})]})},Yt=[{command:"bold",icon:"B",title:"Bold"},{command:"italic",icon:"I",title:"Italic"},{command:"underline",icon:"U",title:"Underline"},{command:"formatBlock",value:"H1",icon:"H1",title:"Heading 1"},{command:"formatBlock",value:"H2",icon:"H2",title:"Heading 2"},{command:"formatBlock",value:"H3",icon:"H3",title:"Heading 3"},{command:"insertUnorderedList",icon:"•",title:"Bullet List"},{command:"insertOrderedList",icon:"1.",title:"Numbered List"},{command:"justifyLeft",icon:"⬅",title:"Align Left"},{command:"justifyCenter",icon:"⬌",title:"Align Center"},{command:"justifyRight",icon:"➡",title:"Align Right"},{command:"createLink",icon:"🔗",title:"Insert Link"},{command:"editLink",icon:"✏️🔗",title:"Edit Link"},{command:"unlink",icon:"🔗✕",title:"Remove Link"},{command:"insertImage",icon:"🖼️",title:"Insert Image"},{command:"uploadFile",icon:"📎",title:"Upload File"},{command:"undo",icon:"↶",title:"Undo"},{command:"redo",icon:"↷",title:"Redo"},{command:"removeFormat",icon:"✕",title:"Clear Formatting"}],Gt=({onCommand:s,activeFormats:e,canUndo:t,canRedo:o})=>{const l=c=>{s(c.command,c.value)},i=(c,b)=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),l(b))},a=(c,b)=>{const C={bold:"BOLD",italic:"ITALIC",underline:"UNDERLINE",insertUnorderedList:"INSERT_UNORDERED_LIST",insertOrderedList:"INSERT_ORDERED_LIST",justifyLeft:"JUSTIFY_LEFT",justifyCenter:"JUSTIFY_CENTER",justifyRight:"JUSTIFY_RIGHT",createLink:"CREATE_LINK",editLink:"EDIT_LINK",unlink:"UNLINK"};if(c==="formatBlock"&&b){const j=`FORMAT_${b}`;return e.has(j)}const x=C[c];return x?e.has(x):!1},m=c=>c==="undo"?!t:c==="redo"?!o:!1,u=c=>{const b=a(c.command,c.value),C=m(c.command);let x=c.title;const j={bold:"Ctrl+B",italic:"Ctrl+I",underline:"Ctrl+U",createLink:"Ctrl+K",undo:"Ctrl+Z",redo:"Ctrl+Y",removeFormat:"Ctrl+\\"};if(c.command==="formatBlock"&&c.value){const F=c.value.replace("H","");j[`${c.command}-${c.value}`]=`Ctrl+${F}`}c.command==="justifyLeft"&&(j[c.command]="Ctrl+L"),c.command==="justifyCenter"&&(j[c.command]="Ctrl+E"),c.command==="justifyRight"&&(j[c.command]="Ctrl+R"),c.command==="insertOrderedList"&&(j[c.command]="Ctrl+Shift+L");const h=c.value?`${c.command}-${c.value}`:c.command,I=j[h];return I&&(x+=`, keyboard shortcut ${I}`),C?x+=", disabled":b&&(x+=", currently active"),x},g=(c,b)=>`toolbar-${c.value?`${c.command}-${c.value}`:c.command}-${b}`;return r.jsx("div",{className:"toolbar",role:"toolbar","aria-label":"Text formatting toolbar",children:Yt.map((c,b)=>{const C=a(c.command,c.value),x=m(c.command);return r.jsx("button",{id:g(c,b),className:`toolbar-button ${C?"active":""}`,title:c.title,"aria-label":u(c),"aria-pressed":C,disabled:x,tabIndex:x?-1:0,onClick:()=>l(c),onKeyDown:j=>i(j,c),onMouseDown:j=>{j.preventDefault()},children:r.jsx("span",{"aria-hidden":"true",children:c.icon})},g(c,b))})})},Jt={allowedTags:["p","br","strong","em","u","h1","h2","h3","ul","ol","li","a"],allowedAttributes:{a:["href","title"],"*":["style"]}};exports.AdvancedToolbar=bt;exports.COMMANDS=St;exports.CommandExecutor=Ve;exports.ContentSanitizer=kt;exports.DEFAULT_SANITIZATION_CONFIG=Jt;exports.EditableArea=Et;exports.Toolbar=Gt;exports.WYSIWYGEditor=Lt;exports.contentSanitizer=Rt;exports.default=Lt;exports.focusEditor=Dt;exports.focusEditorWithSelection=Ct;exports.getActiveFormats=xt;exports.getCurrentBlockFormat=yt;exports.getCurrentSelection=mt;exports.isSelectionInEditor=vt;exports.restoreSelection=ft;exports.saveSelection=Ft;
//# sourceMappingURL=wysiwyg-editor.cjs.js.map
